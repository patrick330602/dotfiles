!function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){"use strict";var o;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(o=n.ClientType||(n.ClientType={}))},{}],2:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../constants"),r=e("./componentBase"),a=e("./tooltip"),s=e("./animations/expandFromRightAnimationStrategy"),l=e("./animations/slidingHeightAnimationStrategy"),p=function(e){function t(t){var n=e.call(this,t)||this;return n.tooltipAnimationStrategy=new s.ExpandFromRightAnimationStrategy({extShouldAnimateIn:function(){return n.state.uiExpanded},extShouldAnimateOut:function(){return!n.state.uiExpanded},onAfterAnimateOut:n.props.onAfterCollapse}),n.heightAnimationStrategy=new l.SlidingHeightAnimationStrategy(n.props.elementId,{onAfterHeightAnimatorDraw:n.props.onHeightChange}),n}return o(t,e),t.prototype.getInitialState=function(){return{uiExpanded:!0}},t.prototype.closeTooltip=function(){this.setState({uiExpanded:!1}),this.props.onCloseButtonHandler&&this.props.onCloseButtonHandler()},t.prototype.onHeightAnimatorDraw=function(e){this.heightAnimationStrategy.animate(e)},t.prototype.onTooltipDraw=function(e){this.tooltipAnimationStrategy.animate(e)},t.prototype.render=function(){var e={tag:"div",attrs:Object.assign({className:i.Constants.Classes.heightAnimator+" "+i.Constants.Classes.clearfix},this.onElementDraw(this.onHeightAnimatorDraw)),children:[this.state.uiExpanded?this.props.renderablePanel:void 0]};return m.component(a.Tooltip,{brandingImage:this.props.brandingImage,elementId:this.props.elementId,title:this.props.title,onCloseButtonHandler:this.closeTooltip.bind(this),onElementDraw:this.onTooltipDraw.bind(this),renderablePanel:e,contentClasses:this.props.contentClasses})},t}(r.ComponentBase);n.AnimatedTooltipClass=p;var c=p.componentize();n.AnimatedTooltip=c},{"../constants":22,"./animations/expandFromRightAnimationStrategy":6,"./animations/slidingHeightAnimationStrategy":7,"./componentBase":9,"./tooltip":15}],3:[function(e,t,n){"use strict";var o=function(){function e(){}return e.stopAnimationsThen=function(e,t){Velocity.animate(e,"stop",!0),setTimeout(t,1)},e}();n.AnimationHelper=o},{}],4:[function(e,t,n){"use strict";var o;!function(e){e[e.GoingIn=0]="GoingIn",e[e.GoingOut=1]="GoingOut",e[e.In=2]="In",e[e.Out=3]="Out",e[e.Transitioning=4]="Transitioning",e[e.Stopped=5]="Stopped"}(o=n.AnimationState||(n.AnimationState={}))},{}],5:[function(e,t,n){"use strict";var o=e("../../communicator/smartValue"),i=e("./animationHelper"),r=e("./animationState"),a=function(){function e(e,t){this.animationDuration=e,this.animationState=t||new o.SmartValue(r.AnimationState.Stopped)}return e.prototype.getAnimationState=function(){return this.animationState.get()},e.prototype.setAnimationState=function(e){this.animationState.set(e)},e.prototype.animate=function(e){var t=this;i.AnimationHelper.stopAnimationsThen(e,function(){t.setAnimationState(r.AnimationState.Transitioning),t.doAnimate(e).then(function(){t.setAnimationState(r.AnimationState.Stopped)})})},e}();n.AnimationStrategy=a},{"../../communicator/smartValue":21,"./animationHelper":3,"./animationState":4}],6:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../../constants"),r=e("./animationState"),a=e("./transitioningAnimationStrategy"),s=function(e){function t(t){var n=e.call(this,500,t)||this;return n.animationTimeout=100,n.reverseChildAnimations=!0,n}return o(t,e),t.prototype.doAnimateIn=function(e){var t=this;return new Promise(function(n){t.reverseChildAnimations=!0,clearTimeout(t.animationTimeoutId),t.options.onAnimateInExpand&&(t.animationTimeoutId=setTimeout(function(){t.options.onAnimateInExpand(e)},t.animationTimeout)),Velocity.animate(e,{opacity:1,right:20,width:i.Constants.Styles.clipperUiWidth},{complete:function(){t.reverseChildAnimations=!1,n()},duration:t.animationDuration,easing:"easeOutExpo"})})},t.prototype.doAnimateOut=function(e){var t=this;return new Promise(function(n){clearTimeout(t.animationTimeoutId),t.animationTimeoutId=setTimeout(function(){Velocity.animate(e,{opacity:0,right:0,width:0},{complete:function(){n()},duration:t.animationDuration,easing:"easeOutExpo"})},t.animationTimeout)})},t.prototype.intShouldAnimateIn=function(e){return this.getAnimationState()===r.AnimationState.GoingOut||this.getAnimationState()===r.AnimationState.Out},t.prototype.intShouldAnimateOut=function(e){return this.getAnimationState()===r.AnimationState.GoingIn||this.getAnimationState()===r.AnimationState.In},t}(a.TransitioningAnimationStrategy);n.ExpandFromRightAnimationStrategy=s},{"../../constants":22,"./animationState":4,"./transitioningAnimationStrategy":8}],7:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./animationStrategy"),r=function(e){function t(t,n){var o=e.call(this,200)||this;return o.containerId=t,o.options=n,o}return o(t,e),t.prototype.doAnimate=function(e){var t=this;return new Promise(function(n){var o=document.getElementById(t.containerId),i=t.getContainerTrueHeight(o,e);if(t.options.onBeforeHeightAnimatorDraw&&t.options.onBeforeHeightAnimatorDraw(i),i.actualPanelHeight===i.newPanelHeight)return void n();var r=i.actualPanelHeight>i.newPanelHeight;!r&&t.options.onAfterHeightAnimatorDraw&&t.options.onAfterHeightAnimatorDraw(i),Velocity.animate(e,{maxHeight:i.newPanelHeight,minHeight:i.newPanelHeight},{complete:function(){r&&t.options.onAfterHeightAnimatorDraw&&t.options.onAfterHeightAnimatorDraw(i),n()},duration:t.animationDuration,easing:"easeOutQuad"})})},t.prototype.getContainerTrueHeight=function(e,t){var n=parseFloat(t.style.maxHeight.replace("px",""));isNaN(n)&&(n=0),t.style.maxHeight="",t.style.minHeight="";var o=e?e.offsetHeight:0,i=t.offsetHeight;return t.style.maxHeight=n+"px",t.style.minHeight=n+"px",{actualPanelHeight:n,newContainerHeight:o,newPanelHeight:i}},t}(i.AnimationStrategy);n.SlidingHeightAnimationStrategy=r},{"./animationStrategy":5}],8:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../../objectUtils"),r=e("../../communicator/smartValue"),a=e("./animationHelper"),s=e("./animationState"),l=e("./animationStrategy"),p=function(e){function t(t,n,o){var a=this;return o=o||new r.SmartValue,i.ObjectUtils.isNullOrUndefined(o.get())&&o.set(s.AnimationState.Out),a=e.call(this,t,o)||this,a.options=n,a}return o(t,e),t.prototype.animate=function(e){this.doAnimate(e)},t.prototype.doAnimate=function(e){return this.options.extShouldAnimateIn()&&this.intShouldAnimateIn(e)?this.animateIn(e):this.options.extShouldAnimateOut()&&this.intShouldAnimateOut(e)?this.animateOut(e):void 0},t.prototype.animateIn=function(e){var t=this;return new Promise(function(n){a.AnimationHelper.stopAnimationsThen(e,function(){t.options.onBeforeAnimateIn&&t.options.onBeforeAnimateIn(e),t.setAnimationState(s.AnimationState.GoingIn),t.doAnimateIn(e).then(function(){t.setAnimationState(s.AnimationState.In),t.options.onAfterAnimateIn&&t.options.onAfterAnimateIn(e),n()})})})},t.prototype.animateOut=function(e){var t=this;return new Promise(function(n){a.AnimationHelper.stopAnimationsThen(e,function(){t.options.onBeforeAnimateOut&&t.options.onBeforeAnimateOut(e),t.setAnimationState(s.AnimationState.GoingOut),t.doAnimateOut(e).then(function(){t.setAnimationState(s.AnimationState.Out),t.options.onAfterAnimateOut&&t.options.onAfterAnimateOut(e),n()})})})},t}(l.AnimationStrategy);n.TransitioningAnimationStrategy=p},{"../../communicator/smartValue":21,"../../objectUtils":41,"./animationHelper":3,"./animationState":4,"./animationStrategy":5}],9:[function(e,t,n){"use strict";var o=e("../constants"),i=e("./frontEndGlobals"),r=function(){function e(e){this.props=e,this.state=this.getInitialState(),this.refs={}}return e.prototype.getInitialState=function(){return{}},e.prototype.setState=function(e){m.startComputation();for(var t in e)e.hasOwnProperty(t)&&(this.state[t]=e[t]);m.endComputation()},e.prototype.ref=function(e){var t=this;return{config:function(n){t.refs[e]=n}}},e.prototype.onElementDraw=function(e){return e=e.bind(this),{config:function(t,n){e(t,!n)}}},e.prototype.onElementFirstDraw=function(e){return e=e.bind(this),{config:function(t,n){n||e(t)}}},e.prototype.enableInvoke=function(e,t,n,r){return void 0===t&&(t=0),void 0===r&&(r=void 0),e&&(e=e.bind(this,n)),{onclick:function(t){var n=t.currentTarget,o=r?r:n.id;i.Clipper.logger.logClickEvent(o),e&&e(t)},onkeyup:function(t){var n=t.currentTarget;if(t.which===o.Constants.KeyCodes.enter){if("A"!==n.tagName||!n.hasAttribute("href")){var r=n.id;i.Clipper.logger.logClickEvent(r),e&&e(t)}}else t.which===o.Constants.KeyCodes.tab&&(n.style.outlineStyle="")},onmousedown:function(e){var t=e.currentTarget;t.style.outlineStyle="none"},tabIndex:t}},e.componentize=function(){var e=this,t=function(){};return t.controller=function(t){return new e(t)},t.view=function(e,t){return e.props=t,e.render()},t},e}();n.ComponentBase=r},{"../constants":22,"./frontEndGlobals":11}],10:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../../constants"),r=e("../../extensions/extensionUtils"),a=e("../../localization/localization"),s=e("../componentBase"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{}},t.prototype.render=function(){return{tag:"div",attrs:{id:i.Constants.Ids.closeButtonContainer},children:[{tag:"a",attrs:Object.assign({id:i.Constants.Ids.closeButton,"aria-label":a.Localization.getLocalizedString("WebClipper.Action.CloseTheClipper")},this.enableInvoke(this.props.onClickHandler,300,this.props.onClickHandlerParams)),children:[{tag:"img",attrs:{className:"closeButtonIcon",src:r.ExtensionUtils.getImageResourceUrl("close.png")}}]}]}},t}(s.ComponentBase),p=l.componentize();n.CloseButton=p},{"../../constants":22,"../../extensions/extensionUtils":23,"../../localization/localization":25,"../componentBase":9}],11:[function(e,t,n){"use strict";var o=e("../communicator/smartValue"),i=e("../storage/remoteStorage"),r=function(){function e(){}return e.getUserSessionId=function(){return e.sessionId.get()},e.getUserSessionIdWhenDefined=function(){return new Promise(function(t){var n=e.sessionId.get();n?t(n):e.sessionId.subscribe(function(e){t(e)},{times:1,callOnSubscribe:!1})})},e.getInjectCommunicator=function(){return e.injectCommunicator},e.setInjectCommunicator=function(t){e.injectCommunicator=t},e.getExtensionCommunicator=function(){return e.extensionCommunicator},e.setExtensionCommunicator=function(t){e.extensionCommunicator=t,e.setUpRemoteStorage(t)},e.getCachedValue=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");return e.storage.getCachedValue(t)},e.getStoredValue=function(t,n,o){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValue(t,n,o)},e.preCacheStoredValues=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValues(t,function(){},!0)},e.storeValue=function(t,n){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.setValue(t,n,void 0)},e.setUpRemoteStorage=function(t){e.storage=new i.RemoteStorage(e.getExtensionCommunicator())},e}();r.sessionId=new o.SmartValue,n.Clipper=r},{"../communicator/smartValue":21,"../storage/remoteStorage":43}],12:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../constants"),r=e("../polyfills"),a=e("../communicator/communicator"),s=e("../communicator/iframeMessageHandler"),l=e("../localization/localization"),p=e("../logging/log"),c=e("../logging/communicatorLoggerPure"),u=e("./frontEndGlobals"),g=e("./componentBase"),d=e("./tooltipRenderer"),h=e("./tooltipType"),f=function(e){function t(t){var n=e.call(this,t)||this;return n.initializeCommunicators(),n.setFrontLoadedLocalizedStrings(),n.getAndStoreDataFromExtension(),n}return o(t,e),t.prototype.getInitialState=function(){return{}},t.prototype.onClosePageNavButton=function(){var e=new p.Event.BaseEvent(p.Event.Label.ClosePageNavTooltip);e.setCustomProperty(p.PropertyName.Custom.PageNavTooltipType,this.state.tooltipToRender?h.TooltipType[this.state.tooltipToRender]:"unknown"),u.Clipper.logger.logEvent(e)},t.prototype.closePageNav=function(){u.Clipper.getInjectCommunicator().callRemoteFunction(i.Constants.FunctionKeys.closePageNavTooltip)},t.prototype.getAndStoreDataFromExtension=function(){var e=this;u.Clipper.getExtensionCommunicator().callRemoteFunction(i.Constants.FunctionKeys.getTooltipToRenderInPageNav,{callback:function(t){e.setState({tooltipToRender:t})}}),u.Clipper.getExtensionCommunicator().callRemoteFunction(i.Constants.FunctionKeys.getPageNavTooltipProps,{callback:function(t){e.setState({tooltipProps:t})}})},t.prototype.initializeCommunicators=function(){u.Clipper.setInjectCommunicator(new a.Communicator(new s.IFrameMessageHandler(function(){return parent}),i.Constants.CommunicationChannels.pageNavInjectedAndPageNavUi)),u.Clipper.setExtensionCommunicator(new a.Communicator(new s.IFrameMessageHandler(function(){return parent}),i.Constants.CommunicationChannels.extensionAndPageNavUi)),u.Clipper.logger=new c.CommunicatorLoggerPure(u.Clipper.getExtensionCommunicator())},t.prototype.setFrontLoadedLocalizedStrings=function(){u.Clipper.getExtensionCommunicator().callRemoteFunction(i.Constants.FunctionKeys.clipperStringsFrontLoaded,{callback:function(e){l.Localization.setLocalizedStrings(e)}})},t.prototype.updateFrameHeight=function(e){u.Clipper.getInjectCommunicator().callRemoteFunction(i.Constants.FunctionKeys.updateFrameHeight,{param:e.newContainerHeight})},t.prototype.render=function(){return m.component(d.TooltipRenderer,{onCloseButtonHandler:this.onClosePageNavButton.bind(this),onHeightChange:this.updateFrameHeight.bind(this),onTooltipClose:this.closePageNav.bind(this),tooltipToRender:this.state.tooltipToRender,tooltipProps:this.state.tooltipProps})},t}(g.ComponentBase);r.Polyfills.init();var C=window.onerror;window.onerror=function(e,t,n,o,i){var r=i?p.Failure.getStackTrace(i):"[unknown stacktrace]";u.Clipper.logger.logFailure(p.Failure.Label.UnhandledExceptionThrown,p.Failure.Type.Unexpected,{error:e+" ("+t+":"+n+":"+o+") at "+r},"PageNavUI"),C&&C(e,t,n,o,i)};var b=f.componentize();n.PageNav=b,m.mount(document.getElementById("pageNavUIPlaceholder"),b)},{"../communicator/communicator":18,"../communicator/iframeMessageHandler":19,"../constants":22,"../localization/localization":25,"../logging/communicatorLoggerPure":26,"../logging/log":27,"../polyfills":42,"./componentBase":9,"./frontEndGlobals":11,"./tooltipRenderer":16,"./tooltipType":17}],13:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../../constants"),r=e("../../localization/localization"),a=e("../componentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{}},t.prototype.createChangeElement=function(e){var t=e.imageUrl?{tag:"img",attrs:{src:e.imageUrl}}:void 0;return{tag:"div",attrs:{className:i.Constants.Classes.change},children:[t?{tag:"div",attrs:{className:i.Constants.Classes.changeImage},children:[t]}:void 0,{tag:"div",attrs:{className:i.Constants.Classes.changeBody},children:[{tag:"div",attrs:{className:i.Constants.Classes.changeTitle},children:[{tag:"span",attrs:{className:"changeTitleFont",style:r.Localization.getFontFamilyAsStyle(r.Localization.FontFamily.Semibold)},children:[e.title]}]},{tag:"div",attrs:{className:i.Constants.Classes.changeDescription},children:[{tag:"span",attrs:{className:"changeDescriptionFont",style:r.Localization.getFontFamilyAsStyle(r.Localization.FontFamily.Regular)},children:[e.description]}]}]}]}},t.prototype.getChangeElements=function(){for(var e=[],t=0;t<this.props.updates.length;t++)for(var n=0;n<this.props.updates[t].changes.length;n++)e.push(this.createChangeElement(this.props.updates[t].changes[n]));return e},t.prototype.render=function(){return{tag:"div",attrs:{className:i.Constants.Classes.changes},children:[this.getChangeElements()]}},t}(a.ComponentBase),l=s.componentize();n.ChangeLogPanel=l},{"../../constants":22,"../../localization/localization":25,"../componentBase":9}],14:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../componentBase"),r=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getExtraMessages=function(){},t.prototype.onPanelAnimatorDraw=function(e){this.props.panelAnimationStrategy&&this.props.panelAnimationStrategy.animate(e)},t.prototype.render=function(){var e=this,t=a.ObjectUtils.isNullOrUndefined(this.props.fontFamily)?s.Localization.FontFamily.Semibold:this.props.fontFamily,n=a.ObjectUtils.isNullOrUndefined(this.props.buttonFontFamily)?s.Localization.FontFamily.Semibold:this.props.buttonFontFamily,o=this.props.containerId?this.props.containerId:"";return{tag:"div",attrs:{id:o},children:[{tag:"div",attrs:Object.assign({className:r.Constants.Classes.panelAnimator},this.onElementDraw(this.onPanelAnimatorDraw)),children:[{tag:"div",attrs:{id:r.Constants.Ids.dialogMessageContainer,className:"resultPagePadding"},children:[{tag:"div",attrs:{className:"messageLabelContainer",style:s.Localization.getFontFamilyAsStyle(t)},children:[{tag:"div",attrs:{id:r.Constants.Ids.dialogMessage,className:"dialogMessageFont messageLabel",role:"alert"},children:[this.props.message]},this.getExtraMessages()]}]},{tag:"div",attrs:{id:r.Constants.Ids.dialogContentContainer,className:""},children:[this.props.content]},{tag:"div",attrs:{id:r.Constants.Ids.dialogButtonContainer},children:[this.props.buttons.map(function(t,o){return{tag:"a",attrs:Object.assign({id:t.id,className:"dialogButton"},e.enableInvoke(t.handler,70)),children:[{tag:"div",attrs:{className:"wideButtonContainer"},children:[{tag:"span",attrs:{className:"wideButtonFont wideActionButton",style:s.Localization.getFontFamilyAsStyle(n)},children:[t.label]}]}]}})]}]}]}},t}(i.ComponentBase);n.DialogPanelClass=l;var p=l.componentize();n.DialogPanel=p},{"../../constants":22,"../../localization/localization":25,"../../objectUtils":41,"../componentBase":9}],15:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../localization/localization"),r=e("./componentBase"),a=e("./components/closeButton"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{}},t.prototype.render=function(){var e="";return this.props.contentClasses&&(e=this.props.contentClasses.join(" ")),{tag:"div",attrs:Object.assign({id:this.props.elementId,className:"tooltip"},this.onElementDraw(this.props.onElementDraw)),children:[this.props.brandingImage,this.props.title?{tag:"div",attrs:{style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Semibold),className:"tooltip-title"},children:[this.props.title]}:void 0,m.component(a.CloseButton,{onClickHandler:this.props.onCloseButtonHandler,onClickHandlerParams:void 0}),{tag:"div",attrs:{className:"tooltip-content "+e},children:[this.props.renderablePanel]}]}},t}(r.ComponentBase);n.TooltipClass=s;var l=s.componentize();n.Tooltip=l},{"../localization/localization":25,"./componentBase":9,"./components/closeButton":10}],16:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../constants"),r=e("../extensions/extensionUtils"),a=e("../extensions/invokeSource"),s=e("../localization/localization"),l=e("./frontEndGlobals"),p=e("./componentBase"),c=e("./animatedTooltip"),u=e("./tooltipType"),g=e("./panels/changeLogPanel"),d=e("./panels/dialogPanel"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{}},t.prototype.getChangeLogPanel=function(){var e=this.props.tooltipProps,t=function(){l.Clipper.getExtensionCommunicator().callRemoteFunction(i.Constants.FunctionKeys.invokeClipperFromPageNav,{param:a.InvokeSource.WhatsNewTooltip})};return{tag:"div",attrs:{},children:[m.component(g.ChangeLogPanel,{updates:e.updates}),{tag:"div",attrs:{className:"wideButtonContainer changelog-button"},children:[{tag:"a",attrs:Object.assign({id:i.Constants.Ids.proceedToWebClipperButton},this.enableInvoke(t,10)),children:[{tag:"span",attrs:{className:"wideButtonFont wideActionButton",style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Semibold)},children:[s.Localization.getLocalizedString("WebClipper.Label.ProceedToWebClipperFun")]}]}]}]}},t.prototype.getContentClasses=function(){var e=this.getCurrentPanelType(),t=[];switch(e){case u.TooltipType.Pdf:case u.TooltipType.Product:case u.TooltipType.Recipe:case u.TooltipType.Video:return t.push("tooltip-upsell"),t;case u.TooltipType.ChangeLog:return t.push("changelog-content"),t;default:return t}},t.prototype.getCurrentPanelType=function(){return this.state.hasOwnProperty("tooltipToRenderOverride")?this.state.tooltipToRenderOverride:this.props.tooltipToRender},t.prototype.getCurrentTitle=function(){var e=this.getCurrentPanelType();switch(e){case u.TooltipType.ChangeLog:return s.Localization.getLocalizedString("WebClipper.Label.WhatsNew");default:return""}},t.prototype.getTooltipPanel=function(e){var t=function(){l.Clipper.getExtensionCommunicator().callRemoteFunction(i.Constants.FunctionKeys.invokeClipperFromPageNav,{param:u.TooltipTypeUtils.toInvokeSource(e)})},n=u.TooltipType[e],o="tooltips/"+n+".png";o=o.toLowerCase();var a=[{tag:"img",attrs:{className:"tooltip-image",src:r.ExtensionUtils.getImageResourceUrl(o)}}],p=[{id:i.Constants.Ids.proceedToWebClipperButton,label:s.Localization.getLocalizedString("WebClipper.Label.ProceedToWebClipperFun"),handler:t}],c="WebClipper.Label."+n+"Tooltip";return m.component(d.DialogPanel,{message:s.Localization.getLocalizedString(c),content:a,buttons:p,fontFamily:s.Localization.FontFamily.Semilight})},t.prototype.getWhatsNewPanel=function(){var e=this,t=function(){e.setState({tooltipToRenderOverride:u.TooltipType.ChangeLog})},n=[{id:i.Constants.Ids.checkOutWhatsNewButton,label:s.Localization.getLocalizedString("WebClipper.Label.OpenChangeLogFromTooltip"),handler:t.bind(this)}];return m.component(d.DialogPanel,{message:s.Localization.getLocalizedString("WebClipper.Label.WebClipperWasUpdatedFun"),buttons:n})},t.prototype.createTooltipPanelToShow=function(){var e=this.getCurrentPanelType();if(void 0!==e)switch(e){case u.TooltipType.WhatsNew:return this.getWhatsNewPanel();case u.TooltipType.ChangeLog:return this.getChangeLogPanel();default:return this.getTooltipPanel(e)}},t.prototype.getBrandingImage=function(){var e=this.getCurrentPanelType();switch(e){case u.TooltipType.ChangeLog:return;default:return{tag:"div",attrs:{id:i.Constants.Ids.brandingContainer},children:[{tag:"p",attrs:{className:"tooltip-corner-branding"},children:[{tag:"img",attrs:{src:r.ExtensionUtils.getImageResourceUrl("tooltips/onenote_tooltip_branding.png")}}]}]}}},t.prototype.render=function(){return m.component(c.AnimatedTooltip,{brandingImage:this.getBrandingImage(),elementId:i.Constants.Ids.pageNavAnimatedTooltip,title:this.getCurrentTitle(),onAfterCollapse:this.props.onTooltipClose,onCloseButtonHandler:this.props.onCloseButtonHandler,onHeightChange:this.props.onHeightChange,renderablePanel:this.createTooltipPanelToShow(),contentClasses:this.getContentClasses()})},t}(p.ComponentBase),f=h.componentize();n.TooltipRenderer=f},{"../constants":22,"../extensions/extensionUtils":23,"../extensions/invokeSource":24,"../localization/localization":25,"./animatedTooltip":2,"./componentBase":9,"./frontEndGlobals":11,"./panels/changeLogPanel":13,"./panels/dialogPanel":14,"./tooltipType":17}],17:[function(e,t,n){"use strict";var o,i=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(o=n.TooltipType||(n.TooltipType={}));var r;!function(e){function t(e){switch(e){case o.Pdf:return i.InvokeSource.PdfTooltip;case o.Product:return i.InvokeSource.ProductTooltip;case o.Recipe:return i.InvokeSource.RecipeTooltip;case o.Video:return i.InvokeSource.VideoTooltip;case o.WhatsNew:return i.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(r=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":24}],18:[function(e,t,n){"use strict";var o=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var o in this.functionMap)this.functionMap.hasOwnProperty(o)&&this.postMessage({data:o,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var i=t.data.toString();if(this.otherSideKeys[i]||(this.otherSideKeys[i]=!0),this.isSmartValueSubscription(i)){var r=i.substr(e.setValuePrefix.length),a=this.trackedSmartValues[r];a&&this.updateRemoteSmartValue(r,a.get())}else if(this.queuedCalls[i]){for(var s=this.queuedCalls[i],l=0;l<s.length;l++)this.postMessage(s[l]);delete this.queuedCalls[i]}}else{var p=this.functionMap[t.functionKey];if(p){var c=p(t.data);c&&c.then&&t.callbackKey&&c.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var o=n?n.param:void 0,i=void 0;n&&n.callback&&(i=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(i,n.callback));var r={data:o,functionKey:t};i&&(r.callbackKey=i),this.otherSideKeys[t]?this.postMessage(r):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(r))},e.prototype.subscribeAcrossCommunicator=function(t,n,o){o&&t.subscribe(o,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,o=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(o),this.trackedSmartValues[t]=e,e.subscribe(o)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();o.initializationKey="INITIALIZATION-K3Y",o.acknowledgeKey="ACKNOWLEDGE-K3Y",o.registrationKey="REGISTER-FUNCTION-K3Y",o.setValuePrefix="SETVALUE-",o.callbackPostfix="-CALLBACK",n.Communicator=o},{}],19:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./messageHandler"),r=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return o(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(i.MessageHandler);n.IFrameMessageHandler=r},{"./messageHandler":20}],20:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=o},{}],21:[function(e,t,n){"use strict";var o=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){
return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],o=0;o<e.length;o++)n.push(e[o].get());t.apply(this,n)})},e}();n.SmartValue=o},{}],22:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var o;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(o=e.Extension||(e.Extension={}));var i;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(i=e.Ids||(e.Ids={}));var r;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(r=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var l;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67}(l=e.KeyCodes||(e.KeyCodes={}));var p;!function(e){e.c="KeyC"}(p=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var u;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(u=e.Styles||(e.Styles={}));var g;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.userFlightingEndpoint=e.serviceDomain+"/webclipper/userflight",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper"}(n=e.QueryParams||(e.QueryParams={}))}(g=e.Urls||(e.Urls={}));var d;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(d=e.LogCategories||(e.LogCategories={}));var h;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(h=e.Settings||(e.Settings={}))}(o=n.Constants||(n.Constants={}))},{}],23:[function(e,t,n){"use strict";var o;!function(e){function t(e){return("images/"+e).toLowerCase()}e.getImageResourceUrl=t}(o=n.ExtensionUtils||(n.ExtensionUtils={}))},{}],24:[function(e,t,n){"use strict";var o;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(o=n.InvokeSource||(n.InvokeSource={}))},{}],25:[function(e,t,n){"use strict";var o;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(l){var t=l[e];if(t)return t}var n=c[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function o(e){l=e}function i(e){return"font-family: "+r(e)+";"}function r(e){if(p[e])return p[e];var t="WebClipper.FontFamily."+s[e].toString(),o=n(t);return p[e]=a(o),p[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var l,p={},c=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=o,t.getFontFamilyAsStyle=i,t.getFontFamily=r,t.formatFontFamily=a}(o=n.Localization||(n.Localization={}))},{"../../strings.json":44}],26:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../constants"),r=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return o(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(r.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,o){this.sendDataPackage(r.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(r.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(r.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(r.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(r.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(r.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(r.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(r.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(r.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(i.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":22,"./log":27,"./logger":28}],27:[function(e,t,n){"use strict";function o(e,t){switch(e.methodName){case r.LogMethods.LogEvent:var n=e.methodArgs[0],o=e.methodArgs[1];t.logEvent.apply(t,[i.Event.createEvent(n,o)]);break;case r.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case r.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case r.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case r.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case r.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case r.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case r.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case r.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var i=e("./submodules/event"),r=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=o;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var l=e("./submodules/errorUtils");n.ErrorUtils=l.ErrorUtils;var p=e("./submodules/event");n.Event=p.Event;var c=e("./submodules/failure");n.Failure=c.Failure;var u=e("./submodules/funnel");n.Funnel=u.Funnel;var g=e("./submodules/logMethods");n.LogMethods=g.LogMethods;var d=e("./submodules/noop");n.NoOp=d.NoOp;var h=e("./submodules/propertyName");n.PropertyName=h.PropertyName;var m=e("./submodules/session");n.Session=m.Session;var f=e("./submodules/status");n.Status=f.Status;var C=e("./submodules/trace");n.Trace=C.Trace},{"./submodules/click":29,"./submodules/context":30,"./submodules/errorUtils":31,"./submodules/event":32,"./submodules/failure":33,"./submodules/funnel":34,"./submodules/logMethods":35,"./submodules/noop":36,"./submodules/propertyName":37,"./submodules/session":38,"./submodules/status":39,"./submodules/trace":40}],28:[function(e,t,n){"use strict";var o=e("./log"),i=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(o.Failure.Label.JsonParse,o.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=i},{"./log":27}],29:[function(e,t,n){"use strict";var o;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(o=n.Click||(n.Click={}))},{}],30:[function(e,t,n){"use strict";var o;!function(e){function t(e){return o[n[e]]}var n,o={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",InvokeHostname:"InvokeHostname",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.InvokeHostname=13]="InvokeHostname",e[e.PageLanguage=14]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(o=n.Context||(n.Context={}))},{}],31:[function(e,t,n){"use strict";var o,i=e("../../clientType"),r=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),l=e("../log");!function(e){function t(e){if(e){var t={};t[d[d.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[d[d.StatusCode].toLowerCase()]=n.statusCode,t[d[d.Response].toLowerCase()]=n.response,t[d[d.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[d[d.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function o(t){var n={};n[r.Constants.Urls.QueryParams.failureType]=l.Failure.Type[t.properties.failureType],n[r.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[r.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[r.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var o=t.clientInfo;g(n,o),LogManager.sendMiscLogRequest({label:l.Failure.Label[t.label],category:l.Failure.category,properties:n},!0)}function p(t,n,o,i){var r;throw r=i?JSON.stringify({message:i,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:l.Failure.Label.UnhandledExceptionThrown,properties:{failureType:l.Failure.Type.Unexpected,failureInfo:{error:r},failureId:"Channel "+t,stackTrace:l.Failure.getStackTrace(n)},clientInfo:o}),n}function c(e,t){void 0===t&&(t=!1);var n={};n[r.Constants.Urls.QueryParams.channel]=e.channel,n[r.Constants.Urls.QueryParams.url]=encodeURIComponent(e.url),n[r.Constants.Urls.QueryParams.timeoutInMs]=r.Constants.Settings.noOpTrackerTimeoutDuration.toString();var o=e.clientInfo;g(n,o),LogManager.sendMiscLogRequest({label:l.NoOp.Label[e.label],category:l.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function u(e,t){return void 0===t&&(t=!1),setTimeout(function(){c(e,t)},r.Constants.Settings.noOpTrackerTimeoutDuration)}function g(e,t){t&&(e[r.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:i.ClientType[t.get().clipperType],e[r.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperVersion,e[r.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperId)}var d;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(d||(d={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=o,e.handleCommunicatorError=p,e.sendNoOpTrackerRequest=c,e.setNoOpTrackerRequestTimeout=u}(o=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":1,"../../constants":22,"../../localization/localization":25,"../../objectUtils":41,"../log":27}],32:[function(e,t,n){"use strict";var o,i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var o;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(o=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+r.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[r.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in r.PropertyName.Reserved)if(r.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=r.Status.Succeeded,n._failureType=r.Failure.Type.Unexpected,n.isEventData(e)){var o=e;n._logStatus=o.LogStatus,n._failureType=o.FailureType,n._failureInfo=r.ErrorUtils.clone(o.FailureInfo)}return n}return i(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:r.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return r.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return r.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=r.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return r.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=l;var p=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var o=e;n._stream=o.Stream}return n}return i(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=p,e.createEvent=t}(o=n.Event||(n.Event={}))},{"../../objectUtils":41,"../log":27}],33:[function(e,t,n){"use strict";var o;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var o;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(o=e.Label||(e.Label={}))}(o=n.Failure||(n.Failure={}))},{}],34:[function(e,t,n){"use strict";var o;!function(e){e.category="Funnel";var t;!function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.AuthSignInFailed=4]="AuthSignInFailed",e[e.ClipAttempted=5]="ClipAttempted",e[e.Interact=6]="Interact",e[e.ViewInWac=7]="ViewInWac",e[e.SignOut=8]="SignOut"}(t=e.Label||(e.Label={}))}(o=n.Funnel||(n.Funnel={}))},{}],35:[function(e,t,n){"use strict";var o;!function(e){e[e.LogEvent=0]="LogEvent",e[e.LogFailure=1]="LogFailure",e[e.PushToStream=2]="PushToStream",e[e.LogFunnel=3]="LogFunnel",e[e.LogSession=4]="LogSession",e[e.LogSessionStart=5]="LogSessionStart",e[e.LogSessionEnd=6]="LogSessionEnd",e[e.LogTrace=7]="LogTrace",e[e.LogClickEvent=8]="LogClickEvent",e[e.SetContextProperty=9]="SetContextProperty";
}(o=n.LogMethods||(n.LogMethods={}))},{}],36:[function(e,t,n){"use strict";var o;!function(e){e.category="NoOp";var t;!function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(t=e.Label||(e.Label={}))}(o=n.NoOp||(n.NoOp={}))},{}],37:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.BookmarkInfo=3]="BookmarkInfo",e[e.ByteLength=4]="ByteLength",e[e.BytesPerPdfPage=5]="BytesPerPdfPage",e[e.BytesTrimmed=6]="BytesTrimmed",e[e.Channel=7]="Channel",e[e.ClipMode=8]="ClipMode",e[e.CloseReason=9]="CloseReason",e[e.ContainsAtLeastOneHighlight=10]="ContainsAtLeastOneHighlight",e[e.ContentType=11]="ContentType",e[e.CorrelationId=12]="CorrelationId",e[e.CurrentPanel=13]="CurrentPanel",e[e.CurrentSectionStillExists=14]="CurrentSectionStillExists",e[e.DeviceIdInStorage=15]="DeviceIdInStorage",e[e.DeviceIdInCookie=16]="DeviceIdInCookie",e[e.DomSizeInBytes=17]="DomSizeInBytes",e[e.FeatureEnabled=18]="FeatureEnabled",e[e.FinalDataUrlLength=19]="FinalDataUrlLength",e[e.FontSize=20]="FontSize",e[e.ForceRetrieveFreshLocStrings=21]="ForceRetrieveFreshLocStrings",e[e.FreshUserInfoAvailable=22]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=23]="FullPageScreenshotContentFound",e[e.Height=24]="Height",e[e.InitialDataUrlLength=25]="InitialDataUrlLength",e[e.InvokeMode=26]="InvokeMode",e[e.InvokeSource=27]="InvokeSource",e[e.IsHighDpiScreen=28]="IsHighDpiScreen",e[e.IsRetryable=29]="IsRetryable",e[e.IsSerif=30]="IsSerif",e[e.Key=31]="Key",e[e.LastSeenTooltipTime=32]="LastSeenTooltipTime",e[e.LastUpdated=33]="LastUpdated",e[e.MaxDepth=34]="MaxDepth",e[e.NumPages=35]="NumPages",e[e.NumRegions=36]="NumRegions",e[e.NumTimesTooltipHasBeenSeen=37]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=38]="PageNavTooltipType",e[e.PageTitleModified=39]="PageTitleModified",e[e.PdfAllPagesClipped=40]="PdfAllPagesClipped",e[e.PdfAttachmentClipped=41]="PdfAttachmentClipped",e[e.PdfFileSelectedPageCount=42]="PdfFileSelectedPageCount",e[e.PdfFileTotalPageCount=43]="PdfFileTotalPageCount",e[e.PdfIsBatched=44]="PdfIsBatched",e[e.PdfIsLocalFile=45]="PdfIsLocalFile",e[e.RatingsInfo=46]="RatingsInfo",e[e.ShouldShowRatingsPrompt=47]="ShouldShowRatingsPrompt",e[e.SignInCancelled=48]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=49]="StoredLocaleDifferentThanRequested",e[e.TimeToClearNoOpTracker=50]="TimeToClearNoOpTracker",e[e.TooltipType=51]="TooltipType",e[e.UpdateInterval=52]="UpdateInterval",e[e.UserInformationReturned=53]="UserInformationReturned",e[e.UserInformationStored=54]="UserInformationStored",e[e.UserUpdateReason=55]="UserUpdateReason",e[e.Url=56]="Url",e[e.Value=57]="Value",e[e.VideoDataOriginalSrcUrl=58]="VideoDataOriginalSrcUrl",e[e.VideoSrcUrl=59]="VideoSrcUrl",e[e.Width=60]="Width",e[e.WriteableCookies=61]="WriteableCookies"}(t=e.Custom||(e.Custom={}));var n;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(n=e.Reserved||(e.Reserved={}))}(o=n.PropertyName||(n.PropertyName={}))},{}],38:[function(e,t,n){"use strict";var o;!function(e){e.category="Session";var t;!function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(t=e.EndTrigger||(e.EndTrigger={}));var n;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(n=e.State||(e.State={}))}(o=n.Session||(n.Session={}))},{}],39:[function(e,t,n){"use strict";var o;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(o=n.Status||(n.Status={}))},{}],40:[function(e,t,n){"use strict";var o;!function(e){e.category="Trace";var t;!function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl"}(t=e.Label||(e.Label={}));var n;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(n=e.Level||(e.Level={}))}(o=n.Trace||(n.Trace={}))},{}],41:[function(e,t,n){"use strict";var o;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=n}(o=n.ObjectUtils||(n.ObjectUtils={}))},{}],42:[function(e,t,n){"use strict";var o,i=e("es6-promise");!function(e){function t(){n(),o(),r(),a()}function n(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var o=n.lastIndexOf(e,t);return o!==-1&&o===t})}function o(){"function"!=typeof Object.assign&&(Object.assign=function(e){if(!e)throw new TypeError("Cannot convert undefined to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var i in o)o.hasOwnProperty(i)&&(t[i]=o[i])}return t})}function r(){"undefined"==typeof Promise&&i.polyfill()}function a(){window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(function(){e(Date.now())},16)})}e.init=t}(o=n.Polyfills||(n.Polyfills={}))},{"es6-promise":45}],43:[function(e,t,n){"use strict";var o=e("../constants"),i=function(){function e(e){this.storageCache={},this.extensionCommunicator=e}return e.prototype.getCachedValue=function(e){return this.storageCache[e]},e.prototype.getValue=function(e,t,n){var i=this;this.extensionCommunicator.callRemoteFunction(o.Constants.FunctionKeys.getStorageValue,{param:e,callback:function(o){n&&(i.storageCache[e]=o),t(o)}})},e.prototype.getValues=function(e,t,n){var i=this;this.extensionCommunicator.callRemoteFunction(o.Constants.FunctionKeys.getMultipleStorageValues,{param:e,callback:function(e){if(n)for(var o in e)e.hasOwnProperty(o)&&(i.storageCache[o]=e[o]);t(e)}})},e.prototype.setValue=function(e,t,n){e in this.storageCache&&(this.storageCache[e]=t),this.extensionCommunicator.callRemoteFunction(o.Constants.FunctionKeys.setStorageValue,{param:{key:e,value:t},callback:function(e){n&&n(e)}})},e}();n.RemoteStorage=i},{"../constants":22}],44:[function(e,t,n){t.exports={"WebClipper.Accessibility.ScreenReader.CurrentModeHasChanged":"The current clipping mode is now '{0}'","WebClipper.Accessibility.ScreenReader.ClippingPageToOneNote":"Clipping the current page to OneNote","WebClipper.Accessibility.ScreenReader.ChangeFontToSansSerif":"Change font to Sans-Serif","WebClipper.Accessibility.ScreenReader.ChangeFontToSerif":"Change font to Serif","WebClipper.Accessibility.ScreenReader.DecreaseFontSize":"Decrease font size","WebClipper.Accessibility.ScreenReader.IncreaseFontSize":"Increase font size","WebClipper.Accessibility.ScreenReader.ToggleHighlighterForArticleMode":"Toggle Highlighter Mode For Article","WebClipper.Accessibility.ScreenReader.InputBoxToChangeTitleOfOneNotePage":"Text input to edit the title of the page you want to save","WebClipper.Action.BackToHome":"Back","WebClipper.Action.Cancel":"Cancel","WebClipper.Action.Clip":"Clip","WebClipper.Action.CloseTheClipper":"Close the Clipper","WebClipper.Action.Feedback":"Feedback?","WebClipper.Action.RefreshPage":"Refresh Page","WebClipper.Action.Signin":"Sign In","WebClipper.Action.SigninMsa":"Sign in with a Microsoft account","WebClipper.Action.SigninOrgId":"Sign in with a work or school account","WebClipper.Action.SignOut":"Sign Out","WebClipper.Action.TryAgain":"Try Again","WebClipper.Action.ViewInOneNote":"View in OneNote","WebClipper.Action.Less":"Less","WebClipper.Action.More":"More","WebClipper.BetaTag":"beta","WebClipper.ClipType.Article.Button":"Article","WebClipper.ClipType.Article.ProgressLabel":"Clipping Article","WebClipper.ClipType.Bookmark.Button":"Bookmark","WebClipper.ClipType.Bookmark.Button.Tooltip":"Clip just the title, thumbnail, synopsis, and link.","WebClipper.ClipType.Bookmark.ProgressLabel":"Clipping Bookmark","WebClipper.ClipType.Button.Tooltip":"Clip just the {0} in an easy-to-read format.","WebClipper.ClipType.Image.Button":"Image","WebClipper.ClipType.ImageSnippet.Button":"Image Snippet","WebClipper.ClipType.MultipleRegions.Button.Tooltip":"Take screenshots of parts of the page you'll select.","WebClipper.ClipType.Pdf.Button":"PDF Document","WebClipper.ClipType.Pdf.AskPermissionToClipLocalFile":"We need your permission to clip PDF files stored on your computer","WebClipper.ClipType.Pdf.InstructionsForClippingLocalFiles":"In Chrome, right-click the OneNote icon in the toolbar and choose \"Manage Extension'. Then, for OneNote Web Clipper, check 'Allow access to file URLs.'","WebClipper.ClipType.Pdf.ProgressLabel":"Clipping PDF File","WebClipper.ClipType.Pdf.ProgressLabelDelay":"PDFs can take a little while to upload. Still clipping.","WebClipper.ClipType.Pdf.IncrementalProgressMessage":"Clipping page {0} of {1}...","WebClipper.ClipType.Pdf.Button.Tooltip":"Take a screenshot of the whole PDF file and save a copy of the attachment.","WebClipper.ClipType.Product.Button":"Product","WebClipper.ClipType.Product.ProgressLabel":"Clipping Product","WebClipper.ClipType.Recipe.Button":"Recipe","WebClipper.ClipType.Recipe.ProgressLabel":"Clipping Recipe","WebClipper.ClipType.Region.Button":"Region","WebClipper.ClipType.Region.Button.Tooltip":"Take a screenshot of the part of the page you'll select.","WebClipper.ClipType.Region.ProgressLabel":"Clipping Region","WebClipper.ClipType.ScreenShot.Button":"Full Page","WebClipper.ClipType.ScreenShot.Button.Tooltip":"Take a screenshot of the whole page, just like you see it.","WebClipper.ClipType.ScreenShot.ProgressLabel":"Clipping Page","WebClipper.ClipType.Selection.Button":"Selection","WebClipper.ClipType.Selection.Button.Tooltip":"Clip the selection you made on the web page.","WebClipper.ClipType.Selection.ProgressLabel":"Clipping Selection","WebClipper.Error.ConflictingExtension":"Your PDF viewer or another extension might be blocking the OneNote Web Clipper. You could temporarily disable the following extension and try clipping again.","WebClipper.Error.CannotClipPage":"Sorry, this type of page can't be clipped.","WebClipper.Error.CookiesDisabled.Line1":"Cookies must be enabled in order for OneNote Web Clipper to work correctly.","WebClipper.Error.CookiesDisabled.Line2":"Please allow third-party cookies in your browser or add the onenote.com and live.com domains as an exception.","WebClipper.Error.CookiesDisabled.Chrome":"Please allow third-party cookies in your browser or add the [*.]onenote.com and [*.]live.com domains as an exception.","WebClipper.Error.CookiesDisabled.Edge":"Please allow third-party cookies in your browser.","WebClipper.Error.CookiesDisabled.Firefox":"Please allow third-party cookies in your browser or add the https://onenote.com and https://live.com domains as an exception.","WebClipper.Error.CorruptedSection":"Your clip can't be saved here because the section is corrupt.","WebClipper.Error.GenericError":"Something went wrong. Please try clipping the page again.","WebClipper.Error.GenericExpiredTokenRefreshError":"Your login session has ended and we were unable to clip the page. Please sign in again.","WebClipper.Error.NoOpError":"Sorry, we can't clip this page right now","WebClipper.Error.NotProvisioned":"Your clip can't be saved because your OneDrive for Business account isn't set up.","WebClipper.Error.OrphanedWebClipperDetected":"Something went wrong. Please refresh this page, and try to clip again.","WebClipper.Error.PasswordProtected":"Your clip can't be saved here because the section is password protected.","WebClipper.Error.QuotaExceeded":"Your clip can't be saved because your OneDrive account has reached its size limit.","WebClipper.Error.ResourceDoesNotExist":"Your clip can't be saved here because the location no longer exists. Please try clipping to another location.","WebClipper.Error.SectionTooLarge":"Your clip can't be saved here because the section has reached its size limit.","WebClipper.Error.SignInUnsuccessful":"We couldn't sign you in. Please try again.","WebClipper.Error.ThirdPartyCookiesDisabled":"For OneNote Web Clipper to work correctly, please allow third-party cookies in your browser, or add the onenote.com domain as an exception.","WebClipper.Error.UserAccountSuspended":"Your clip can't be saved because your Microsoft account has been suspended.","WebClipper.Error.UserAccountSuspendedResetText":"Reset Your Account","WebClipper.Error.UserDoesNotHaveUpdatePermission":"We've added features to the Web Clipper that require new permissions. To accept them, please sign out and sign back in.","WebClipper.Extension.RefreshTab":"Please refresh this page, and try to clip again.","WebClipper.FromCitation":"Clipped from: {0}","WebClipper.Label.Annotation":"Note","WebClipper.Label.AnnotationPlaceholder":"Add a note...","WebClipper.Label.AttachPdfFile":"Attach PDF file","WebClipper.Label.AttachPdfFileSubText":"(all pages)","WebClipper.Label.ClipImageToOneNote":"Clip Image to OneNote","WebClipper.Label.ClipLocation":"Location","WebClipper.Label.ClipSelectionToOneNote":"Clip Selection to OneNote","WebClipper.Label.ClipSuccessful":"Clip Successful!","WebClipper.Label.DragAndRelease":"Drag and release to capture a screenshot","WebClipper.Label.OneNoteClipper":"OneNote Clipper","WebClipper.Label.OneNoteWebClipper":"OneNote Web Clipper","WebClipper.Label.OpenChangeLogFromTooltip":"Check out what's new","WebClipper.Label.Page":"Page","WebClipper.Label.PdfAllPagesRadioButton":"All pages","WebClipper.Label.PdfDistributePagesCheckbox":"New note for each PDF page","WebClipper.Label.PdfOptions":"PDF Options","WebClipper.Label.PdfTooLargeToAttach":"PDF too large to attach","WebClipper.Label.PdfTooltip":"Clip this PDF to OneNote, and read it later","WebClipper.Label.ProceedToWebClipper":"Proceed to the Web Clipper","WebClipper.Label.ProceedToWebClipperFun":"Try it out!","WebClipper.Label.ProductTooltip":"Clip and save product details like this to OneNote","WebClipper.Label.Ratings.Message.End":"Thanks for your feedback!","WebClipper.Label.Ratings.Message.Feedback":"Help us improve","WebClipper.Label.Ratings.Message.Init":"Enjoying the Web Clipper?","WebClipper.Label.Ratings.Message.Rate":"Glad you like it!","WebClipper.Label.Ratings.Button.Feedback":"Provide feedback","WebClipper.Label.Ratings.Button.Init.Positive":"Yes, it's great!","WebClipper.Label.Ratings.Button.Init.Negative":"Not really...","WebClipper.Label.Ratings.Button.NoThanks":"No thanks","WebClipper.Label.Ratings.Button.Rate":"Rate us 5 stars","WebClipper.Label.RecipeTooltip":"Save clutter-free recipes right to OneNote","WebClipper.Label.SignedIn":"Signed in","WebClipper.Label.SignInDescription":"Save anything on the web to OneNote in one click","WebClipper.Label.SignInUnsuccessfulMoreInformation":"More information","WebClipper.Label.SignInUnsuccessfulLessInformation":"Less information","WebClipper.Label.UnsupportedBrowser":"Sorry, your browser version is unsupported.","WebClipper.Label.WebClipper":"Web Clipper","WebClipper.Label.WebClipperWasUpdated":"OneNote Web Clipper has been updated","WebClipper.Label.WebClipperWasUpdatedFun":"OneNote Web Clipper is now better than ever!","WebClipper.Label.WhatsNew":"What's New","WebClipper.Label.VideoTooltip":"Clip this video and watch it anytime in OneNote","WebClipper.Popover.PdfInvalidPageRange":"We couldn't find page '{0}'","WebClipper.Preview.AugmentationModeGenericError":"Something went wrong creating the preview. Try again, or choose a different clipping mode.","WebClipper.Preview.BookmarkModeGenericError":"Something went wrong creating the bookmark. Try again, or choose a different clipping mode.","WebClipper.Preview.FullPageModeGenericError":"A preview isn't available, but you can still clip your page.","WebClipper.Preview.FullPageModeScreenshotDescription":"A full page screenshot of '{0}'","WebClipper.Preview.LoadingMessage":"Loading preview...","WebClipper.Preview.NoFullPageScreenshotFound":"No content found. Try another clipping mode.","WebClipper.Preview.NoContentFound":"No article found. Try another clipping mode.","WebClipper.Preview.UnableToClipLocalFile":"Local files can only be clipped using Region mode.","WebClipper.Preview.Header.AddAnotherRegionButtonLabel":"Add another region","WebClipper.Preview.Header.SansSerifButtonLabel":"Sans-serif","WebClipper.Preview.Header.SerifButtonLabel":"Serif","WebClipper.Preview.Spinner.ClipAnyTimeInFullPage":"In a hurry? You can clip any time in Full Page mode!","WebClipper.SectionPicker.DefaultLocation":"Default location","WebClipper.SectionPicker.LoadingNotebooks":"Loading notebooks...","WebClipper.SectionPicker.NoNotebooksFound":"You don't have any notebooks yet, so we'll create your default notebook when you clip this page.","WebClipper.SectionPicker.NotebookLoadFailureMessage":"OneNote couldn't load your notebooks. Please try again later.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessage":"OneNote couldn't load your notebooks.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessageWithExplanation":"We couldn't load your notebooks because a list limit was exceeded in OneDrive.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureLinkMessage":"Learn more","WebClipper.FontFamily.Regular":"Segoe UI Regular,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Bold":"Segoe UI Bold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Light":"Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Preview.SerifDefault":"Georgia","WebClipper.FontFamily.Preview.SansSerifDefault":"Verdana","WebClipper.FontFamily.Semibold":"Segoe UI Semibold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Semilight":"Segoe UI Semilight,Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontSize.Preview.SerifDefault":"16px","WebClipper.FontSize.Preview.SansSerifDefault":"16px"}},{}],45:[function(e,t,n){(function(o,i){!function(e,o){"object"==typeof n&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.ES6Promise=o()}(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function r(e){J=e}function a(e){Q=e}function s(){return function(){return o.nextTick(g)}}function l(){return"undefined"!=typeof Y?function(){Y(g)}:u()}function p(){var e=0,t=new $(g),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=g,function(){return e.port2.postMessage(0)}}function u(){var e=setTimeout;return function(){return e(g,1)}}function g(){for(var e=0;e<q;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}q=0}function d(){try{var t=e,n=t("vertx");return Y=n.runOnLoop||n.runOnContext,l()}catch(e){return u()}}function h(e,t){var n=arguments,o=this,i=new this.constructor(f);void 0===i[ie]&&R(i);var r=o._state;return r?!function(){var e=n[r-1];Q(function(){return O(r,i,e,o._result)})}():L(o,i,e,t),i}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(f);return P(n,e),n}function f(){}function C(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function y(e){try{return e.then}catch(e){return le.error=e,le}}function v(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}function S(e,t,n){Q(function(e){var o=!1,i=v(n,t,function(n){o||(o=!0,t!==n?P(e,n):E(e,n))},function(t){o||(o=!0,A(e,t))},"Settle: "+(e._label||" unknown promise"));!o&&i&&(o=!0,A(e,i))},e)}function T(e,t){t._state===ae?E(e,t._result):t._state===se?A(e,t._result):L(t,void 0,function(t){return P(e,t)},function(t){return A(e,t)})}function I(e,t,o){t.constructor===e.constructor&&o===h&&t.constructor.resolve===m?T(e,t):o===le?A(e,le.error):void 0===o?E(e,t):n(o)?S(e,t,o):E(e,t)}function P(e,n){e===n?A(e,C()):t(n)?I(e,n,y(n)):E(e,n)}function w(e){e._onerror&&e._onerror(e._result),F(e)}function E(e,t){e._state===re&&(e._result=t,e._state=ae,0!==e._subscribers.length&&Q(F,e))}function A(e,t){e._state===re&&(e._state=se,e._result=t,Q(w,e))}function L(e,t,n,o){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+ae]=n,i[r+se]=o,0===r&&e._state&&Q(F,e)}function F(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o=void 0,i=void 0,r=e._result,a=0;a<t.length;a+=3)o=t[a],i=t[a+n],o?O(n,o,i,r):i(r);e._subscribers.length=0}}function N(){this.error=null}function k(e,t){try{return e(t)}catch(e){return pe.error=e,pe}}function O(e,t,o,i){var r=n(o),a=void 0,s=void 0,l=void 0,p=void 0;if(r){if(a=k(o,i),a===pe?(p=!0,s=a.error,a=null):l=!0,t===a)return void A(t,b())}else a=i,l=!0;t._state!==re||(r&&l?P(t,a):p?A(t,s):e===ae?E(t,a):e===se&&A(t,a))}function W(e,t){try{t(function(t){P(e,t)},function(t){A(e,t)})}catch(t){A(e,t)}}function U(){return ce++}function R(e){e[ie]=ce++,e._state=void 0,e._result=void 0,e._subscribers=[]}function _(e,t){this._instanceConstructor=e,this.promise=new e(f),this.promise[ie]||R(this.promise),K(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&E(this.promise,this._result))):A(this.promise,D())}function D(){return new Error("Array Methods must be provided an Array")}function B(e){return new _(this,e).promise}function x(e){var t=this;return new t(K(e)?function(n,o){for(var i=e.length,r=0;r<i;r++)t.resolve(e[r]).then(n,o)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function H(e){var t=this,n=new t(f);return A(n,e),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function z(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(e){this[ie]=U(),this._result=this._state=void 0,this._subscribers=[],f!==e&&("function"!=typeof e&&M(),this instanceof V?W(this,e):z())}function G(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=V}var j=void 0;j=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var K=j,q=0,Y=void 0,J=void 0,Q=function(e,t){ne[q]=e,ne[q+1]=t,q+=2,2===q&&(J?J(g):oe())},X="undefined"!=typeof window?window:void 0,Z=X||{},$=Z.MutationObserver||Z.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),oe=void 0;oe=ee?s():$?p():te?c():void 0===X&&"function"==typeof e?d():u();var ie=Math.random().toString(36).substring(16),re=void 0,ae=1,se=2,le=new N,pe=new N,ce=0;return _.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===re&&n<e;n++)this._eachEntry(t[n],n)},_.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,o=n.resolve;if(o===m){var i=y(e);if(i===h&&e._state!==re)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===V){var r=new n(f);I(r,e,i),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},_.prototype._settledAt=function(e,t,n){var o=this.promise;o._state===re&&(this._remaining--,e===se?A(o,n):this._result[t]=n),0===this._remaining&&E(o,this._result)},_.prototype._willSettleAt=function(e,t){var n=this;L(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(se,t,e)})},V.all=B,V.race=x,V.resolve=m,V.reject=H,V._setScheduler=r,V._setAsap=a,V._asap=Q,V.prototype={constructor:V,then:h,catch:function(e){return this.then(null,e)}},V.polyfill=G,V.Promise=V,V})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:46}],46:[function(e,t,n){function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(e){if(u===setTimeout)return setTimeout(e,0);if((u===o||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function a(e){if(g===clearTimeout)return clearTimeout(e);if((g===i||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(e);try{return g(e)}catch(t){try{return g.call(null,e)}catch(t){return g.call(this,e)}}}function s(){f&&h&&(f=!1,h.length?m=h.concat(m):C=-1,m.length&&l())}function l(){if(!f){var e=r(s);f=!0;for(var t=m.length;t;){for(h=m,m=[];++C<t;)h&&h[C].run();C=-1,t=m.length}h=null,f=!1,a(e)}}function p(e,t){this.fun=e,this.array=t}function c(){}var u,g,d=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:o}catch(e){u=o}try{g="function"==typeof clearTimeout?clearTimeout:i}catch(e){g=i}}();var h,m=[],f=!1,C=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new p(e,t)),1!==m.length||f||r(l)},p.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}]},{},[12]);