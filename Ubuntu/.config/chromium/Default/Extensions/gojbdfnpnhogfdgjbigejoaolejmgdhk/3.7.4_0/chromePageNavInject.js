/*
The MIT License (MIT)

Copyright (c) 2015 OneNoteDev

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.OneNoteApi=t()}}(function(){return function t(e,r,n){function o(i,s){if(!r[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var p=new Error("Cannot find module '"+i+"'");throw p.code="MODULE_NOT_FOUND",p}var c=r[i]={exports:{}};e[i][0].call(c.exports,function(t){var r=e[i][1][t];return o(r?r:t)},c,c.exports,t,e,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(t,e,r){"use strict";var n=function(){function t(){this.operations=[],this.boundaryName="batch_"+Math.floor(1e3*Math.random())}return t.prototype.addOperation=function(t){this.operations.push(t)},t.prototype.getOperation=function(t){return this.operations[t]},t.prototype.getNumOperations=function(){return this.operations.length},t.prototype.getRequestBody=function(){var t=this,e="";return this.operations.forEach(function(r){var n="";n+="--"+t.boundaryName+"\r\n",n+="Content-Type: application/http\r\n",n+="Content-Transfer-Encoding: binary\r\n",n+="\r\n",n+=r.httpMethod+" "+r.uri+" HTTP/1.1\r\n",n+="Content-Type: "+r.contentType+"\r\n",n+="\r\n",n+=(r.content?r.content:"")+"\r\n",n+="\r\n",e+=n}),e+="--"+this.boundaryName+"--\r\n"},t.prototype.getContentType=function(){return'multipart/mixed; boundary="'+this.boundaryName+'"'},t}();r.BatchRequest=n},{}],2:[function(t,e,r){"use strict";!function(t){t[t.Html=0]="Html",t[t.Image=1]="Image",t[t.EnhancedUrl=2]="EnhancedUrl",t[t.Url=3]="Url",t[t.Onml=4]="Onml"}(r.ContentType||(r.ContentType={}));r.ContentType},{}],3:[function(t,e,r){"use strict";!function(t){t[t.NETWORK_ERROR=0]="NETWORK_ERROR",t[t.UNEXPECTED_RESPONSE_STATUS=1]="UNEXPECTED_RESPONSE_STATUS",t[t.REQUEST_TIMED_OUT=2]="REQUEST_TIMED_OUT",t[t.UNABLE_TO_PARSE_RESPONSE=3]="UNABLE_TO_PARSE_RESPONSE"}(r.RequestErrorType||(r.RequestErrorType={}));var n=r.RequestErrorType,o=function(){function t(){}return t.createRequestErrorObject=function(e,r){if(void 0!==e&&null!==e)return t.createRequestErrorObjectInternal(e.status,e.readyState,e.response,e.getAllResponseHeaders(),e.timeout,r)},t.createRequestErrorObjectInternal=function(e,r,o,a,i,s){var u=t.formatRequestErrorTypeAsString(s);s===n.NETWORK_ERROR&&(u+=t.getAdditionalNetworkErrorInfo(r)),s===n.REQUEST_TIMED_OUT&&(e=408);var p={error:u,statusCode:e,responseHeaders:t.convertResponseHeadersToJsonInternal(a),response:o};return i>0&&!(e>=200&&e<300)&&(p.timeout=i),p},t.convertResponseHeadersToJson=function(e){if(void 0!==e&&null!==e){var r=e.getAllResponseHeaders();return t.convertResponseHeadersToJsonInternal(r)}},t.convertResponseHeadersToJsonInternal=function(t){for(var e,r=/([^:]+):\s?(.*)/g,n={};e=r.exec(t);){e.index===r.lastIndex&&r.lastIndex++;var o=e[1].trim(),a=e[2].trim();n[o]=a}return n},t.getAdditionalNetworkErrorInfo=function(t){return": "+JSON.stringify({readyState:t})},t.formatRequestErrorTypeAsString=function(t){var e=n[t];return e.charAt(0).toUpperCase()+e.replace(/_/g," ").toLowerCase().slice(1)},t}();r.ErrorUtils=o},{}],4:[function(t,e,r){"use strict";var n=function(){function t(){}return t.sectionExistsInNotebooks=function(e,r){if(!e||!r)return!1;for(var n=0;n<e.length;n++)if(t.sectionExistsInParent(e[n],r))return!0;return!1},t.sectionExistsInParent=function(e,r){if(!e||!r)return!1;if(e.sections)for(var n=0;n<e.sections.length;n++){var o=e.sections[n];if(o&&o.id===r)return!0}if(e.sectionGroups)for(var n=0;n<e.sectionGroups.length;n++)if(t.sectionExistsInParent(e.sectionGroups[n],r))return!0;return!1},t.getPathFromNotebooksToSection=function(e,r){if(e&&r)for(var n=0;n<e.length;n++){var o=e[n],a=t.getPathFromParentToSection(o,r);if(a)return a}},t.getPathFromParentToSection=function(e,r){if(e&&r){if(e.sections)for(var n=0;n<e.sections.length;n++){var o=e.sections[n];if(r(o))return[e,o]}if(e.sectionGroups)for(var n=0;n<e.sectionGroups.length;n++){var a=e.sectionGroups[n],i=t.getPathFromParentToSection(a,r);if(i)return i.unshift(e),i}}},t.getDepthOfNotebooks=function(e){return e&&0!==e.length?e.map(function(e){return t.getDepthOfParent(e)}).reduce(function(t,e){return Math.max(t,e)}):0},t.getDepthOfParent=function(e){if(!e)return 0;var r=e.sections&&e.sections.length>0,n=r?1:0;if(e.sectionGroups)for(var o=0;o<e.sectionGroups.length;o++)n=Math.max(t.getDepthOfParent(e.sectionGroups[o]),n);return n+1},t}();r.NotebookUtils=n},{}],5:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=t("./oneNoteApiBase"),a=function(t){function e(e,r,n){void 0===r&&(r=3e4),void 0===n&&(n={}),t.call(this,e,r,n)}return n(e,t),e.prototype.createNotebook=function(t){var e=JSON.stringify({name:t});return this.requestPromise(this.getNotebooksUrl(),e)},e.prototype.createPage=function(t,e){var r=e?"/sections/"+e:"",n=r+"/pages",o=t.getTypedFormData();return this.requestPromise(n,o.asBlob(),o.getContentType())},e.prototype.sendBatchRequest=function(t){return this.enableBetaApi(),this.requestBasePromise("/$batch",t.getRequestBody(),t.getContentType(),"POST").then(this.disableBetaApi.bind(this))},e.prototype.getPage=function(t){var e="/pages/"+t;return this.requestPromise(e)},e.prototype.getPageContent=function(t){var e="/pages/"+t+"/content";return this.requestPromise(e)},e.prototype.getPages=function(t){var e="/pages";return t.top>0&&t.top===Math.floor(t.top)&&(e+="?top="+t.top),t.sectionId&&(e="/sections/"+t.sectionId+e),this.requestPromise(e)},e.prototype.updatePage=function(t,e){var r="/pages/"+t,n=r+"/content";return this.requestPromise(n,JSON.stringify(e),"application/json","PATCH")},e.prototype.createSection=function(t,e){var r={name:e},n=JSON.stringify(r);return this.requestPromise("/notebooks/"+t+"/sections/",n)},e.prototype.getNotebooks=function(t){return void 0===t&&(t=!0),this.requestPromise(this.getNotebooksUrl(null,t))},e.prototype.getNotebooksWithExpandedSections=function(t,e){return void 0===t&&(t=2),void 0===e&&(e=!0),this.requestPromise(this.getNotebooksUrl(t,e))},e.prototype.getNotebookByName=function(t){return this.requestPromise("/notebooks?filter=name%20eq%20%27"+encodeURI(t)+"%27&orderby=createdTime")},e.prototype.pagesSearch=function(t){return this.requestPromise(this.getSearchUrl(t))},e.prototype.getExpands=function(t){if(t<=0)return"";var e="$expand=sections,sectionGroups";return 1===t?e:e+"("+this.getExpands(t-1)+")"},e.prototype.getNotebooksUrl=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!0);var r=e?"$filter=userRole%20ne%20Microsoft.OneNote.Api.UserRole'Reader'":"";return"/notebooks?"+r+(t?"&"+this.getExpands(t):"")},e.prototype.getSearchUrl=function(t){return"/pages?search="+t},e.prototype.enableBetaApi=function(){this.useBetaApi=!0},e.prototype.disableBetaApi=function(){this.useBetaApi=!1},e}(o.OneNoteApiBase);r.OneNoteApi=a;var i=t("./contentType");r.ContentType=i.ContentType;var s=t("./oneNotePage");r.OneNotePage=s.OneNotePage;var u=t("./batchRequest");r.BatchRequest=u.BatchRequest;var p=t("./errorUtils");r.ErrorUtils=p.ErrorUtils,r.RequestErrorType=p.RequestErrorType;var c=t("./notebookUtils");r.NotebookUtils=c.NotebookUtils},{"./batchRequest":1,"./contentType":2,"./errorUtils":3,"./notebookUtils":4,"./oneNoteApiBase":6,"./oneNotePage":7}],6:[function(t,e,r){"use strict";var n=t("./errorUtils"),o=t("content-type"),a=function(){function t(t,e,r){void 0===r&&(r={}),this.useBetaApi=!1,this.token=t,this.timeout=e,this.headers=r}return t.prototype.requestBasePromise=function(t,e,r,n){var o=this.generateFullBaseUrl(t);return null===r&&(r="application/json"),this.makeRequest(o,e,r,n)},t.prototype.requestPromise=function(t,e,r,n){var o=this,a=this.generateFullUrl(t);return null===r&&(r="application/json"),new Promise(function(t,i){o.makeRequest(a,e,r,n).then(function(e){t(e)},function(t){i(t)})})},t.prototype.generateFullBaseUrl=function(t){var e=this.useBetaApi?"https://www.onenote.com/api/beta":"https://www.onenote.com/api/v1.0";return e+t},t.prototype.generateFullUrl=function(t){var e=this.useBetaApi?"https://www.onenote.com/api/beta/me/notes":"https://www.onenote.com/api/v1.0/me/notes";return e+t},t.prototype.makeRequest=function(e,r,a,i){var s=this;return new Promise(function(u,p){var c,f=new XMLHttpRequest;c=i?i:r?"POST":"GET",f.open(c,e),f.timeout=s.timeout,f.onload=function(){if(200===f.status||201===f.status||204===f.status)try{var t={type:""};try{t=o.parse(f.getResponseHeader("Content-Type"))}catch(e){}var r=f.response;switch(t.type){case"application/json":r=JSON.parse(f.response?f.response:"{}");break;case"text/html":default:r=f.response}u({parsedResponse:r,request:f})}catch(a){p(n.ErrorUtils.createRequestErrorObject(f,n.RequestErrorType.UNABLE_TO_PARSE_RESPONSE))}else p(n.ErrorUtils.createRequestErrorObject(f,n.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},f.onerror=function(){p(n.ErrorUtils.createRequestErrorObject(f,n.RequestErrorType.NETWORK_ERROR))},f.ontimeout=function(){p(n.ErrorUtils.createRequestErrorObject(f,n.RequestErrorType.REQUEST_TIMED_OUT))},a&&f.setRequestHeader("Content-Type",a),f.setRequestHeader("Authorization","Bearer "+s.token),t.addHeadersToRequest(f,s.headers),f.send(r)})},t.addHeadersToRequest=function(t,e){if(e)for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},t}();r.OneNoteApiBase=a},{"./errorUtils":3,"content-type":9}],7:[function(t,e,r){"use strict";var n=t("./typedFormData"),o=function(){function t(t,e,r,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===r&&(r="en-us"),void 0===n&&(n=void 0),this.dataParts=[],this.title=t,this.presentationBody=e,this.locale=r,this.pageMetadata=n}return t.prototype.getEntireOnml=function(){return'<html xmlns="http://www.w3.org/1999/xhtml" lang='+this.locale+">"+this.getHeadAsHtml()+"<body>"+this.presentationBody+"</body></html>"},t.prototype.getHeadAsHtml=function(){var t=this.getPageMetadataAsHtml(),e=this.formUtcOffsetString(new Date);return"<head><title>"+this.escapeHtmlEntities(this.title)+'</title><meta name="created" content="'+e+' ">'+t+"</head>"},t.prototype.getPageMetadataAsHtml=function(){var t="";if(this.pageMetadata)for(var e in this.pageMetadata)t+='<meta name="'+e+'" content="'+this.escapeHtmlEntities(this.pageMetadata[e])+'" />';return t},t.prototype.formUtcOffsetString=function(t){var e=t.getTimezoneOffset(),r=e>=0?"-":"+";e=Math.abs(e);var n=Math.floor(e/60)+"",o=Math.round(e%60)+"";return parseInt(n,10)<10&&(n="0"+n),parseInt(o,10)<10&&(o="0"+o),r+n+":"+o},t.prototype.generateMimePartName=function(t){return t+Math.floor(1e4*Math.random()).toString()},t.prototype.escapeHtmlEntities=function(t){var e=document.createElement("div");return e.innerText=t,e.innerHTML},t.prototype.getTypedFormData=function(){var t=new n.TypedFormData;t.append("Presentation",this.getEntireOnml(),"application/xhtml+xml");for(var e=0;e<this.dataParts.length;e++){var r=this.dataParts[e];t.append(r.name,r.content,r.type)}return t},t.prototype.addOnml=function(t){this.presentationBody+=t},t.prototype.addHtml=function(t){var e=this.generateMimePartName("Html");return this.dataParts.push({content:t,name:e,type:"text/HTML"}),this.addOnml('<img data-render-src="name:'+e+'"/>'),e},t.prototype.addImage=function(t){this.addOnml('<img src="'+t+'"/>')},t.prototype.addObjectUrlAsImage=function(t){this.addOnml('<img data-render-src="'+t+'"/>')},t.prototype.addAttachment=function(t,e){var r=this.generateMimePartName("Attachment");return this.dataParts.push({content:t,name:r,type:"application/pdf"}),this.addOnml('<object data-attachment="'+e+'" data="name:'+r+'" type="application/pdf" />'),r},t.prototype.addUrl=function(t){this.addOnml('<div data-render-src="'+t+'" data-render-method="extract" data-render-fallback="none"></div>')},t.prototype.addCitation=function(t,e,r){this.addOnml(t.replace("{0}",'<a href="'+(r?r:e)+'">'+e+"</a>"))},t}();r.OneNotePage=o},{"./typedFormData":8}],8:[function(t,e,r){"use strict";var n=function(){function t(){this.contentTypeMultipart="multipart/form-data; boundary=",this.dataParts=[],this.boundaryName="OneNoteTypedDataBoundary"+Math.floor(1e3*Math.random())}return t.prototype.getContentType=function(){return this.contentTypeMultipart+this.boundaryName},t.prototype.append=function(t,e,r){this.dataParts.push({content:e,name:t,type:r})},t.prototype.asBlob=function(){for(var t="--"+this.boundaryName,e=[t],r=0;r<this.dataParts.length;r++){var n=this.dataParts[r],o="\r\nContent-Type: "+n.type+'\r\nContent-Disposition: form-data; name="'+n.name+'"\r\n\r\n';e.push(o),e.push(n.content),e.push("\r\n"+t)}return e.push("--\r\n"),new Blob(e)},t}();r.TypedFormData=n},{}],9:[function(t,e,r){/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";function n(t){if(!t||"object"!=typeof t)throw new TypeError("argument obj is required");var e=t.parameters,r=t.type;if(!r||!h.test(r))throw new TypeError("invalid type");var n=r;if(e&&"object"==typeof e)for(var o,a=Object.keys(e).sort(),s=0;s<a.length;s++){if(o=a[s],!c.test(o))throw new TypeError("invalid parameter name");n+="; "+o+"="+i(e[o])}return n}function o(t){if(!t)throw new TypeError("argument string is required");if("object"==typeof t&&(t=a(t),"string"!=typeof t))throw new TypeError("content-type header is missing from object");if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var e=t.indexOf(";"),r=e!==-1?t.substr(0,e).trim():t.trim();if(!h.test(r))throw new TypeError("invalid media type");var n,o,i,p=new s(r.toLowerCase());for(u.lastIndex=e;o=u.exec(t);){if(o.index!==e)throw new TypeError("invalid parameter format");e+=o[0].length,n=o[1].toLowerCase(),i=o[2],'"'===i[0]&&(i=i.substr(1,i.length-2).replace(f,"$1")),p.parameters[n]=i}if(e!==-1&&e!==t.length)throw new TypeError("invalid parameter format");return p}function a(t){return"function"==typeof t.getHeader?t.getHeader("content-type"):"object"==typeof t.headers?t.headers&&t.headers["content-type"]:void 0}function i(t){var e=String(t);if(c.test(e))return e;if(e.length>0&&!p.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(d,"\\$1")+'"'}function s(t){this.parameters=Object.create(null),this.type=t}var u=/; *([!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+) */g,p=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,c=/^[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+$/,f=/\\([\u000b\u0020-\u00ff])/g,d=/([\\"])/g,h=/^[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+\/[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+$/;r.format=n,r.parse=o},{}]},{},[5])(5)});
!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";var r;!function(e){function t(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function n(){return!window.addEventListener||navigator.appVersion.indexOf("MSIE 9")>=0}function r(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return"IE"+e.substring(t+5,e.indexOf(".",t));if(e.indexOf("Trident/")>=0){var n=e.indexOf("rv:");return"IE"+e.substring(n+3,e.indexOf(".",n))}return e.indexOf("Edge/")>=0?"Edge":void 0}function o(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=700);var r=screen.width?(screen.width-t)/2:0,o=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+o+",left="+r+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}e.appendHiddenIframeToDocument=t,e.browserNotSupported=n,e.ieVersion=r,e.openPopupWindow=o}(r=n.BrowserUtils||(n.BrowserUtils={}))},{}],2:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],3:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":29}],4:[function(e,t,n){"use strict";var r,o=e("./clientType"),i=e("./constants"),a=e("./urlUtils");!function(e){function t(e,t,n){var r=a.UrlUtils.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return r=a.UrlUtils.addUrlQueryValue(r,"originalUrl",e.pageInfo.rawUrl),r=a.UrlUtils.addUrlQueryValue(r,"clipperId",e.clientInfo.clipperId),r=a.UrlUtils.addUrlQueryValue(r,"usid",t),r=a.UrlUtils.addUrlQueryValue(r,"type",o.ClientType[e.clientInfo.clipperType]),r=a.UrlUtils.addUrlQueryValue(r,"version",e.clientInfo.clipperVersion)}function n(e,t,n){return s(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function r(e,t,n){return s(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function s(e,t,n,r){var o=a.UrlUtils.addUrlQueryValue(e,i.Constants.Urls.QueryParams.authType,r);return o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.clipperId,t),o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.userSessionId,n)}e.generateFeedbackUrl=t,e.generateSignInUrl=n,e.generateSignOutUrl=r}(r=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":2,"./constants":10,"./urlUtils":72}],5:[function(e,t,n){"use strict";var r=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var r in this.functionMap)this.functionMap.hasOwnProperty(r)&&this.postMessage({data:r,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var o=t.data.toString();if(this.otherSideKeys[o]||(this.otherSideKeys[o]=!0),this.isSmartValueSubscription(o)){var i=o.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[o]){for(var s=this.queuedCalls[o],u=0;u<s.length;u++)this.postMessage(s[u]);delete this.queuedCalls[o]}}else{var l=this.functionMap[t.functionKey];if(l){var c=l(t.data);c&&c.then&&t.callbackKey&&c.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var r=n?n.param:void 0,o=void 0;n&&n.callback&&(o=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(o,n.callback));var i={data:r,functionKey:t};o&&(i.callbackKey=o),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,r){r&&t.subscribe(r,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,r=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(r),this.trackedSmartValues[t]=e,e.subscribe(r)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();r.initializationKey="INITIALIZATION-K3Y",r.acknowledgeKey="ACKNOWLEDGE-K3Y",r.registrationKey="REGISTER-FUNCTION-K3Y",r.setValuePrefix="SETVALUE-",r.callbackPostfix="-CALLBACK",n.Communicator=r},{}],6:[function(e,t,n){"use strict";var r=e("./communicator"),o=function(){function e(e,t,n,o){var i=new r.Communicator(e,n);i.setErrorHandler(o),i.onInitialized=function(){var e=[];i.handleDataPackage=function(t){e.push(t)};var a=new r.Communicator(t,n);a.setErrorHandler(o),a.onInitialized=function(){i.onInitialized=void 0,a.onInitialized=void 0;for(var t=0,n=e;t<n.length;t++){var r=n[t];a.postMessage(r)}i.handleDataPackage=function(e){a.postMessage(e)},a.handleDataPackage=function(e){i.postMessage(e)}}}}return e}();n.CommunicatorPassthrough=o},{"./communicator":5}],7:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return r(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(o.MessageHandler);n.IFrameMessageHandler=i},{"./messageHandler":8}],8:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=r},{}],9:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],10:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.userFlightingEndpoint=e.serviceDomain+"/webclipper/userflight",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var d;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(d=e.Settings||(e.Settings={}))}(r=n.Constants||(n.Constants={}))},{}],11:[function(e,t,n){"use strict";var r=e("./objectUtils"),o=function(){function e(){}return e.readCookie=function(e,t){r.ObjectUtils.isNullOrUndefined(t)&&(t=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),o=0,i=n;o<i.length;o++){var a=i[o];if(a[0].trim()===e)return a[1].trim()}},e}();n.CookieUtils=o},{"./objectUtils":61}],12:[function(e,t,n){"use strict";var r,o=e("./khanAcademyVideoExtractor"),i=e("./videoUtils"),a=e("./vimeoVideoExtractor"),s=e("./YoutubeVideoExtractor");!function(e){function t(e){var t=i.SupportedVideoDomains;switch(e){case t.KhanAcademy:return new o.KhanAcademyVideoExtractor;case t.Vimeo:return new a.VimeoVideoExtractor;case t.YouTube:return new s.YoutubeVideoExtractor;default:return}}e.createVideoExtractor=t}(r=n.VideoExtractorFactory||(n.VideoExtractorFactory={}))},{"./YoutubeVideoExtractor":13,"./khanAcademyVideoExtractor":15,"./videoUtils":17,"./vimeoVideoExtractor":18}],13:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./domUtils"),i=e("./videoExtractor"),a=e("../urlUtils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",t.youTubeVideoIdQueryKey="v",t.dataOriginalSrcAttribute="data-original-src",t}return r(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){if(!e)return[];var t=document.createElement("div");t.innerHTML=e;for(var n=t.getElementsByTagName("iframe"),r=[],o=0;o<n.length;o++)if(this.isYoutubeUrl(n[o].src)){var i=this.createEmbeddedVideoFromUrl(n[o].src);i&&r.push(i)}return r},t.prototype.isYoutubeUrl=function(e){return/[^\w]youtube\.com\/watch(\?v=(\w+)|.*\&v=(\w+))/.test(e)||/[^\w]youtube\.com\/embed\/(\w+)/.test(e)},t.prototype.createEmbeddedVideoFromUrl=function(e){if(e){if(0===a.UrlUtils.getPathname(e).indexOf("/watch"))return this.createEmbeddedVideoFromId(a.UrlUtils.getQueryValue(e,this.youTubeVideoIdQueryKey));if(0===a.UrlUtils.getPathname(e).indexOf("/embed")){var t=e.match(/youtube\.com\/embed\/([^?|\/?]+)/);return this.createEmbeddedVideoFromId(t[1])}}},t.prototype.createEmbeddedVideoFromId=function(e){if(e){var t=o.DomUtils.createEmbedVideoIframe(),n="https://www.youtube.com/embed/"+e;t.src=n;var r=a.UrlUtils.addUrlQueryValue(this.youTubeWatchVideoBaseUrl,this.youTubeVideoIdQueryKey,e);return t.setAttribute(this.dataOriginalSrcAttribute,r),t}},t}(i.VideoExtractor);n.YoutubeVideoExtractor=s},{"../urlUtils":72,"./domUtils":14,"./videoExtractor":16}],14:[function(e,t,n){"use strict";var r=e("../constants"),o=e("../objectUtils"),i=e("./videoUtils"),a=e("./VideoExtractorFactory"),s=function(){function e(){}return e.cleanHtml=function(t){var n=[];for(var r in e.attributesAllowedByOnml)e.attributesAllowedByOnml.hasOwnProperty(r)&&(n=n.concat(e.attributesAllowedByOnml[r]));var o=e.htmlTags.concat(e.markupTags).concat(e.tableTags),i=sanitizeHtml(t,{allowedTags:o,allowedAttributes:e.attributesAllowedByOnml,allowedSchemes:sanitizeHtml.defaults.allowedSchemes.concat(["data"]),allowedClasses:{"*":["MainArticleContainer"]}});return i},e.removeStylesWithBase64EncodedBinaries=function(t){e.domReplacer(t,"style",function(e){return e.innerHTML.indexOf("data:application")!==-1?void 0:e})},e.removeElementsNotSupportedInOnml=function(t){e.domReplacer(t,e.tagsNotSupportedInOnml.join());var n=[e.tags.main,e.tags.article,e.tags.figure,e.tags.header,e.tags.center];e.domReplacer(t,n.join(),function(t){var n=document.createElement("div");return n.innerHTML=e.cleanHtml(t.innerHTML),n})},e.domReplacer=function(e,t,n){void 0===n&&(n=function(){});for(var r=e.querySelectorAll(t),o=0;o<r.length;o++){var i=r[o];try{var a=n(i,o);a?i!==a&&i.parentNode.replaceChild(a,i):i.parentNode.removeChild(i)}catch(e){}}},e.domReplacerAsync=function(e,t,n){return void 0===n&&(n=function(){return Promise.resolve(void 0)}),new Promise(function(r){var o=e.querySelectorAll(t),i=0;0===o.length&&r();for(var a=function(e){var t=o[e];n(t,e).then(function(e){e?t!==e&&t.parentNode.replaceChild(e,t):t.parentNode.removeChild(t)},function(){}).then(function(){++i===o.length&&r()})},s=0;s<o.length;s++)a(s)})},e.getPageContentType=function(e){var t=e.createElement("a");if(t.href=e.URL,/\.pdf$/i.test(t.pathname))return OneNoteApi.ContentType.EnhancedUrl;var n=e.querySelector("embed");return n&&/application\/pdf/i.test(n.type)?OneNoteApi.ContentType.EnhancedUrl:window&&window.PDFJS?OneNoteApi.ContentType.EnhancedUrl:OneNoteApi.ContentType.Html},e.fetchCanonicalUrl=function(e){var t=e.querySelectorAll("link[rel=canonical]");if(0===t.length)return e.URL;for(var n=t[0].href,r=void 0,o=1;o<t.length;o++)r=t.item(o).href,r.length<n.length&&(n=r);return n},e.getCleanDomOfCurrentPage=function(t){var n=e.cloneDocument(t);e.convertCanvasElementsToImages(n,t),e.addBaseTagIfNecessary(n,t.location),e.addImageSizeInformationToDom(n),e.removeUnwantedItems(n);var r=e.getDomString(n);return r},e.removeUnwantedItems=function(t){e.removeStylesWithBase64EncodedBinaries(t),e.removeClipperElements(t),e.removeUnwantedElements(t),e.removeUnwantedAttributes(t),e.removeUnsupportedHrefs(t)},e.addPreviewContainerStyling=function(e){e.setAttribute("style","margin-bottom: 16px")},e.addEmbeddedVideosWhereSupported=function(t,n,r){var o=i.VideoUtils.videoDomainIfSupported(r);if(!o)return Promise.resolve();var s=[];try{var u=i.SupportedVideoDomains[o],l=a.VideoExtractorFactory.createVideoExtractor(u);l&&(s=s.concat(l.createEmbeddedVideosFromPage(r,n)))}catch(e){return Promise.reject({error:JSON.stringify({doc:t.outerHTML,pageContent:n,message:e.message})})}return Promise.resolve(e.addVideosToElement(t,s))},e.createEmbedVideoIframe=function(){var e=document.createElement("iframe");return e.width="600",e.height="338",e.frameBorder="0",e.allowFullscreen=!1,e},e.addVideosToElement=function(t,n){if(!o.ObjectUtils.isNullOrUndefined(t)&&!o.ObjectUtils.isNullOrUndefined(n)&&0!==n.length){for(var r,i=[],a=0,s=n;a<s.length;a++){var u=s[a];o.ObjectUtils.isNullOrUndefined(u.src)||o.ObjectUtils.isNullOrUndefined(u.getAttribute(e.dataOriginalSrcAttribute))?i.push({srcAttribute:"",dataOriginalSrcAttribute:""}):(r=e.insertIFrame(t,u,r),r=e.insertSpacer(t,r.nextSibling),i.push({srcAttribute:u.src,dataOriginalSrcAttribute:u.getAttribute(e.dataOriginalSrcAttribute)}))}return i}},e.insertIFrame=function(e,t,n){var r;return r=o.ObjectUtils.isNullOrUndefined(n)?e.children[0]:n.nextSibling,e.insertBefore(t,r)},e.insertSpacer=function(e,t){var n=document.createElement("br");return e.insertBefore(n,t)},e.cloneDocument=function(e){return e.cloneNode(!0)},e.addBaseTagIfNecessary=function(t,n){if(!t.head){var r=t.createElement(e.tags.head),o=t.getElementsByTagName(e.tags.html)[0];o.insertBefore(r,o.children[0])}n||(n=document.location);var i=t.head.getElementsByTagName(e.tags.base);if(0===i.length){var a=n.href.split("#")[0].split("?")[0];a=a.substr(0,a.lastIndexOf("/")+1);var s=t.createElement(e.tags.base);s.href=a,t.head.insertBefore(s,t.head.firstChild)}},e.removeBlankImages=function(t){return e.domReplacerAsync(t,e.tags.img,function(t){return new Promise(function(n){var r=t,o=new Image;o.crossOrigin="anonymous",o.onload=function(){n(e.imageIsBlank(o)?void 0:t)},o.onerror=function(){n(t)},o.src=r.src||r.getAttribute("src")})})},e.imageIsBlank=function(e){if(0===e.width||0===e.height)return!1;var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);try{for(var r=n.getImageData(0,0,t.width,t.height),o=r.data,i=0;i<o.length;i+=4)if(0!==o[i+3]&&(255!==o[i]||255!==o[i+1]||255!==o[i+2]))return!1;return!0}catch(e){return!1}},e.removeClipperElements=function(t){var n=this;e.domReplacer(t,["#"+r.Constants.Ids.clipperRootScript,"#"+r.Constants.Ids.clipperUiFrame,"#"+r.Constants.Ids.clipperExtFrame].join()),e.domReplacer(t,e.tags.iframe,function(e){var t=e,r=t.src;if(!n.isLocalReferenceUrl(r))return t})},e.removeUnsupportedHrefs=function(t){var n=this;e.domReplacer(t,e.tags.link,function(e){var t=e,r=t.href;if(!n.isLocalReferenceUrl(r))return t})},e.removeUnwantedElements=function(t){e.domReplacer(t,[e.tags.script,e.tags.noscript].join())},e.removeUnwantedAttributes=function(e){for(var t=e.getElementsByTagName("IMG"),n=0;n<t.length;n++){var r=t[n];r.srcset=void 0,r.removeAttribute("srcset")}},e.convertRelativeUrlsToAbsolute=function(t){e.domReplacer(t,e.tags.img,function(t,n){var r=t,o=r.attributes.src;if(o&&o.value)return r.src=e.toAbsoluteUrl(o.value,location.origin),r}),e.domReplacer(t,e.tags.a,function(t,n){var r=t,o=r.attributes.href;return o&&o.value?(r.href=e.toAbsoluteUrl(o.value,location.origin),r):t})},e.toAbsoluteUrl=function(e,t){if(!e||!t)throw new Error("parameters must be non-empty, but was: "+e+", "+t);/^\/\/[^\/]/.test(e)&&(e=location.protocol+e);var n=new URI(e);return n.is("relative")?n.absoluteTo(t).valueOf():e},e.convertCanvasElementsToImages=function(t,n){var r=n.querySelectorAll(e.tags.canvas);e.domReplacer(t,e.tags.canvas,function(n,o){var i=r[o];if(i){var a=t.createElement(e.tags.img);return a.src=i.toDataURL(),a.style.cssText=window.getComputedStyle(i).cssText,a}})},e.addImageSizeInformationToDom=function(e){for(var t=e.getElementsByTagName("img"),n=0;n<t.length;n++){var r=t[n];if(!r.hasAttribute("data-height")){
var o=r.height;r.setAttribute("data-height",o.toString())}if(!r.hasAttribute("data-width")){var i=r.width;r.setAttribute("data-width",i.toString())}}},e.getImageDataUrl=function(t){return new Promise(function(n,r){(o.ObjectUtils.isNullOrUndefined(t)||""===t)&&r({error:"image source is undefined or empty"});var i=new Image;i.crossOrigin="anonymous",i.onload=function(){var r=document.createElement(e.tags.canvas);r.width=i.naturalWidth,r.height=i.naturalHeight,r.getContext("2d").drawImage(i,0,0);try{var o=r.toDataURL("image/png");o=e.adjustImageQualityIfNecessary(r,o),n(o)}catch(e){n(t)}},i.onerror=function(e){var t,n=e.currentTarget;o.ObjectUtils.isNullOrUndefined(n)||(t=n.src),r({error:"onerror occurred fetching "+t})},i.src=t,(i.complete||void 0===i.complete)&&(i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i.src=t)})},e.adjustImageQualityIfNecessary=function(t,n,r,o){void 0===r&&(r=1),void 0===o&&(o=.1);for(var i=0;r>0&&n.length>e.maxBytesForMediaTypes;)n=t.toDataURL("image/jpeg",r),r-=o,i++;return n},e.getDomString=function(t){return e.getDoctype(t)+t.documentElement.outerHTML},e.getDocumentFromDomString=function(e,t){var n=document.implementation.createHTMLDocument(t);return n.documentElement.innerHTML=e,n},e.getDoctype=function(e){var t=e.doctype;return t?"<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">":""},e.getByteSize=function(t){return unescape?unescape(encodeURIComponent(t)).length:e.getByteArray(t).length},e.truncateStringToByteSize=function(t,n){var r=e.getByteArray(t);if(r.length<=n)return t;r=r.slice(0,n);for(var o=r.join("");o.length;)try{return o=o.slice(0,-1),decodeURIComponent(o)}catch(e){return""}},e.getByteArray=function(e){return encodeURIComponent(e).match(/%..|./g)||[]},e.getLocale=function(e){var t=e.getElementsByTagName("html")[0].getAttribute("lang");return t?t:window.navigator.language||window.navigator.userLanguage},e.getFileNameFromUrl=function(e){var t=e.createElement("a");if(t.href=e.URL,t.pathname.match(new RegExp(".pdf$","gi"))){var n=t.pathname.match(/[^\/]+$/g);if(n)return decodeURIComponent(n.pop())}return e.title},e.textNodesNoWhitespaceUnder=function(e){for(var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){if(!/^\s*$/.test(e.data))return NodeFilter.FILTER_ACCEPT}},!1),r=n.nextNode();r;)t.push(r),r=n.nextNode();return t},e.removeEventListenerAttributes=function(e){for(var t=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onload","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur"],n=0;n<t.length;n++)for(var r=e.querySelectorAll("["+t[n]+"]"),o=0;o<r.length;o++)r[o].removeAttribute(t[n])},e.toOnml=function(t){return e.removeElementsNotSupportedInOnml(t),e.removeDisallowedIframes(t),e.removeUnwantedItems(t),e.convertRelativeUrlsToAbsolute(t),e.removeAllStylesAndClasses(t),e.removeEventListenerAttributes(t),e.removeBlankImages(t)},e.removeDisallowedIframes=function(t){e.domReplacer(t,e.tags.iframe,function(e){var t=e.src,n=i.VideoUtils.videoDomainIfSupported(t);if(n){var r=i.SupportedVideoDomains[n],o=a.VideoExtractorFactory.createVideoExtractor(r);return o.createEmbeddedVideoFromUrl(t)}})},e.removeAllStylesAndClasses=function(t){e.domReplacer(t,"*",function(e,t){return e.removeAttribute("style"),e.removeAttribute("class"),e})},e.isScrolledIntoPartialView=function(e){var t=e.getBoundingClientRect().top,n=e.getBoundingClientRect().bottom,r=t<window.innerHeight&&n>=0;return r},e.getScrollPercent=function(e,t){if(void 0===t&&(t=!1),!e)return 0;var n=1*e.scrollTop/(e.scrollHeight-e.clientHeight);return t?n:100*n},e.isLocalReferenceUrl=function(e){return!(0===e.indexOf("https://")||0===e.indexOf("http://"))},e}();s.tags={a:"a",b:"b",applet:"applet",article:"article",audio:"audio",base:"base",body:"body",br:"br",button:"button",canvas:"canvas",center:"center",cite:"cite",code:"code",del:"del",div:"div",em:"em",embed:"embed",figure:"figure",font:"font",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",li:"li",link:"link",main:"main",map:"map",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",noscript:"noscript",object:"object",ol:"ol",p:"p",pre:"pre",progress:"progress",script:"script",span:"span",source:"source",strike:"strike",strong:"strong",style:"style",sub:"sub",sup:"sup",svg:"svg",table:"table",td:"td",title:"title",tr:"tr",u:"u",ul:"ul",video:"video"},s.attributesAllowedByOnml={a:["href","name","target"],img:["src"],"*":["src","background-color","color","font-family","font-size","data*","alt","height","width","style","id","type"]},s.tableTags=[s.tags.table,s.tags.td,s.tags.tr],s.markupTags=[s.tags.b,s.tags.em,s.tags.strong,s.tags.i,s.tags.u,s.tags.strike,s.tags.del,s.tags.sup,s.tags.sub,s.tags.cite,s.tags.font,s.tags.pre,s.tags.code],s.htmlTags=[s.tags.html,s.tags.head,s.tags.title,s.tags.meta,s.tags.body,s.tags.div,s.tags.span,s.tags.article,s.tags.figure,s.tags.header,s.tags.main,s.tags.center,s.tags.iframe,s.tags.a,s.tags.p,s.tags.br,s.tags.h1,s.tags.h2,s.tags.h3,s.tags.h4,s.tags.h5,s.tags.h6,s.tags.ul,s.tags.ol,s.tags.li,s.tags.img,s.tags.object,s.tags.video],s.tagsNotSupportedInOnml=[s.tags.applet,s.tags.audio,s.tags.button,s.tags.canvas,s.tags.embed,s.tags.hr,s.tags.input,s.tags.link,s.tags.map,s.tags.menu,s.tags.menuitem,s.tags.meter,s.tags.noscript,s.tags.progress,s.tags.script,s.tags.source,s.tags.style,s.tags.svg,s.tags.video],s.dataOriginalSrcAttribute="data-original-src",s.maxBytesForMediaTypes=2096652,n.DomUtils=s},{"../constants":10,"../objectUtils":61,"./VideoExtractorFactory":12,"./videoUtils":17}],15:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./videoExtractor"),i=e("./videoUtils"),a=e("./youtubeVideoExtractor"),s=function(e){function t(){var t=e.call(this)||this;return t.youtubeExtractor=new a.YoutubeVideoExtractor,t}return r(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){var t=this;if(!e)return[];var n=/\sid\s*=\s*("\s*video_(\S+)\s*"|'\s*video_(\S+)\s*')/gi,r=/data-youtubeid\s*=\s*("\s*video_(\S+)\s*"|'\s*video_(\S+)\s*')/gi,o=i.VideoUtils.matchRegexFromPageContent(e,[n,r]);return o?o.map(function(e){return t.createEmbeddedVideoFromId(e)}):[]},t.prototype.createEmbeddedVideoFromUrl=function(e){},t.prototype.createEmbeddedVideoFromId=function(e){return this.youtubeExtractor.createEmbeddedVideoFromId(e)},t}(o.VideoExtractor);n.KhanAcademyVideoExtractor=s},{"./videoExtractor":16,"./videoUtils":17,"./youtubeVideoExtractor":19}],16:[function(e,t,n){"use strict";var r=e("lodash"),o=function(){function e(){}return e.prototype.createEmbeddedVideosFromPage=function(e,t){var n=[],o=this.createEmbeddedVideoFromUrl(e);return o&&n.push(o),n=n.concat(this.createEmbeddedVideosFromHtml(t)),r.uniqWith(n,function(e,t){return e.src===t.src})},e}();n.VideoExtractor=o},{lodash:80}],17:[function(e,t,n){"use strict";var r,o=e("../objectUtils"),i=e("../urlUtils");!function(e){e[e.YouTube=0]="YouTube",e[e.Vimeo=1]="Vimeo",e[e.KhanAcademy=2]="KhanAcademy"}(r=n.SupportedVideoDomains||(n.SupportedVideoDomains={}));var a=function(){function e(){this.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",this.youTubeVideoIdQueryKey="v"}return e.videoDomainIfSupported=function(e){if(e){var t=e.toLowerCase();if(i.UrlUtils.onWhitelistedDomain(t)){var n=i.UrlUtils.getHostname(t).toLowerCase();for(var o in r){var a=r[o];if("string"==typeof a&&n.indexOf(a.toLowerCase()+".")>-1)return a}}}},e.matchRegexFromPageContent=function(e,t){if(!o.ObjectUtils.isNullOrUndefined(e)){var n,r=[];if(t.forEach(function(t){for(;n=t.exec(e);)n[2]?r.push(n[2]):n[3]&&r.push(n[3])}),0!==r.length)return r}},e}();n.VideoUtils=a},{"../objectUtils":61,"../urlUtils":72}],18:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./domUtils"),i=e("./videoExtractor"),a=e("./videoUtils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dataOriginalSrcAttribute="data-original-src",t}return r(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){var t=this;if(!e)return[];var n=/id\s*=\s*("\s*clip_(\d+)\s*"|'\s*clip_(\d+)\s*')/gi,r=/player\.vimeo\.com\/video\/((\d+))\d{0}/gi,o=a.VideoUtils.matchRegexFromPageContent(e,[n,r]);return o?o.map(function(e){return t.createEmbeddedVideoFromId(e)}):[]},t.prototype.createEmbeddedVideoFromUrl=function(e){if(e){var t=e.match(/^https?:\/\/vimeo\.com\/(\d+)\d{0}/);return t?this.createEmbeddedVideoFromId(t[1]):(t=e.match(/^https?:\/\/player.vimeo.com\/video\/(\d+)\d{0}/),t?this.createEmbeddedVideoFromId(t[1]):void 0)}},t.prototype.createEmbeddedVideoFromId=function(e){if(e){var t=o.DomUtils.createEmbedVideoIframe(),n="https://player.vimeo.com/video/"+e;return t.src=n,t.setAttribute(this.dataOriginalSrcAttribute,n),t}},t}(i.VideoExtractor);n.VimeoVideoExtractor=s},{"./domUtils":14,"./videoExtractor":16,"./videoUtils":17}],19:[function(e,t,n){arguments[4][13][0].apply(n,arguments)},{"../urlUtils":72,"./domUtils":14,"./videoExtractor":16,dup:13}],20:[function(e,t,n){"use strict";var r;!function(e){function t(e,t){var o=r[e];if(!n||!n[o])return!1;var i=n[o];return!(!t||t.indexOf(i)===-1)}var n={DummyExperiment:"dummy-flight"};e.updateIntervalForFlights=18e6;var r;!function(e){e[e.DummyExperiment=0]="DummyExperiment"}(r=e.Feature||(e.Feature={})),e.isFeatureEnabled=t}(r=n.Experiments||(n.Experiments={}))},{}],21:[function(e,t,n){"use strict";var r=e("../communicator/smartValue"),o=e("../logging/log"),i=e("../http/HttpWithRetries"),a=e("../storage/clipperStorageKeys"),s=e("../userInfo"),u=e("../constants"),l=e("../objectUtils"),c=e("../stringUtils"),p=e("../urlUtils"),f=function(){function e(e,t){this.user=new r.SmartValue,this.logger=t,this.clipperData=e}return e.prototype.updateUserInfoData=function(e,t){var n=this;return new Promise(function(r){var i=0,u=n.clipperData.getValue(a.ClipperStorageKeys.userInformation);if(u){var c=void 0;try{c=JSON.parse(u)}catch(e){n.logger.logJsonParseUnexpected(u)}c&&c.data&&l.ObjectUtils.isNumeric(c.data.accessTokenExpiration)&&(i=Math.max(1e3*c.data.accessTokenExpiration-18e4,0))}var p=function(){return n.getClipperInfoCookie(e).then(function(t){return n.retrieveUserInformation(e,t)})},f=new o.Event.PromiseEvent(o.Event.Label.GetExistingUserInformation);f.setCustomProperty(o.PropertyName.Custom.UserInformationStored,!!u),n.clipperData.getFreshValue(a.ClipperStorageKeys.userInformation,p,i).then(function(e){var r=n.isValidUserInformation(e.data);f.setCustomProperty(o.PropertyName.Custom.FreshUserInfoAvailable,r);var i=n.isThirdPartyCookiesEnabled(e.data);f.setCustomProperty(o.PropertyName.Custom.WriteableCookies,i),f.setCustomProperty(o.PropertyName.Custom.UserUpdateReason,s.UpdateReason[t]),r?n.user.set({user:e.data,lastUpdated:e.lastUpdated,updateReason:t,writeableCookies:i}):n.user.set({updateReason:t,writeableCookies:i})},function(e){f.setStatus(o.Status.Failed),f.setFailureInfo(e),n.user.set({updateReason:t})}).then(function(){n.logger.logEvent(f),r(n.user.get())})})},e.prototype.getClipperInfoCookie=function(e){return new Promise(function(e){var t=setTimeout(function(){e(void 0)},3e3);navigator.userAgent.search(/edge/i)!==-1?browser.cookies.get({url:u.Constants.Urls.serviceDomain,name:u.Constants.Cookies.clipperInfo},function(n){clearTimeout(t),e(n?n.value:"")}):(clearTimeout(t),e(void 0))})},e.prototype.deleteUserAuthenticationCookies=function(e){browser.cookies.remove({url:u.Constants.Urls.serviceDomain,name:u.Constants.Cookies.clipperInfo});var t=u.Constants.Urls.msaDomain;e===s.AuthType.OrgId&&(t=u.Constants.Urls.orgIdDomain),browser.cookies.getAll({url:t},function(e){for(var n=0;n<e.length;n++)browser.cookies.remove({url:t+e[n].path,name:e[n].name})})},e.prototype.retrieveUserInformation=function(e,t){var n=this;return void 0===t&&(t=void 0),new Promise(function(r,a){var s=p.UrlUtils.addUrlQueryValue(u.Constants.Urls.Authentication.userInformationUrl,u.Constants.Urls.QueryParams.clipperId,e),f=new o.Event.PromiseEvent(o.Event.Label.RetrieveUserInformation),g=c.StringUtils.generateGuid();f.setCustomProperty(o.PropertyName.Custom.CorrelationId,g);var d={};d["Content-type"]="application/x-www-form-urlencoded",d[u.Constants.HeaderValues.correlationId]=g;var h="";l.ObjectUtils.isNullOrUndefined(t)||(h=t.replace(/\+/g,"%2B")),i.HttpWithRetries.post(s,h,d).then(function(e){var t=e.response;r({parsedResponse:t,request:e})},function(e){f.setStatus(o.Status.Failed),f.setFailureInfo(e),a(e)}).then(function(){n.logger.logEvent(f)})})},e.prototype.isValidUserInformation=function(e){return!!(e&&e.accessToken&&e.accessTokenExpiration>0&&e.authType)},e.prototype.isThirdPartyCookiesEnabled=function(e){return void 0===e.cookieInRequest||e.cookieInRequest},e}();n.AuthenticationHelper=f},{"../communicator/smartValue":9,"../constants":10,"../http/HttpWithRetries":38,"../logging/log":46,"../objectUtils":61,"../storage/clipperStorageKeys":69,"../stringUtils":71,"../urlUtils":72,"../userInfo":73}],22:[function(e,t,n){"use strict";var r=e("../webExtensionBase/webExtensionPageNavInject"),o=e("../webExtensionBase/webExtension"),i=e("../webExtensionBase/webExtensionMessageHandler");o.WebExtension.browser=chrome,r.invoke({frameUrl:frameUrl,extMessageHandlerThunk:function(){return new i.WebExtensionContentMessageHandler}})},{"../webExtensionBase/webExtension":33,"../webExtensionBase/webExtensionMessageHandler":34,"../webExtensionBase/webExtensionPageNavInject":35}],23:[function(e,t,n){"use strict";var r=e("../clientType"),o=e("../constants"),i=e("../experiments"),a=e("../stringUtils"),s=e("../urlUtils"),u=e("../clipperUI/tooltipType"),l=e("../communicator/smartValue"),c=e("../http/HttpWithRetries"),p=e("../localization/localization"),f=e("../localization/localizationHelper"),g=e("../logging/log"),d=e("../storage/clipperStorageKeys"),h=e("../versioning/changeLog"),m=e("../versioning/changeLogHelper"),v=e("../versioning/version"),y=e("./authenticationHelper"),b=e("./tooltipHelper"),C=e("./workerPassthroughLogger"),w=function(){function e(t,n){this.setUnhandledExceptionLogging(),this.workers=[],this.logger=new C.WorkerPassthroughLogger(this.workers),e.extensionId=a.StringUtils.generateGuid(),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=new y.AuthenticationHelper(this.clipperData,this.logger),this.tooltip=new b.TooltipHelper(this.clipperData);var r=!1,o=this.clipperData.getValue(d.ClipperStorageKeys.clipperId);o||(r=!0,o=e.generateClipperId(),this.clipperData.setValue(d.ClipperStorageKeys.clipperId,o),this.updateLastSeenVersionInStorageToCurrent()),this.clientInfo=new l.SmartValue({clipperType:t,clipperVersion:e.getExtensionVersion(),clipperId:o}),r&&this.onFirstRun(),this.initializeUserFlighting(),this.listenForOpportunityToShowPageNavTooltip()}return e.getExtensionId=function(){return e.extensionId},e.getExtensionVersion=function(){return e.version},e.shouldCheckForMajorUpdates=function(e,t){return!!t&&(!e||e.isLesserThan(t))},e.prototype.addWorker=function(e){var t=this;e.setOnUnloading(function(){e.destroy(),t.removeWorker(e)}),this.workers.push(e)},e.prototype.getWorkers=function(){return this.workers},e.prototype.removeWorker=function(e){var t=this.workers.indexOf(e);t>-1&&this.workers.splice(t,1)},e.isOnOneNoteDomain=function(e){return e.indexOf("onenote.com")>=0||e.indexOf("onenote-int.com")>=0},e.prototype.fetchAndStoreLocStrings=function(){var e=this,t=navigator.language||navigator.userLanguage;return f.LocalizationHelper.makeLocStringsFetchRequest(t).then(function(n){try{var r=JSON.parse(n.parsedResponse);return r&&(e.clipperData.setValue(d.ClipperStorageKeys.locale,t),e.clipperData.setValue(d.ClipperStorageKeys.locStrings,n.parsedResponse),p.Localization.setLocalizedStrings(r)),Promise.resolve(r)}catch(e){return Promise.reject(void 0)}})},e.prototype.getClipperInstalledPageUrl=function(t,n,i){var a=o.Constants.Urls.clipperInstallPageUrl;return a=s.UrlUtils.addUrlQueryValue(a,o.Constants.Urls.QueryParams.clientType,r.ClientType[n]),a=s.UrlUtils.addUrlQueryValue(a,o.Constants.Urls.QueryParams.clipperId,t),a=s.UrlUtils.addUrlQueryValue(a,o.Constants.Urls.QueryParams.clipperVersion,e.getExtensionVersion()),a=s.UrlUtils.addUrlQueryValue(a,o.Constants.Urls.QueryParams.inlineInstall,i.toString()),this.logger.logTrace(g.Trace.Label.RequestForClipperInstalledPageUrl,g.Trace.Level.Information,a),a},e.prototype.getExistingWorkerForTab=function(e){for(var t=this.getWorkers(),n=0,r=t;n<r.length;n++){var o=r[n];if(o.getUniqueId()===e)return o}},e.prototype.getLastSeenVersion=function(){var e=this.clipperData.getValue(d.ClipperStorageKeys.lastSeenVersion);return e?new v.Version(e):void 0},e.prototype.getNewUpdates=function(e,t){var n=this;return new Promise(function(r,i){var a=n.clipperData.getValue(d.ClipperStorageKeys.displayLanguageOverride),u=a||navigator.language||navigator.userLanguage,l=s.UrlUtils.addUrlQueryValue(o.Constants.Urls.changelogUrl,o.Constants.Urls.QueryParams.changelogLocale,u);c.HttpWithRetries.get(l).then(function(n){try{for(var o=JSON.parse(n.responseText),a=void 0,s=0;s<o.length;s++)if(o[s].schemaVersion===h.ChangeLog.schemaVersionSupported){a=o[s].updates;break}if(!a)throw new Error("No matching schemas were found.");var u=m.ChangeLogHelper.getUpdatesBetweenVersions(a,e,t);r(u)}catch(e){i(e)}},function(e){i(e)})})},e.prototype.getOrCreateWorkerForTab=function(e,t){var n=t(e),r=this.getExistingWorkerForTab(n);return r||(r=this.createWorker(e),this.addWorker(r)),r},e.generateClipperId=function(){var e="ON";return e+"-"+a.StringUtils.generateGuid()},e.prototype.initializeUserFlighting=function(){var e=this,t=new g.Event.PromiseEvent(g.Event.Label.GetFlightingAssignments);this.getFlightingAssignments(this.clientInfo.get().clipperId).then(function(t){e.updateClientInfoWithFlightInformation(t)}).catch(function(n){e.updateClientInfoWithFlightInformation([]),t.setStatus(g.Status.Failed),t.setFailureInfo(n)}).then(function(){e.logger.logEvent(t)})},e.prototype.getFlightingAssignments=function(e){var t=function(){return new Promise(function(t,n){var r=s.UrlUtils.addUrlQueryValue(o.Constants.Urls.userFlightingEndpoint,o.Constants.Urls.QueryParams.clipperId,e);c.HttpWithRetries.get(r).then(function(e){t({request:e,parsedResponse:e.responseText})})})};return this.clipperData.getFreshValue(d.ClipperStorageKeys.flightingInfo,t,i.Experiments.updateIntervalForFlights).then(function(e){var t=e.data.Features?e.data.Features:[];return Promise.resolve(t)})},e.prototype.shouldShowTooltip=function(e,t){var n=this.checkIfTabMatchesATooltipType(e,t);if(n&&this.tooltip.tooltipDelayIsOver(n,Date.now()))return n},e.prototype.shouldShowVideoTooltip=function(e){return!(!this.checkIfTabIsAVideoDomain(e)||!this.tooltip.tooltipDelayIsOver(u.TooltipType.Video,Date.now()))},e.prototype.showTooltip=function(e,t){var n=this,r=this.getOrCreateWorkerForTab(e,this.getIdFromTab),o=new g.Event.BaseEvent(g.Event.Label.TooltipImpression);o.setCustomProperty(g.PropertyName.Custom.TooltipType,u.TooltipType[t]),o.setCustomProperty(g.PropertyName.Custom.LastSeenTooltipTime,this.tooltip.getTooltipInformation(d.ClipperStorageKeys.lastSeenTooltipTimeBase,t)),o.setCustomProperty(g.PropertyName.Custom.NumTimesTooltipHasBeenSeen,this.tooltip.getTooltipInformation(d.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,t)),r.invokeTooltip(t).then(function(e){if(e){n.tooltip.setTooltipInformation(d.ClipperStorageKeys.lastSeenTooltipTimeBase,t,Date.now().toString());var i=d.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,a=n.tooltip.getTooltipInformation(i,t)+1;n.tooltip.setTooltipInformation(d.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,t,a.toString())}o.setCustomProperty(g.PropertyName.Custom.FeatureEnabled,e),r.getLogger().logEvent(o)})},e.prototype.shouldShowWhatsNewTooltip=function(t,n,r){return this.checkIfTabIsOnWhitelistedUrl(t)&&e.shouldCheckForMajorUpdates(n,r)},e.prototype.showWhatsNewTooltip=function(e,t,n){var o=this;this.getNewUpdates(t,n).then(function(t){var n=m.ChangeLogHelper.filterUpdatesThatDontApplyToBrowser(t,r.ClientType[o.clientInfo.get().clipperType]);if(n&&n.length>0){var i=o.getOrCreateWorkerForTab(e,o.getIdFromTab);i.invokeWhatsNewTooltip(n).then(function(e){if(e){var t=new g.Event.BaseEvent(g.Event.Label.WhatsNewImpression);t.setCustomProperty(g.PropertyName.Custom.FeatureEnabled,e),i.getLogger().logEvent(t),o.updateLastSeenVersionInStorageToCurrent()}})}else o.updateLastSeenVersionInStorageToCurrent()},function(e){g.ErrorUtils.sendFailureLogRequest({label:g.Failure.Label.GetChangeLog,properties:{failureType:g.Failure.Type.Unexpected,failureInfo:{error:e},failureId:"GetChangeLog",stackTrace:e},clientInfo:o.clientInfo})})},e.prototype.listenForOpportunityToShowPageNavTooltip=function(){var t=this;this.addPageNavListener(function(n){var o;try{o=t.getLastSeenVersion()}catch(e){return void t.updateLastSeenVersionInStorageToCurrent()}var i=new v.Version(e.getExtensionVersion());if(t.clientInfo.get().clipperType!==r.ClientType.FirefoxExtension){var a=[u.TooltipType.Pdf,u.TooltipType.Product,u.TooltipType.Recipe],s=t.shouldShowTooltip(n,a);if(s)return void t.showTooltip(n,s);if(t.shouldShowVideoTooltip(n))return void t.showTooltip(n,u.TooltipType.Video)}if(t.shouldShowWhatsNewTooltip(n,o,i))return void t.showWhatsNewTooltip(n,o,i)})},e.prototype.setUnhandledExceptionLogging=function(){var e=this,t=window.onerror;window.onerror=function(n,r,o,i,a){var s=a?g.Failure.getStackTrace(a):"[unknown stacktrace]";g.ErrorUtils.sendFailureLogRequest({label:g.Failure.Label.UnhandledExceptionThrown,properties:{failureType:g.Failure.Type.Unexpected,failureInfo:{error:JSON.stringify({error:a.toString(),message:n,lineno:o,colno:i})},failureId:"ExtensionBase",stackTrace:s},clientInfo:e.clientInfo}),t&&t(n,r,o,i,a)}},e.prototype.updateClientInfoWithFlightInformation=function(e){this.clientInfo.set({clipperType:this.clientInfo.get().clipperType,clipperVersion:this.clientInfo.get().clipperVersion,clipperId:this.clientInfo.get().clipperId,flightingInfo:e})},e.prototype.updateLastSeenVersionInStorageToCurrent=function(){this.clipperData.setValue(d.ClipperStorageKeys.lastSeenVersion,e.getExtensionVersion())},e}();w.version="3.7.4",n.ExtensionBase=w},{"../clientType":2,"../clipperUI/tooltipType":3,"../communicator/smartValue":9,"../constants":10,"../experiments":20,"../http/HttpWithRetries":38,"../localization/localization":42,"../localization/localizationHelper":43,"../logging/log":46,"../storage/clipperStorageKeys":69,"../stringUtils":71,"../urlUtils":72,"../versioning/changeLog":74,"../versioning/changeLogHelper":75,"../versioning/version":76,"./authenticationHelper":21,"./tooltipHelper":32,"./workerPassthroughLogger":37}],24:[function(e,t,n){"use strict";var r=e("../browserUtils"),o=e("../clientType"),i=e("../clipperUrls"),a=e("../cookieUtils"),s=e("../constants"),u=e("../polyfills"),l=e("../userInfo"),c=e("../settings"),p=e("../clipperUI/tooltipType"),f=e("../communicator/communicator"),g=e("../communicator/smartValue"),d=e("../http/clipperCachedHttp"),h=e("../localization/localizationHelper"),m=e("../logging/log"),v=e("../logging/logHelpers"),y=e("../storage/clipperStorageKeys"),b=e("./extensionBase"),C=e("./invokeSource"),w=e("./invokeOptions"),S=function(){function e(e,t,n,r,o){this.clipperFunnelAlreadyLogged=!1,u.Polyfills.init(),this.onUnloading=function(){},this.uiCommunicator=new f.Communicator(r(),s.Constants.CommunicationChannels.extensionAndUi),this.pageNavUiCommunicator=new f.Communicator(r(),s.Constants.CommunicationChannels.extensionAndPageNavUi),this.debugLoggingInjectCommunicator=new f.Communicator(o(),s.Constants.CommunicationChannels.debugLoggingInjectedAndExtension),this.injectCommunicator=new f.Communicator(o(),s.Constants.CommunicationChannels.injectedAndExtension),this.pageNavInjectCommunicator=new f.Communicator(o(),s.Constants.CommunicationChannels.pageNavInjectedAndExtension),this.sessionId=new g.SmartValue,this.logger=LogManager.createExtLogger(this.sessionId,v.LogHelpers.isConsoleOutputEnabled()?this.debugLoggingInjectCommunicator:void 0),this.logger.logSessionStart(),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=t,this.clientInfo=e,this.logDeviceIdMapEvent(),this.initializeCommunicators(),this.initializeContextProperties()}return e.prototype.initializeContextProperties=function(){var e=this,t=this.clientInfo.get();if(this.logger.setContextProperty(m.Context.Custom.AppInfoId,c.Settings.getSetting("App_Id")),this.logger.setContextProperty(m.Context.Custom.ExtensionLifecycleId,b.ExtensionBase.getExtensionId()),this.logger.setContextProperty(m.Context.Custom.UserInfoId,void 0),this.logger.setContextProperty(m.Context.Custom.AuthType,"None"),this.logger.setContextProperty(m.Context.Custom.AppInfoVersion,t.clipperVersion),this.logger.setContextProperty(m.Context.Custom.DeviceInfoId,t.clipperId),this.logger.setContextProperty(m.Context.Custom.ClipperType,o.ClientType[t.clipperType]),t.flightingInfo)this.logger.setContextProperty(m.Context.Custom.FlightInfo,t.flightingInfo.join(","));else{var n=function(t){t.flightingInfo&&(e.clientInfo.unsubscribe(n),e.logger.setContextProperty(m.Context.Custom.FlightInfo,t.flightingInfo.join(",")))}.bind(this);this.clientInfo.subscribe(n,{callOnSubscribe:!1})}},e.prototype.getUniqueId=function(){return this.tabId},e.prototype.closeAllFramesAndInvokeClipper=function(e,t){this.pageNavInjectCommunicator.callRemoteFunction(s.Constants.FunctionKeys.closePageNavTooltip),this.invokeClipper(e,t)},e.prototype.getLogger=function(){return this.logger},e.prototype.invokeClipper=function(e,t){var n=this,r={invokeDataForMode:t?t.invokeDataForMode:void 0,invokeMode:t?t.invokeMode:w.InvokeMode.Default};this.sendInvokeOptionsToInject(r),this.isAllowedFileSchemeAccessBrowserSpecific(function(e){e||n.uiCommunicator.callRemoteFunction(s.Constants.FunctionKeys.extensionNotAllowedToAccessLocalFiles)}),this.invokeClipperBrowserSpecific().then(function(t){t&&!n.clipperFunnelAlreadyLogged&&(n.logger.logUserFunnel(m.Funnel.Label.Invoke),n.clipperFunnelAlreadyLogged=!0),n.logClipperInvoke(e,r)})},e.prototype.invokeWhatsNewTooltip=function(e){var t=this,n=new m.Event.PromiseEvent(m.Event.Label.InvokeWhatsNew);return this.registerLocalizedStringsForPageNav().then(function(r){return r?(t.registerWhatsNewCommunicatorFunctions(e),t.invokeWhatsNewTooltipBrowserSpecific(e).then(function(e){return e||(n.setStatus(m.Status.Failed),n.setFailureInfo({error:"invoking the What's New experience failed"})),t.logger.logEvent(n),Promise.resolve(e)})):(n.setStatus(m.Status.Failed),n.setFailureInfo({error:"getLocalizedStringsForBrowser returned undefined/null"}),t.logger.logEvent(n),Promise.resolve(!1))})},e.prototype.invokeTooltip=function(e){var t=this,n=new m.Event.PromiseEvent(m.Event.Label.InvokeTooltip);return n.setCustomProperty(m.PropertyName.Custom.TooltipType,p.TooltipType[e]),this.registerLocalizedStringsForPageNav().then(function(r){return r?(t.registerTooltipCommunicatorFunctions(e),t.invokeTooltipBrowserSpecific(e).then(function(e){return t.logger.logEvent(n),Promise.resolve(e)})):(n.setStatus(m.Status.Failed),n.setFailureInfo({error:"getLocalizedStringsForBrowser returned undefined/null"}),t.logger.logEvent(n),Promise.resolve(!1))})},e.prototype.setOnUnloading=function(e){this.onUnloading=e},e.prototype.destroy=function(){this.logger.logSessionEnd(m.Session.EndTrigger.Unload)},e.prototype.getLocalizedStrings=function(e,t){var n=this;this.logger.setContextProperty(m.Context.Custom.BrowserLanguage,e);var r=this.clipperData.getValue(y.ClipperStorageKeys.locale),o=!r||r!==e,i=new m.Event.BaseEvent(m.Event.Label.GetLocale);i.setCustomProperty(m.PropertyName.Custom.StoredLocaleDifferentThanRequested,o),this.logger.logEvent(i);var a=function(){return h.LocalizationHelper.makeLocStringsFetchRequest(e)},s=o?0:d.ClipperCachedHttp.getDefaultExpiry(),u=new m.Event.PromiseEvent(m.Event.Label.GetLocalizedStrings);u.setCustomProperty(m.PropertyName.Custom.ForceRetrieveFreshLocStrings,o),this.clipperData.getFreshValue(y.ClipperStorageKeys.locStrings,a,s).then(function(r){n.clipperData.setValue(y.ClipperStorageKeys.locale,e),t&&t(r?r.data:void 0)},function(e){u.setStatus(m.Status.Failed),u.setFailureInfo(e),t&&t(void 0)}).then(function(){n.logger.logEvent(u)})},e.prototype.getLocalizedStringsForBrowser=function(e){var t=this.clipperData.getValue(y.ClipperStorageKeys.displayLanguageOverride),n=t||navigator.language||navigator.userLanguage;this.getLocalizedStrings(n,e)},e.prototype.getUserSessionIdQueryParamValue=function(){var e=this.logger.getUserSessionId();return e?e:this.clientInfo.get().clipperId},e.prototype.invokeDebugLoggingIfEnabled=function(){return v.LogHelpers.isConsoleOutputEnabled()?this.invokeDebugLoggingBrowserSpecific():Promise.resolve(!1)},e.prototype.launchPopupAndWaitForClose=function(e){var t=this;return new Promise(function(n,o){var i,a=r.BrowserUtils.openPopupWindow(e),u=function(e){if(e.source===a){var n=void 0;try{n=JSON.parse(e.data)}catch(n){t.logger.logJsonParseUnexpected(e.data)}n&&(n[s.Constants.Urls.QueryParams.error]||n[s.Constants.Urls.QueryParams.errorDescription])&&(i={correlationId:n[s.Constants.Urls.QueryParams.correlationId],error:n[s.Constants.Urls.QueryParams.error],errorDescription:n[s.Constants.Urls.QueryParams.errorDescription]})}};window.addEventListener("message",u);var l=setInterval(function(){a&&!a.closed||(clearInterval(l),window.removeEventListener("message",u),i?o(i):n(!0))},100)})},e.prototype.logClipperInvoke=function(e,t){var n=new m.Event.BaseEvent(m.Event.Label.InvokeClipper);n.setCustomProperty(m.PropertyName.Custom.InvokeSource,C.InvokeSource[e.invokeSource]),n.setCustomProperty(m.PropertyName.Custom.InvokeMode,w.InvokeMode[t.invokeMode]),this.logger.logEvent(n)},e.prototype.registerTooltipToRenderInPageNav=function(e,t){this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.getTooltipToRenderInPageNav,function(){return Promise.resolve(e)}),this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.getPageNavTooltipProps,function(){return Promise.resolve(t)})},e.prototype.registerWhatsNewCommunicatorFunctions=function(e){this.registerTooltipToRenderInPageNav(p.TooltipType.WhatsNew,{updates:e})},e.prototype.registerTooltipCommunicatorFunctions=function(e){this.registerTooltipToRenderInPageNav(e)},e.prototype.sendInvokeOptionsToInject=function(e){this.injectCommunicator.callRemoteFunction(s.Constants.FunctionKeys.setInvokeOptions,{param:e})},e.prototype.setUpNoOpTrackers=function(e){var t=m.ErrorUtils.setNoOpTrackerRequestTimeout({label:m.NoOp.Label.InitializeCommunicator,channel:s.Constants.CommunicationChannels.injectedAndExtension,clientInfo:this.clientInfo,url:e},!0);this.injectCommunicator.callRemoteFunction(s.Constants.FunctionKeys.noOpTracker,{param:(new Date).getTime(),callback:function(){clearTimeout(t)}});var n=m.ErrorUtils.setNoOpTrackerRequestTimeout({label:m.NoOp.Label.InitializeCommunicator,channel:s.Constants.CommunicationChannels.extensionAndUi,clientInfo:this.clientInfo,url:e},!0);this.uiCommunicator.callRemoteFunction(s.Constants.FunctionKeys.noOpTracker,{param:(new Date).getTime(),callback:function(){clearTimeout(n)}})},e.prototype.doSignOutActionInFrontEnd=function(e){var t=this.getUserSessionIdQueryParamValue(),n=i.ClipperUrls.generateSignOutUrl(this.clientInfo.get().clipperId,t,l.AuthType[e]);this.uiCommunicator.callRemoteFunction(s.Constants.FunctionKeys.createHiddenIFrame,{
param:n})},e.prototype.initializeCommunicators=function(){this.initializeDebugLoggingCommunicators(),this.initializeClipperCommunicators(),this.initializePageNavCommunicators()},e.prototype.initializeClipperCommunicators=function(){this.initializeClipperUiCommunicator(),this.initializeClipperInjectCommunicator()},e.prototype.initializeClipperUiCommunicator=function(){var e=this;this.uiCommunicator.broadcastAcrossCommunicator(this.auth.user,s.Constants.SmartValueKeys.user),this.uiCommunicator.broadcastAcrossCommunicator(this.clientInfo,s.Constants.SmartValueKeys.clientInfo),this.uiCommunicator.broadcastAcrossCommunicator(this.sessionId,s.Constants.SmartValueKeys.sessionId),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.clipperStrings,function(){return new Promise(function(t){e.getLocalizedStringsForBrowser(function(e){t(e)})})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.getStorageValue,function(t){return new Promise(function(n){var r=e.clipperData.getValue(t);n(r)})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.getMultipleStorageValues,function(t){return new Promise(function(n){for(var r={},o=0,i=t;o<i.length;o++){var a=i[o];r[a]=e.clipperData.getValue(a)}n(r)})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.setStorageValue,function(t){e.clipperData.setValue(t.key,t.value)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.getInitialUser,function(){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,l.UpdateReason.InitialRetrieval)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.signInUser,function(t){return e.doSignInAction(t).then(function(t){if(t)return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,l.UpdateReason.SignInAttempt).then(function(e){return Promise.resolve(e)});var n={updateReason:l.UpdateReason.SignInCancel};return e.auth.user.set(n),Promise.resolve(n)}).catch(function(t){return e.auth.user.set({updateReason:l.UpdateReason.SignInAttempt}),t.updateReason=l.UpdateReason.SignInAttempt,Promise.reject(t)})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.signOutUser,function(t){e.clientInfo.get().clipperType===o.ClientType.EdgeExtension?e.doSignOutActionInFrontEnd(t):e.doSignOutAction(t),e.auth.user.set({updateReason:l.UpdateReason.SignOutAction}),e.clipperData.setValue(y.ClipperStorageKeys.userInformation,void 0),e.clipperData.setValue(y.ClipperStorageKeys.currentSelectedSection,void 0),e.clipperData.setValue(y.ClipperStorageKeys.cachedNotebooks,void 0)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.telemetry,function(t){m.parseAndLogDataPackage(t,e.logger)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.ensureFreshUserBeforeClip,function(){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,l.UpdateReason.TokenRefreshForPendingClip)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.takeTabScreenshot,function(){return e.takeTabScreenshot()}),this.uiCommunicator.setErrorHandler(function(t){m.ErrorUtils.handleCommunicatorError(s.Constants.CommunicationChannels.extensionAndUi,t,e.clientInfo)})},e.prototype.initializeClipperInjectCommunicator=function(){var e=this;this.injectCommunicator.broadcastAcrossCommunicator(this.clientInfo,s.Constants.SmartValueKeys.clientInfo),this.injectCommunicator.registerFunction(s.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()}),this.injectCommunicator.registerFunction(s.Constants.FunctionKeys.setStorageValue,function(t){e.clipperData.setValue(t.key,t.value)}),this.injectCommunicator.setErrorHandler(function(t){m.ErrorUtils.handleCommunicatorError(s.Constants.CommunicationChannels.injectedAndExtension,t,e.clientInfo)})},e.prototype.initializeDebugLoggingCommunicators=function(){var e=this;this.debugLoggingInjectCommunicator.registerFunction(s.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()})},e.prototype.initializePageNavCommunicators=function(){this.initializePageNavUiCommunicator(),this.initializePageNavInjectCommunicator()},e.prototype.initializePageNavUiCommunicator=function(){var e=this;this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.telemetry,function(t){m.parseAndLogDataPackage(t,e.logger)}),this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.invokeClipperFromPageNav,function(t){e.closeAllFramesAndInvokeClipper({invokeSource:t},{invokeMode:w.InvokeMode.Default})})},e.prototype.initializePageNavInjectCommunicator=function(){var e=this;this.pageNavInjectCommunicator.registerFunction(s.Constants.FunctionKeys.telemetry,function(t){m.parseAndLogDataPackage(t,e.logger)}),this.pageNavInjectCommunicator.registerFunction(s.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()})},e.prototype.registerLocalizedStringsForPageNav=function(){var e=this;return new Promise(function(t){e.getLocalizedStringsForBrowser(function(n){n&&e.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.clipperStringsFrontLoaded,function(){return Promise.resolve(n)}),t(!!n)})})},e.prototype.tearDownCommunicators=function(){this.uiCommunicator.tearDown(),this.pageNavUiCommunicator.tearDown(),this.injectCommunicator.tearDown(),this.pageNavInjectCommunicator.tearDown()},e.prototype.logDeviceIdMapEvent=function(){var e=this.clientInfo.get().clipperId,t=a.CookieUtils.readCookie("MicrosoftApplicationsTelemetryDeviceId");if(t!==e){var n=new m.Event.BaseEvent(m.Event.Label.DeviceIdMap);n.setCustomProperty(m.PropertyName.Custom.DeviceIdInStorage,e),n.setCustomProperty(m.PropertyName.Custom.DeviceIdInCookie,t),this.logger.logEvent(n)}},e}();n.ExtensionWorkerBase=S},{"../browserUtils":1,"../clientType":2,"../clipperUI/tooltipType":3,"../clipperUrls":4,"../communicator/communicator":5,"../communicator/smartValue":9,"../constants":10,"../cookieUtils":11,"../http/clipperCachedHttp":40,"../localization/localizationHelper":43,"../logging/log":46,"../logging/logHelpers":47,"../polyfills":63,"../settings":65,"../storage/clipperStorageKeys":69,"../userInfo":73,"./extensionBase":23,"./invokeOptions":28,"./invokeSource":29}],25:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../communicator/iframeMessageHandler"),i=e("./injectBase"),a=function(e){function t(t){var n=e.call(this,t)||this;try{n.initFrameInDom(),n.initializeUiCommunicator(),n.initializePassthroughCommunicator(n.getExtMessageHandlerThunk()),n.checkForNoOps()}catch(e){throw n.handleConstructorError(e),e}return n}return r(t,e),t.prototype.getFrame=function(){return this.frame},t.prototype.closeFrame=function(){this.frame&&(this.frame.parentNode.removeChild(this.frame),this.frame=void 0)},t.prototype.generateInlineExtThunk=function(){var e=this;return this.frame||this.initFrameInDom(),function(){return new o.IFrameMessageHandler(function(){return e.frame.contentWindow})}},t.prototype.initFrameInDom=function(){this.frame||(this.createFrame(),document.documentElement.appendChild(this.frame))},t}(i.InjectBase);n.FrameInjectBase=a},{"../communicator/iframeMessageHandler":7,"./injectBase":26}],26:[function(e,t,n){"use strict";var r=e("../polyfills"),o=function(){function e(e){try{r.Polyfills.init(),this.options=e,this.init(),this.initializeExtCommunicator(this.getExtMessageHandlerThunk()),this.initializeEventListeners()}catch(e){throw this.handleConstructorError(e),e}}return e.prototype.getExtMessageHandlerThunk=function(){return this.options.extMessageHandlerThunk?this.options.extMessageHandlerThunk:this.generateInlineExtThunk()},e}();n.InjectBase=o},{"../polyfills":63}],27:[function(e,t,n){"use strict";var r=e("../localization/localization"),o=function(){function e(){}return e.alertUserOfUnclippablePage=function(){alert(r.Localization.getLocalizedString("WebClipper.Error.CannotClipPage"))},e.isKnownUninjectablePage=function(t){if(!t)return!1;for(var n=0;n<e.isKnownUninjectablePage.length;n++)if(e.uninjectableUrlRegexes[n].test(t))return!0;return!1},e}();o.uninjectableUrlRegexes=[/^about:/],n.InjectHelper=o},{"../localization/localization":42}],28:[function(e,t,n){"use strict";var r;!function(e){e[e.ContextImage=0]="ContextImage",e[e.ContextTextSelection=1]="ContextTextSelection",e[e.Default=2]="Default"}(r=n.InvokeMode||(n.InvokeMode={}))},{}],29:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(r=n.InvokeSource||(n.InvokeSource={}))},{}],30:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("../urlUtils"),a=e("../domParsers/domUtils"),s=e("../communicator/communicator"),u=e("../communicator/communicatorPassthrough"),l=e("../communicator/iframeMessageHandler"),c=e("../communicator/smartValue"),p=e("../logging/log"),f=e("../logging/communicatorLoggerPure"),g=e("./styledFrameFactory"),d=e("./frameInjectBase"),h=function(e){function t(t){var n=e.call(this,t)||this;return n.logger=new f.CommunicatorLoggerPure(n.extCommunicator),n.setPageInfoContextProperties(),n}return r(t,e),t.main=function(e){document.getElementById(o.Constants.Ids.clipperPageNavFrame)||(window.pageNavInjectObject=new t(e))},t.prototype.checkForNoOps=function(){},t.prototype.createFrame=function(){this.frame=g.StyledFrameFactory.getStyledFrame(g.Frame.PageNav),this.frame.id=o.Constants.Ids.clipperPageNavFrame,this.frame.src=this.options.frameUrl},t.prototype.handleConstructorError=function(e){p.ErrorUtils.sendFailureLogRequest({label:p.Failure.Label.UnhandledExceptionThrown,properties:{failureType:p.Failure.Type.Unexpected,failureInfo:{error:JSON.stringify({error:e.toString(),url:window.location.href})},failureId:"PageNavInject",stackTrace:p.Failure.getStackTrace(e)}})},t.prototype.init=function(){this.pageInfo=new c.SmartValue},t.prototype.initializeExtCommunicator=function(e){var t=this;this.extCommunicator=new s.Communicator(e(),o.Constants.CommunicationChannels.pageNavInjectedAndExtension),this.extCommunicator.registerFunction(o.Constants.FunctionKeys.closePageNavTooltip,function(){t.closeFrame()})},t.prototype.initializeEventListeners=function(){var e=this;window.onbeforeunload=function(t){e.extCommunicator.callRemoteFunction(o.Constants.FunctionKeys.unloadHandler)}},t.prototype.initializePassthroughCommunicator=function(e){var t=this;new u.CommunicatorPassthrough(e(),new l.IFrameMessageHandler(function(){return t.frame.contentWindow}),o.Constants.CommunicationChannels.extensionAndPageNavUi)},t.prototype.initializeUiCommunicator=function(){var e=this;this.uiCommunicator=new s.Communicator(new l.IFrameMessageHandler(function(){return e.frame.contentWindow}),o.Constants.CommunicationChannels.pageNavInjectedAndPageNavUi),this.uiCommunicator.registerFunction(o.Constants.FunctionKeys.closePageNavTooltip,function(){e.closeFrame()}),this.uiCommunicator.registerFunction(o.Constants.FunctionKeys.updateFrameHeight,function(t){e.frame.style.height=t+o.Constants.Styles.clipperUiTopRightOffset+2*o.Constants.Styles.clipperUiDropShadowBuffer+"px"})},t.prototype.setPageInfoContextProperties=function(){this.logger.setContextProperty(p.Context.Custom.ContentType,OneNoteApi.ContentType[a.DomUtils.getPageContentType(document)]),this.logger.setContextProperty(p.Context.Custom.InvokeHostname,i.UrlUtils.getHostname(document.URL)),this.logger.setContextProperty(p.Context.Custom.PageLanguage,a.DomUtils.getLocale(document))},t}(d.FrameInjectBase);n.PageNavInject=h},{"../communicator/communicator":5,"../communicator/communicatorPassthrough":6,"../communicator/iframeMessageHandler":7,"../communicator/smartValue":9,"../constants":10,"../domParsers/domUtils":14,"../logging/communicatorLoggerPure":45,"../logging/log":46,"../urlUtils":72,"./frameInjectBase":25,"./styledFrameFactory":31}],31:[function(e,t,n){"use strict";var r,o=e("../constants"),i=e("../localization/rtl");!function(e){e[e.WebClipper=0]="WebClipper",e[e.PageNav=1]="PageNav"}(r=n.Frame||(n.Frame={}));var a=function(){function e(){}return e.getStyledFrame=function(t){switch(t){case r.WebClipper:return e.getStyledWebClipperFrame();default:case r.PageNav:return e.getStyledPageNavFrame()}},e.applyGlobalStyles=function(e){i.Rtl.isRtl(navigator.language||navigator.userLanguage)?(e.style.left="0px",e.style.right="auto"):(e.style.left="auto",e.style.right="0px"),e.style.top="0px",e.style.bottom="auto",e.style.border="none",e.style.display="block",e.style.margin="0px",e.style.maxHeight="none",e.style.maxWidth="none",e.style.minHeight="0px",e.style.minWidth="0px",e.style.overflow="hidden",e.style.padding="0px",e.style.position="fixed",e.style.transition="initial",e.style.zIndex="2147483647"},e.getGloballyStyledFrame=function(){var t=document.createElement("iframe");return e.applyGlobalStyles(t),t},e.getStyledPageNavFrame=function(){var t=e.getGloballyStyledFrame();return t.style.width=o.Constants.Styles.clipperUiWidth+o.Constants.Styles.clipperUiTopRightOffset+o.Constants.Styles.clipperUiDropShadowBuffer+"px",t},e.getStyledWebClipperFrame=function(){var t=e.getGloballyStyledFrame();return t},e}();n.StyledFrameFactory=a},{"../constants":10,"../localization/rtl":44}],32:[function(e,t,n){"use strict";var r=e("../constants"),o=e("../objectUtils"),i=e("../clipperUI/tooltipType"),a=e("../storage/clipperStorageKeys"),s=function(){function e(e){this.storage=e,this.validTypes=[i.TooltipType.Pdf,i.TooltipType.Product,i.TooltipType.Recipe,i.TooltipType.Video]}return e.prototype.getTooltipInformation=function(t,n){if(o.ObjectUtils.isNullOrUndefined(t)||o.ObjectUtils.isNullOrUndefined(n))throw new Error("Invalid argument passed to getTooltipInformation");var r=e.getStorageKeyForTooltip(t,n),i=this.storage.getValue(r),a=parseInt(i,10);return isNaN(a)?0:a},e.prototype.setTooltipInformation=function(t,n,r){if(o.ObjectUtils.isNullOrUndefined(t)||o.ObjectUtils.isNullOrUndefined(n))throw new Error("Invalid argument passed to setTooltipInformation");var i=e.getStorageKeyForTooltip(t,n);this.storage.setValue(i,r)},e.prototype.tooltipDelayIsOver=function(e,t){if(o.ObjectUtils.isNullOrUndefined(e)||o.ObjectUtils.isNullOrUndefined(t))throw new Error("Invalid argument passed to tooltipDelayIsOver");var n=this.getTooltipInformation(a.ClipperStorageKeys.lastClippedTooltipTimeBase,e);if(0!==n)return!1;var i=this.getTooltipInformation(a.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,e);if(i>=r.Constants.Settings.maximumNumberOfTimesToShowTooltips)return!1;this.getTooltipInformation(a.ClipperStorageKeys.lastSeenTooltipTimeBase,e);if(this.tooltipHasBeenSeenInLastTimePeriod(e,t,r.Constants.Settings.timeBetweenSameTooltip))return!1;var s=this.validTypes.indexOf(e),u=this.validTypes.slice();return u.splice(s,1),!this.hasAnyTooltipBeenSeenInLastTimePeriod(t,u,r.Constants.Settings.timeBetweenDifferentTooltips)},e.getStorageKeyForTooltip=function(e,t){if(o.ObjectUtils.isNullOrUndefined(e)||o.ObjectUtils.isNullOrUndefined(t))throw new Error("Invalid argument passed to getStorageKeyForTooltip");return e+i.TooltipType[t]},e.prototype.tooltipHasBeenSeenInLastTimePeriod=function(e,t,n){var r=this.getTooltipInformation(a.ClipperStorageKeys.lastSeenTooltipTimeBase,e);return 0!==r&&t-r<n},e.prototype.hasAnyTooltipBeenSeenInLastTimePeriod=function(e,t,n){var r=this;return t.some(function(t){var o=r.tooltipHasBeenSeenInLastTimePeriod(t,e,n);return o})},e}();n.TooltipHelper=s},{"../clipperUI/tooltipType":3,"../constants":10,"../objectUtils":61,"../storage/clipperStorageKeys":69}],33:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../../clientType"),i=e("../../urlUtils"),a=e("../../domParsers/videoUtils"),s=e("../../localization/localization"),u=e("../../storage/clipperData"),l=e("../../storage/localStorage"),c=e("../extensionBase"),p=e("../invokeSource"),f=e("../invokeOptions"),g=e("./webExtensionWorker"),d=function(e){function t(t,n){var r=e.call(this,t,new u.ClipperData(new l.LocalStorage))||this;return r.injectUrls=n,r.registerBrowserButton(),r.registerContextMenuItems(),r.registerInstallListener(),r.registerTabRemoveListener(),r}return r(t,e),t.getExtensionVersion=function(){return t.browser.runtime.getManifest().version},t.prototype.addPageNavListener=function(e){t.browser.webNavigation.onCompleted.addListener(function(n){0===n.frameId&&t.browser.tabs.get(n.tabId,function(n){!t.browser.runtime.lastError&&n&&e(n)})})},t.prototype.checkIfTabIsOnWhitelistedUrl=function(e){return!i.UrlUtils.onBlacklistedDomain(e.url)&&i.UrlUtils.onWhitelistedDomain(e.url)},t.prototype.createWorker=function(e){return new g.WebExtensionWorker(this.injectUrls,e,this.clientInfo,this.auth)},t.prototype.getIdFromTab=function(e){return e.id},t.prototype.onFirstRun=function(){this.onInstalledSupported()||this.onInstalled()},t.prototype.checkIfTabMatchesATooltipType=function(e,t){if(!i.UrlUtils.onBlacklistedDomain(e.url))return i.UrlUtils.checkIfUrlMatchesAContentType(e.url,t)},t.prototype.checkIfTabIsAVideoDomain=function(e){var t=a.VideoUtils.videoDomainIfSupported(e.url);return!!t},t.prototype.invokeClipperInTab=function(e,t,n){var r=this.getOrCreateWorkerForTab(e,this.getIdFromTab);r.closeAllFramesAndInvokeClipper(t,n)},t.prototype.onInstalled=function(){var e=this;t.browser.tabs.query({active:!0,lastFocusedWindow:!0},function(n){var r=c.ExtensionBase.isOnOneNoteDomain(n[0].url),o=e.getClipperInstalledPageUrl(e.clientInfo.get().clipperId,e.clientInfo.get().clipperType,r);r?t.browser.tabs.update(n[0].id,{url:o}):t.browser.tabs.create({url:o})})},t.prototype.registerBrowserButton=function(){var e=this;t.browser.browserAction.onClicked.addListener(function(t){e.invokeClipperInTab(t,{invokeSource:p.InvokeSource.ExtensionButton},{invokeMode:f.InvokeMode.Default})})},t.prototype.registerContextMenuItems=function(){var e=this;this.fetchAndStoreLocStrings().then(function(){t.browser.contextMenus.removeAll(function(){var n,r=[{title:s.Localization.getLocalizedString("WebClipper.Label.OneNoteWebClipper"),contexts:["page"],onclick:function(t,n){e.invokeClipperInTab(n,{invokeSource:p.InvokeSource.ContextMenu},{invokeMode:f.InvokeMode.Default})}},{title:s.Localization.getLocalizedString("WebClipper.Label.ClipSelectionToOneNote"),contexts:["selection"],onclick:function(n,r){var o={invokeMode:f.InvokeMode.ContextTextSelection};r.index<0?(o.invokeDataForMode=n.selectionText,t.browser.tabs.query({active:!0,currentWindow:!0},function(t){var n=t[0];e.invokeClipperInTab(n,{invokeSource:p.InvokeSource.ContextMenu},o)})):e.invokeClipperInTab(r,{invokeSource:p.InvokeSource.ContextMenu},o)}},{title:s.Localization.getLocalizedString("WebClipper.Label.ClipImageToOneNote"),contexts:["image"],onclick:function(t,n){e.invokeClipperInTab(n,{invokeSource:p.InvokeSource.ContextMenu},t.srcUrl?{invokeDataForMode:t.srcUrl,invokeMode:f.InvokeMode.ContextImage}:void 0)}}];switch(e.clientInfo.get().clipperType){case o.ClientType.ChromeExtension:n=["http://*/*","https://*/*","chrome-extension://encfpfilknmenlmjemepncnlbbjlabkc/*","chrome-extension://oemmndcbldboiebfnladdacbdfmadadm/*","chrome-extension://mhjfbmdgcfjbbpaeojofohoefgiehjai/*"];break;case o.ClientType.EdgeExtension:n=["http://*/*","https://*/*"];break;case o.ClientType.FirefoxExtension:}for(var i=0;i<r.length;i++)n&&(r[i].documentUrlPatterns=n),t.browser.contextMenus.create(r[i])})})},t.prototype.registerInstallListener=function(){var e=this;this.onInstalledSupported()&&t.browser.runtime.onInstalled.addListener(function(t){"install"===t.reason&&e.onInstalled()})},t.prototype.registerTabRemoveListener=function(){var e=this;t.browser.tabs.onRemoved.addListener(function(t){var n=e.getExistingWorkerForTab(t);n&&e.removeWorker(n)})},t.prototype.onInstalledSupported=function(){return!!t.browser.runtime.onInstalled},t}(c.ExtensionBase);n.WebExtension=d},{"../../clientType":2,"../../domParsers/videoUtils":17,"../../localization/localization":42,"../../storage/clipperData":67,"../../storage/localStorage":70,"../../urlUtils":72,"../extensionBase":23,"../invokeOptions":28,"../invokeSource":29,"./webExtensionWorker":36}],34:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../../communicator/messageHandler"),i=e("./webExtension"),a=function(e){function t(t){var n=e.call(this)||this;return n.tabId=t,n.initMessageHandler(),i.WebExtension.browser.runtime.onMessage.addListener(n.messageHandler),n}return r(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t,n){n.tab.id===e.tabId&&e.onMessageReceived(t)}},t.prototype.sendMessage=function(e){i.WebExtension.browser.tabs.sendMessage(this.tabId,e)},t.prototype.tearDown=function(){i.WebExtension.browser.runtime.onMessage.removeListener(this.messageHandler)},t}(o.MessageHandler);n.WebExtensionBackgroundMessageHandler=a;var s=function(e){function t(){var t=e.call(this)||this;return t.initMessageHandler(),i.WebExtension.browser.runtime.onMessage.addListener(t.messageHandler),t}return r(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t)}},t.prototype.sendMessage=function(e){i.WebExtension.browser.runtime.sendMessage(e)},t.prototype.tearDown=function(){i.WebExtension.browser.runtime.onMessage.removeListener(this.messageHandler)},t}(o.MessageHandler);n.WebExtensionContentMessageHandler=s},{"../../communicator/messageHandler":8,"./webExtension":33}],35:[function(e,t,n){"use strict";function r(e){o.PageNavInject.main(e)}var o=e("../pageNavInject");n.invoke=r},{"../pageNavInject":30}],36:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../../userInfo"),i=e("../../browserUtils"),a=e("../../clientType"),s=e("../../clipperUrls"),u=e("../../constants"),l=e("../../urlUtils"),c=e("../../logging/log"),p=e("../../storage/clipperData"),f=e("../../storage/LocalStorage"),g=e("../extensionWorkerBase"),d=e("../injectHelper"),h=e("./webExtension"),m=e("./webExtensionMessageHandler"),v=function(e){function t(t,n,r,o){var i=this,a=function(){return new m.WebExtensionBackgroundMessageHandler(n.id)};i=e.call(this,r,o,new p.ClipperData(new f.LocalStorage),a,a)||this,i.injectUrls=t,i.tab=n,i.tabId=n.id,i.noOpTrackerInvoked=!1;var s=!!n.incognito||!!n.inPrivate;return i.logger.setContextProperty(c.Context.Custom.InPrivateBrowsing,s.toString()),i.invokeDebugLoggingIfEnabled(),i}return r(t,e),t.prototype.getUrl=function(){return this.tab.url},t.prototype.doSignInAction=function(e){var t=this.getUserSessionIdQueryParamValue(),n=s.ClipperUrls.generateSignInUrl(this.clientInfo.get().clipperId,t,o.AuthType[e]);return this.launchWebExtensionPopupAndWaitForClose(n,u.Constants.Urls.Authentication.authRedirectUrl)},t.prototype.doSignOutAction=function(e){var t=this.getUserSessionIdQueryParamValue(),n=s.ClipperUrls.generateSignOutUrl(this.clientInfo.get().clipperId,t,o.AuthType[e]);i.BrowserUtils.appendHiddenIframeToDocument(n)},t.prototype.invokeClipperBrowserSpecific=function(){var e=this;return new Promise(function(t){h.WebExtension.browser.tabs.executeScript(e.tab.id,{code:'var frameUrl = "'+h.WebExtension.browser.extension.getURL("clipper.html")+'";'},function(){h.WebExtension.browser.runtime.lastError?(c.ErrorUtils.sendFailureLogRequest({label:c.Failure.Label.UnclippablePage,properties:{failureType:c.Failure.Type.Expected,failureInfo:{error:JSON.stringify({error:h.WebExtension.browser.runtime.lastError.message,url:e.tab.url})},stackTrace:c.Failure.getStackTrace()},clientInfo:e.clientInfo}),e.clientInfo.get().clipperType!==a.ClientType.FirefoxExtension&&d.InjectHelper.alertUserOfUnclippablePage(),t(!1)):(h.WebExtension.browser.tabs.executeScript(e.tab.id,{file:e.injectUrls.webClipperInjectUrl}),e.noOpTrackerInvoked||(e.setUpNoOpTrackers(e.tab.url),e.noOpTrackerInvoked=!0),t(!0))})})},t.prototype.invokeDebugLoggingBrowserSpecific=function(){var e=this;return new Promise(function(t){h.WebExtension.browser.tabs.executeScript(e.tab.id,{file:e.injectUrls.debugLoggingInjectUrl},function(){t(h.WebExtension.browser.runtime.lastError?!1:!0)})})},t.prototype.invokePageNavBrowserSpecific=function(){var e=this;return new Promise(function(t){h.WebExtension.browser.tabs.executeScript(e.tab.id,{code:'var frameUrl = "'+h.WebExtension.browser.extension.getURL("pageNav.html")+'";'},function(){h.WebExtension.browser.runtime.lastError?t(!1):(h.WebExtension.browser.tabs.executeScript(e.tab.id,{file:e.injectUrls.pageNavInjectUrl}),t(!0))})})},t.prototype.invokeWhatsNewTooltipBrowserSpecific=function(e){return this.invokePageNavBrowserSpecific()},t.prototype.invokeTooltipBrowserSpecific=function(){return this.invokePageNavBrowserSpecific()},t.prototype.isAllowedFileSchemeAccessBrowserSpecific=function(e){var t=this;return h.WebExtension.browser.extension.isAllowedFileSchemeAccess?void h.WebExtension.browser.extension.isAllowedFileSchemeAccess(function(n){e(n||0!==t.tab.url.indexOf("file:///")?!0:!1)}):void e(!0)},t.prototype.takeTabScreenshot=function(){return new Promise(function(e){h.WebExtension.browser.tabs.query({active:!0,lastFocusedWindow:!0},function(){h.WebExtension.browser.tabs.captureVisibleTab({format:"png"},function(t){e(t)})})})},t.prototype.launchWebExtensionPopupAndWaitForClose=function(e,t){var n=this;return new Promise(function(r,o){var i=1e3,s=700,p=screen&&screen.width?Math.round((screen.width-i)/2):0,f=screen&&screen.height?Math.round((screen.height-s)/2):0;try{var g={height:s,left:p,top:f,type:"popup",url:e,width:i};n.clientInfo.get().clipperType!==a.ClientType.FirefoxExtension&&(g.focused=!0),h.WebExtension.browser.windows.create(g,function(e){var n,i,a=!1,s=function(e){if(a=!0,e.responseHeaders)for(var t=0;t<e.responseHeaders.length;t++)if(e.responseHeaders[t].name===u.Constants.HeaderValues.correlationId){i=e.responseHeaders[t].value;break}var r=e.url,o=l.UrlUtils.getQueryValue(r,u.Constants.Urls.QueryParams.error),c=l.UrlUtils.getQueryValue(r,u.Constants.Urls.QueryParams.errorDescription);(o||c)&&(n={error:o,errorDescription:c,correlationId:i}),h.WebExtension.browser.webRequest.onCompleted.removeListener(s),h.WebExtension.browser.tabs.remove(e.tabId)};h.WebExtension.browser.webRequest.onCompleted.addListener(s,{windowId:e.id,urls:[t+"*"]},["responseHeaders"]);var c=function(t,i){i.windowId===e.id&&(n?o(n):r(a),h.WebExtension.browser.tabs.onRemoved.removeListener(c))};h.WebExtension.browser.tabs.onRemoved.addListener(c)})}catch(t){n.logger.logFailure(c.Failure.Label.WebExtensionWindowCreate,c.Failure.Type.Unexpected,{error:t.message}),n.launchPopupAndWaitForClose(e).then(function(e){r(!0)},function(e){o(e)})}})},t}(g.ExtensionWorkerBase);n.WebExtensionWorker=v},{"../../browserUtils":1,"../../clientType":2,"../../clipperUrls":4,"../../constants":10,"../../logging/log":46,"../../storage/LocalStorage":66,"../../storage/clipperData":67,"../../urlUtils":72,"../../userInfo":73,"../extensionWorkerBase":24,"../injectHelper":27,"./webExtension":33,"./webExtensionMessageHandler":34}],37:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../logging/logger"),i=function(e){function t(t){var n=e.call(this)||this;return n.workers=t,n}return r(t,e),t.prototype.logEvent=function(e){for(var t=0,n=this.workers;t<n.length;t++){var r=n[t];r.getLogger().logEvent(e)}},t.prototype.pushToStream=function(e,t){for(var n=0,r=this.workers;n<r.length;n++){var o=r[n];o.getLogger().pushToStream(e,t)}},t.prototype.logFailure=function(e,t,n,r){for(var o=0,i=this.workers;o<i.length;o++){var a=i[o];a.getLogger().logFailure(e,t,n,r)}},t.prototype.logUserFunnel=function(e){for(var t=0,n=this.workers;t<n.length;t++){var r=n[t];r.getLogger().logUserFunnel(e)}},t.prototype.logSessionStart=function(){for(var e=0,t=this.workers;e<t.length;e++){var n=t[e];n.getLogger().logSessionStart()}},t.prototype.logSessionEnd=function(e){for(var t=0,n=this.workers;t<n.length;t++){var r=n[t];r.getLogger().logSessionEnd(e)}},t.prototype.logTrace=function(e,t,n){for(var r=0,o=this.workers;r<o.length;r++){var i=o[r];i.getLogger().logTrace(e,t,n)}},t.prototype.logClickEvent=function(e){for(var t=0,n=this.workers;t<n.length;t++){var r=n[t];r.getLogger().logClickEvent(e)}},t.prototype.setContextProperty=function(e,t){for(var n=0,r=this.workers;n<r.length;n++){var o=r[n];o.getLogger().setContextProperty(e,t)}},t}(o.Logger);n.WorkerPassthroughLogger=i},{"../logging/logger":48}],38:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./http"),i=e("../objectUtils"),a=e("../promiseUtils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.get=function(t,n,r,i,s){var u=this;void 0===r&&(r=o.Http.defaultTimeout),void 0===i&&(i=[200]);var l=function(){return e.createAndSendRequest.call(u,"GET",t,n,i,r)};return a.PromiseUtils.execWithRetry(l,s)},t.post=function(t,n,r,s,u,l){var c=this;if(void 0===s&&(s=[200]),void 0===u&&(u=o.Http.defaultTimeout),i.ObjectUtils.isNullOrUndefined(n))throw new Error("data must be a non-undefined object, but was: "+n);var p=function(){return e.createAndSendRequest.call(c,"POST",t,r,s,u,n)};return a.PromiseUtils.execWithRetry(p,l)},t}(o.Http);n.HttpWithRetries=s},{"../objectUtils":61,"../promiseUtils":64,"./http":41}],39:[function(e,t,n){"use strict";var r=function(){function e(e){this.cache=e}return e.prototype.getFreshValue=function(t,n,r){if(!t)throw new Error("key must be a non-empty string, but was: "+t);if(!n)throw new Error("getRemoteValue must be non-undefined");r<0&&(r=0);var o=this.cache.getValue(t),i=!!o;if(i){var a=void 0;try{a=JSON.parse(o)}catch(e){return Promise.reject({error:e})}var s=e.valueHasExpired(a,r);if(!s)return Promise.resolve(a)}return this.getAndCacheRemoteValue(t,n)},e.prototype.getAndCacheRemoteValue=function(e,t){var n=this;if(!e)throw new Error("key must be a non-empty string, but was: "+e);if(!t)throw new Error("getRemoteValue must be non-undefined");return t().then(function(t){var r=n.setTimeStampedValue(e,t.parsedResponse);return r||n.cache.removeKey(e),Promise.resolve(r)}).catch(function(t){return n.cache.removeKey(e),Promise.reject(t)})},e.valueHasExpired=function(e,t){var n=e&&e.lastUpdated?e.lastUpdated:0;return Date.now()-n>=t},e.prototype.setTimeStampedValue=function(e,t){if(!e)throw new Error("key must be a non-empty string, but was: "+e);if(t){var n;try{n=JSON.parse(t)}catch(e){return}var r={data:n,lastUpdated:Date.now()};return this.cache.setValue(e,JSON.stringify(r)),r}},e}();n.CachedHttp=r},{}],40:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("../logging/log"),a=e("./cachedHttp"),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.logger=n,r}return r(t,e),t.prototype.setLogger=function(e){
this.logger=e},t.getDefaultExpiry=function(){return t.defaultExpiry},t.prototype.getFreshValue=function(n,r,o){if(void 0===o&&(o=t.defaultExpiry),!n)return this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue key parameter should be passed a non-empty string"},""+n),Promise.resolve(void 0);if(!r)return this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue getRemoteValue parameter should be passed a non-undefined function"},""+r),Promise.resolve(void 0);o<0&&(this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue updateInterval parameter should be passed a number >= 0"},""+o),o=0);var a=this.addLoggingToGetResponseAsync(n,r,o);return e.prototype.getFreshValue.call(this,n,a,o)},t.prototype.addLoggingToGetResponseAsync=function(e,n,r){var o=this;return function(){var a=new i.Event.PromiseEvent(i.Event.Label.FetchNonLocalData);return a.setCustomProperty(i.PropertyName.Custom.Key,e),a.setCustomProperty(i.PropertyName.Custom.UpdateInterval,r),new Promise(function(e,r){n().then(function(n){n.request&&t.addCorrelationIdToLogEvent(a,n.request),e(n)},function(e){a.setStatus(i.Status.Failed),a.setFailureInfo(e),r(e)}).then(function(){o.logger.logEvent(a)})})}},t.addCorrelationIdToLogEvent=function(e,t){var n=t.getResponseHeader(o.Constants.HeaderValues.correlationId);n&&e.setCustomProperty(i.PropertyName.Custom.CorrelationId,n)},t}(a.CachedHttp);s.defaultExpiry=432e5,n.ClipperCachedHttp=s},{"../constants":10,"../logging/log":46,"./cachedHttp":39}],41:[function(e,t,n){"use strict";var r=e("../objectUtils"),o=function(){function e(){}return e.get=function(t,n,r,o){return void 0===r&&(r=e.defaultTimeout),void 0===o&&(o=[200]),e.createAndSendRequest("GET",t,n,o,r)},e.post=function(t,n,o,i,a){if(void 0===i&&(i=[200]),void 0===a&&(a=e.defaultTimeout),r.ObjectUtils.isNullOrUndefined(n))throw new Error("data must be a non-undefined object, but was: "+n);return e.createAndSendRequest("POST",t,o,i,a,n)},e.createAndSendRequest=function(t,n,r,o,i,a){if(void 0===o&&(o=[200]),void 0===i&&(i=e.defaultTimeout),!n)throw new Error("url must be a non-empty string, but was: "+n);return new Promise(function(s,u){var l=new XMLHttpRequest;l.open(t,n),l.onload=function(){o.indexOf(l.status)>-1?s(l):u(OneNoteApi.ErrorUtils.createRequestErrorObject(l,OneNoteApi.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},l.onerror=function(){u(OneNoteApi.ErrorUtils.createRequestErrorObject(l,OneNoteApi.RequestErrorType.NETWORK_ERROR))},l.ontimeout=function(){u(OneNoteApi.ErrorUtils.createRequestErrorObject(l,OneNoteApi.RequestErrorType.REQUEST_TIMED_OUT))},e.setHeaders(l,r),l.timeout=i,l.send(a)})},e.setHeaders=function(e,t){if(t)for(var n in t)e.setRequestHeader(n,t[n])},e}();o.defaultTimeout=3e4,n.Http=o},{"../objectUtils":61}],42:[function(e,t,n){"use strict";var r;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(u){var t=u[e];if(t)return t}var n=c[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function r(e){u=e}function o(e){return"font-family: "+i(e)+";"}function i(e){if(l[e])return l[e];var t="WebClipper.FontFamily."+s[e].toString(),r=n(t);return l[e]=a(r),l[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var u,l={},c=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=r,t.getFontFamilyAsStyle=o,t.getFontFamily=i,t.formatFontFamily=a}(r=n.Localization||(n.Localization={}))},{"../../strings.json":78}],43:[function(e,t,n){"use strict";var r=e("../constants"),o=e("../urlUtils"),i=e("../http/HttpWithRetries"),a=function(){function e(){}return e.makeLocStringsFetchRequest=function(e){var t=o.UrlUtils.addUrlQueryValue(r.Constants.Urls.localizedStringsUrlBase,"locale",e);return i.HttpWithRetries.get(t).then(function(e){return Promise.resolve({request:e,parsedResponse:e.responseText})})},e}();n.LocalizationHelper=a},{"../constants":10,"../http/HttpWithRetries":38,"../urlUtils":72}],44:[function(e,t,n){"use strict";var r;!function(e){function t(e){if(!e)return!1;for(var t=n(e),o=0;o<r.length;o++)if(t===r[o])return!0;return!1}function n(e){return e?e.split("-")[0].split("_")[0].toLowerCase():""}var r=["ar","fa","he","sd","ug","ur"];e.isRtl=t,e.getIso639P1LocaleCode=n}(r=n.Rtl||(n.Rtl={}))},{}],45:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return r(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(i.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,r){this.sendDataPackage(i.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(i.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(i.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(i.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(i.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(i.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(i.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(i.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(i.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(o.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":10,"./log":46,"./logger":48}],46:[function(e,t,n){"use strict";function r(e,t){switch(e.methodName){case i.LogMethods.LogEvent:var n=e.methodArgs[0],r=e.methodArgs[1];t.logEvent.apply(t,[o.Event.createEvent(n,r)]);break;case i.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var o=e("./submodules/event"),i=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=r;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var u=e("./submodules/errorUtils");n.ErrorUtils=u.ErrorUtils;var l=e("./submodules/event");n.Event=l.Event;var c=e("./submodules/failure");n.Failure=c.Failure;var p=e("./submodules/funnel");n.Funnel=p.Funnel;var f=e("./submodules/logMethods");n.LogMethods=f.LogMethods;var g=e("./submodules/noop");n.NoOp=g.NoOp;var d=e("./submodules/propertyName");n.PropertyName=d.PropertyName;var h=e("./submodules/session");n.Session=h.Session;var m=e("./submodules/status");n.Status=m.Status;var v=e("./submodules/trace");n.Trace=v.Trace},{"./submodules/click":49,"./submodules/context":50,"./submodules/errorUtils":51,"./submodules/event":52,"./submodules/failure":53,"./submodules/funnel":54,"./submodules/logMethods":55,"./submodules/noop":56,"./submodules/propertyName":57,"./submodules/session":58,"./submodules/status":59,"./submodules/trace":60}],47:[function(e,t,n){"use strict";var r,o=e("./log");!function(e){function t(e,t){var n={};n[o.PropertyName.Reserved.EventType]=o.reportData,n[o.PropertyName.Reserved.Label]=t;var r=o.PropertyName.Reserved.WebClipper+"."+e;return n[o.PropertyName.Reserved.Category]=r,n[o.PropertyName.Reserved.EventName]=r+"."+t,n}function n(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var n=e.createBaseEventAsJson(o.Click.category,t);return n}function r(t){t.timerWasStopped()||t.stopTimer();var n=t.getEventCategory(),r=e.createBaseEventAsJson(o.Event.Category[n],t.getLabel());switch(r[o.PropertyName.Reserved.Duration]=t.getDuration(),g(r,t.getCustomProperties()),n){case o.Event.Category.BaseEvent:break;case o.Event.Category.PromiseEvent:i(r,t);break;case o.Event.Category.StreamEvent:a(r,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+o.Event.Category[n])}return r}function i(e,t){var n=t.getStatus();e[o.PropertyName.Reserved.Status]=n,n===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[o.PropertyName.Reserved.FailureType]=t.getFailureType())}function a(e,t){e[o.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function s(t,n){var r=new o.Event.BaseEvent(o.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(o.Event.Category[r.getEventCategory()],r.getLabel()),a=o.Context.toString(t);return i[o.PropertyName.Custom[o.PropertyName.Custom.Key]]=a,i[o.PropertyName.Custom[o.PropertyName.Custom.Value]]=n,i}function u(t,n,r,i){var a=e.createBaseEventAsJson(o.Failure.category,o.Failure.Label[t]);return a[o.PropertyName.Reserved.FailureType]=o.Failure.Type[n],r&&(a[o.PropertyName.Reserved.FailureInfo]=o.ErrorUtils.toString(r)),i&&(a[o.PropertyName.Reserved.Id]=i),a[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace(),a}function l(t){var n=e.createBaseEventAsJson(o.Funnel.category,o.Funnel.Label[t]);return n}function c(){var t=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Started]);return t}function p(t){var n=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Ended]);return n[o.PropertyName.Reserved.Trigger]=o.Session.EndTrigger[t],n}function f(t,n,r){var i=e.createBaseEventAsJson(o.Trace.category,o.Trace.Label[t]);switch(r&&(i[o.PropertyName.Reserved.Message]=r),i[o.PropertyName.Reserved.Level]=o.Trace.Level[n],n){case o.Trace.Level.Warning:i[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()}return i}function g(e,t){if(e[o.PropertyName.Reserved.Status]===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()),t)for(var n in t)if(t.hasOwnProperty(n)){var r=void 0;r="object"==typeof t[n]?JSON.stringify(t[n]):t[n],e[n]=r}}function d(){try{if(localStorage.getItem(o.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=n,e.createLogEventAsJson=r,e.createSetContextEventAsJson=s,e.createFailureEventAsJson=u,e.createFunnelEventAsJson=l,e.createSessionStartEventAsJson=c,e.createSessionEndEventAsJson=p,e.createTraceEventAsJson=f,e.addToLogEvent=g,e.isConsoleOutputEnabled=d}(r=n.LogHelpers||(n.LogHelpers={}))},{"./log":46}],48:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(r.Failure.Label.JsonParse,r.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=o},{"./log":46}],49:[function(e,t,n){"use strict";var r;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(r=n.Click||(n.Click={}))},{}],50:[function(e,t,n){"use strict";var r;!function(e){function t(e){return r[n[e]]}var n,r={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",InvokeHostname:"InvokeHostname",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.InvokeHostname=13]="InvokeHostname",e[e.PageLanguage=14]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(r=n.Context||(n.Context={}))},{}],51:[function(e,t,n){"use strict";var r,o=e("../../clientType"),i=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),u=e("../log");!function(e){function t(e){if(e){var t={};t[g[g.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[g[g.StatusCode].toLowerCase()]=n.statusCode,t[g[g.Response].toLowerCase()]=n.response,t[g[g.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[g[g.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function r(t){var n={};n[i.Constants.Urls.QueryParams.failureType]=u.Failure.Type[t.properties.failureType],n[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var r=t.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.Failure.Label[t.label],category:u.Failure.category,properties:n},!0)}function l(t,n,r,o){var i;throw i=o?JSON.stringify({message:o,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:u.Failure.Label.UnhandledExceptionThrown,properties:{failureType:u.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:u.Failure.getStackTrace(n)},clientInfo:r}),n}function c(e,t){void 0===t&&(t=!1);var n={};n[i.Constants.Urls.QueryParams.channel]=e.channel,n[i.Constants.Urls.QueryParams.url]=encodeURIComponent(e.url),n[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var r=e.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.NoOp.Label[e.label],category:u.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function p(e,t){return void 0===t&&(t=!1),setTimeout(function(){c(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function f(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:o.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperId)}var g;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(g||(g={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=r,e.handleCommunicatorError=l,e.sendNoOpTrackerRequest=c,e.setNoOpTrackerRequestTimeout=p}(r=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":2,"../../constants":10,"../../localization/localization":42,"../../objectUtils":61,"../log":46}],52:[function(e,t,n){"use strict";var r,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var r;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(r=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var u=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=i.Status.Succeeded,n._failureType=i.Failure.Type.Unexpected,n.isEventData(e)){var r=e;n._logStatus=r.LogStatus,n._failureType=r.FailureType,n._failureInfo=i.ErrorUtils.clone(r.FailureInfo)}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return i.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=u;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var r=e;n._stream=r.Stream}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=l,e.createEvent=t}(r=n.Event||(n.Event={}))},{"../../objectUtils":61,"../log":46}],53:[function(e,t,n){"use strict";var r;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var r;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(r=e.Label||(e.Label={}))}(r=n.Failure||(n.Failure={}))},{}],54:[function(e,t,n){"use strict";var r;!function(e){e.category="Funnel";var t;!function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.AuthSignInFailed=4]="AuthSignInFailed",e[e.ClipAttempted=5]="ClipAttempted",e[e.Interact=6]="Interact",e[e.ViewInWac=7]="ViewInWac",e[e.SignOut=8]="SignOut"}(t=e.Label||(e.Label={}))}(r=n.Funnel||(n.Funnel={}))},{}],55:[function(e,t,n){"use strict";var r;!function(e){e[e.LogEvent=0]="LogEvent",e[e.LogFailure=1]="LogFailure",e[e.PushToStream=2]="PushToStream",e[e.LogFunnel=3]="LogFunnel",e[e.LogSession=4]="LogSession",e[e.LogSessionStart=5]="LogSessionStart",e[e.LogSessionEnd=6]="LogSessionEnd",e[e.LogTrace=7]="LogTrace",e[e.LogClickEvent=8]="LogClickEvent",e[e.SetContextProperty=9]="SetContextProperty"}(r=n.LogMethods||(n.LogMethods={}))},{}],56:[function(e,t,n){"use strict";var r;!function(e){e.category="NoOp";var t;!function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(t=e.Label||(e.Label={}))}(r=n.NoOp||(n.NoOp={}))},{}],57:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.BookmarkInfo=3]="BookmarkInfo",e[e.ByteLength=4]="ByteLength",e[e.BytesPerPdfPage=5]="BytesPerPdfPage",e[e.BytesTrimmed=6]="BytesTrimmed",e[e.Channel=7]="Channel",e[e.ClipMode=8]="ClipMode",e[e.CloseReason=9]="CloseReason",e[e.ContainsAtLeastOneHighlight=10]="ContainsAtLeastOneHighlight",e[e.ContentType=11]="ContentType",e[e.CorrelationId=12]="CorrelationId",e[e.CurrentPanel=13]="CurrentPanel",e[e.CurrentSectionStillExists=14]="CurrentSectionStillExists",e[e.DeviceIdInStorage=15]="DeviceIdInStorage",e[e.DeviceIdInCookie=16]="DeviceIdInCookie",e[e.DomSizeInBytes=17]="DomSizeInBytes",e[e.FeatureEnabled=18]="FeatureEnabled",e[e.FinalDataUrlLength=19]="FinalDataUrlLength",e[e.FontSize=20]="FontSize",e[e.ForceRetrieveFreshLocStrings=21]="ForceRetrieveFreshLocStrings",e[e.FreshUserInfoAvailable=22]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=23]="FullPageScreenshotContentFound",e[e.Height=24]="Height",e[e.InitialDataUrlLength=25]="InitialDataUrlLength",e[e.InvokeMode=26]="InvokeMode",e[e.InvokeSource=27]="InvokeSource",e[e.IsHighDpiScreen=28]="IsHighDpiScreen",e[e.IsRetryable=29]="IsRetryable",e[e.IsSerif=30]="IsSerif",e[e.Key=31]="Key",e[e.LastSeenTooltipTime=32]="LastSeenTooltipTime",e[e.LastUpdated=33]="LastUpdated",e[e.MaxDepth=34]="MaxDepth",e[e.NumPages=35]="NumPages",e[e.NumRegions=36]="NumRegions",e[e.NumTimesTooltipHasBeenSeen=37]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=38]="PageNavTooltipType",e[e.PageTitleModified=39]="PageTitleModified",e[e.PdfAllPagesClipped=40]="PdfAllPagesClipped",e[e.PdfAttachmentClipped=41]="PdfAttachmentClipped",e[e.PdfFileSelectedPageCount=42]="PdfFileSelectedPageCount",e[e.PdfFileTotalPageCount=43]="PdfFileTotalPageCount",e[e.PdfIsBatched=44]="PdfIsBatched",e[e.PdfIsLocalFile=45]="PdfIsLocalFile",e[e.RatingsInfo=46]="RatingsInfo",e[e.ShouldShowRatingsPrompt=47]="ShouldShowRatingsPrompt",e[e.SignInCancelled=48]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=49]="StoredLocaleDifferentThanRequested",e[e.TimeToClearNoOpTracker=50]="TimeToClearNoOpTracker",e[e.TooltipType=51]="TooltipType",e[e.UpdateInterval=52]="UpdateInterval",e[e.UserInformationReturned=53]="UserInformationReturned",e[e.UserInformationStored=54]="UserInformationStored",e[e.UserUpdateReason=55]="UserUpdateReason",e[e.Url=56]="Url",e[e.Value=57]="Value",e[e.VideoDataOriginalSrcUrl=58]="VideoDataOriginalSrcUrl",e[e.VideoSrcUrl=59]="VideoSrcUrl",e[e.Width=60]="Width",e[e.WriteableCookies=61]="WriteableCookies"}(t=e.Custom||(e.Custom={}));var n;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(n=e.Reserved||(e.Reserved={}))}(r=n.PropertyName||(n.PropertyName={}))},{}],58:[function(e,t,n){"use strict";var r;!function(e){e.category="Session";var t;!function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(t=e.EndTrigger||(e.EndTrigger={}));var n;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(n=e.State||(e.State={}))}(r=n.Session||(n.Session={}))},{}],59:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.Status||(n.Status={}))},{}],60:[function(e,t,n){"use strict";var r;!function(e){e.category="Trace";var t;!function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl"}(t=e.Label||(e.Label={}));var n;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(n=e.Level||(e.Level={}))}(r=n.Trace||(n.Trace={}))},{}],61:[function(e,t,n){"use strict";var r;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=n}(r=n.ObjectUtils||(n.ObjectUtils={}))},{}],62:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.OperationResult||(n.OperationResult={}))},{}],63:[function(e,t,n){"use strict";var r,o=e("es6-promise");!function(e){function t(){n(),r(),i(),a()}function n(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.lastIndexOf(e,t);return r!==-1&&r===t})}function r(){"function"!=typeof Object.assign&&(Object.assign=function(e){if(!e)throw new TypeError("Cannot convert undefined to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t})}function i(){"undefined"==typeof Promise&&o.polyfill()}function a(){window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(function(){e(Date.now())},16)})}e.init=t}(r=n.Polyfills||(n.Polyfills={}))},{"es6-promise":79}],64:[function(e,t,n){"use strict";var r;!function(e){function t(e){return new Promise(function(t){setTimeout(function(){t()},e)})}function n(e,t){return void 0===t&&(t={retryCount:3,retryWaitTimeInMs:3e3}),e().catch(function(r){return t.retryCount>0?new Promise(function(r,o){setTimeout(function(){t.retryCount--,n(e,t).then(function(e){r(e)}).catch(function(e){o(e)})},t.retryWaitTimeInMs)}):Promise.reject(r)})}e.wait=t,e.execWithRetry=n}(r=n.PromiseUtils||(n.PromiseUtils={}))},{}],65:[function(e,t,n){"use strict";var r,o=e("../settings.json");!function(t){function n(e){var t=o[e];if(t&&t.Value)return t.Value}function r(t){o=t?t:e("../settings.json")}t.getSetting=n,t.setSettingsJsonForTesting=r}(r=n.Settings||(n.Settings={}))},{"../settings.json":77}],66:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.getValue=function(e){var t;return window.localStorage&&(t=window.localStorage.getItem(e),
t||this.removeKey(e)),t},e.prototype.getValues=function(e){var t={};if(window.localStorage&&e)for(var n=0;n<e.length;n++){var r=window.localStorage.getItem(e[n]);r?t[e[n]]=r:this.removeKey(e[n])}return t},e.prototype.setValue=function(e,t){window.localStorage&&(t?window.localStorage.setItem(e,t):window.localStorage.removeItem(e))},e.prototype.removeKey=function(e){return window.localStorage&&window.localStorage.removeItem(e),!0},e}();n.LocalStorage=r},{}],67:[function(e,t,n){"use strict";var r=e("../http/clipperCachedHttp"),o=e("./clipperStorageGateStrategy"),i=function(){function e(e,t){this.storage=e,this.storageGateStrategy=new o.ClipperStorageGateStrategy(e),this.cachedHttp=new r.ClipperCachedHttp(this,t)}return e.prototype.setLogger=function(e){this.cachedHttp.setLogger(e)},e.prototype.getFreshValue=function(e,t,n){return this.cachedHttp.getFreshValue(e,t,n)},e.prototype.getValue=function(e){return this.storage.getValue(e)},e.prototype.getValues=function(e){return this.storage.getValues(e)},e.prototype.setValue=function(e,t){this.storageGateStrategy.shouldSet(e,t)&&this.storage.setValue(e,t)},e.prototype.removeKey=function(e){return this.storage.removeKey(e)},e}();n.ClipperData=i},{"../http/clipperCachedHttp":40,"./clipperStorageGateStrategy":68}],68:[function(e,t,n){"use strict";var r=e("./clipperStorageKeys"),o=function(){function e(e){this.keysThatRequireUserInfo=[r.ClipperStorageKeys.cachedNotebooks,r.ClipperStorageKeys.currentSelectedSection],this.storage=e}return e.prototype.shouldSet=function(e,t){if(t&&this.keysThatRequireUserInfo.indexOf(e)>-1){var n=this.storage.getValue(r.ClipperStorageKeys.userInformation);return!!n}return!0},e}();n.ClipperStorageGateStrategy=o},{"./clipperStorageKeys":69}],69:[function(e,t,n){"use strict";var r;!function(e){e.clipperId="clipperId",e.cachedNotebooks="notebooks",e.currentSelectedSection="curSection",e.displayLanguageOverride="displayLocaleOverride",e.doNotPromptRatings="doNotPromptRatings",e.flightingInfo="flightingInfo",e.hasPatchPermissions="hasPatchPermissions",e.lastBadRatingDate="lastBadRatingDate",e.lastBadRatingVersion="lastBadRatingVersion",e.lastClippedDate="lastClippedDate",e.lastSeenVersion="lastSeenVersion",e.lastInvokedDate="lastInvokedDate",e.lastSeenTooltipTimeBase="lastSeenTooltipTime",e.lastClippedTooltipTimeBase="lastClippedTooltipTime",e.locale="locale",e.locStrings="locStrings",e.numSuccessfulClips="numSuccessfulClips",e.numSuccessfulClipsRatingsEnablement="numSuccessfulClipsRatingsEnablement",e.numTimesTooltipHasBeenSeenBase="numTimesTooltipHasBeenSeen",e.userInformation="userInformation"}(r=n.ClipperStorageKeys||(n.ClipperStorageKeys={}))},{}],70:[function(e,t,n){arguments[4][66][0].apply(n,arguments)},{dup:66}],71:[function(e,t,n){"use strict";var r,o=e("./objectUtils"),i=e("./operationResult"),a=e("./localization/localization"),s=e("lodash");!function(e){function t(e,t){if(o.ObjectUtils.isNullOrUndefined(e))return r("");if(e=e.trim(),""===e)return r("");for(var i=e.split(","),a=[],u=0;u<i.length;++u){var l=[],c=void 0,p=i[u].trim();if(""!==p){if(/^\d+$/.test(p)){var f=parseInt(p,10);if(0===f||!o.ObjectUtils.isNullOrUndefined(t)&&f>t)return r(p);l=[f]}else{if(!(c=/^(\d+)\s*-\s*(\d+)$/.exec(p)))return r(p);var g=parseInt(c[1],10),d=parseInt(c[2],10),h=4294967295;if(g>=d||0===g||0===d||g>=h||d>=h||d-g+1>h||!o.ObjectUtils.isNullOrUndefined(t)&&d>t)return r(p);l=s.range(g,d+1)}a=a.concat(l)}}var m=s(a).sortBy().sortedUniq().value();if(0===m.length)return r(e);var v=s.last(m);return!o.ObjectUtils.isNullOrUndefined(t)&&v>t?r(v.toString()):n(m)}function n(e){return{status:i.OperationResult.Succeeded,result:e}}function r(e){return{status:i.OperationResult.Failed,result:e}}function u(e){var n=t(e);if(n.status!==i.OperationResult.Succeeded)return 0;var r=n.result;return r?r.length:0}function l(e,t){var n=(t+1).toString();return e+": "+a.Localization.getLocalizedString("WebClipper.Label.Page")+" "+n}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}e.parsePageRange=t,e.countPageRange=u,e.getBatchedPageTitle=l,e.generateGuid=c}(r=n.StringUtils||(n.StringUtils={}))},{"./localization/localization":42,"./objectUtils":61,"./operationResult":62,lodash:80}],72:[function(e,t,n){"use strict";var r,o=e("./objectUtils"),i=e("./settings"),a=e("./clipperUI/tooltipType");!function(e){function t(e,t){for(var n=0;n<t.length;++n){var r=t[n],o=a.TooltipType[r],s=i.Settings.getSetting(o+"Domains"),u=new RegExp(s.join("|"),"i");if(u.test(e))return r}}function n(e,t){if(!e)return t;var n=/\/(?=[^\/]+\.\w{3,4}$).+/g.exec(e);return n&&n[0]?n[0].slice(1):t}function r(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+"/"}function s(e){var t=document.createElement("a");t.href=e;var n=t.pathname;return u(n)}function u(e){return e=o.ObjectUtils.isNullOrUndefined(e)?"/":e,e.length>0&&"/"===e.charAt(0)?e:"/"+e}function l(e,t){if(e&&t){var n=t.replace(/[\[\]]/g,"\\$&"),r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)","i"),o=r.exec(e);if(o)return o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):""}}function c(e,t,n,r){if(void 0===r&&(r=!1),!e||!t||!n)return e;r&&(t=t.charAt(0).toUpperCase()+t.slice(1));var o=e.match(/^([^#]*)(#.*)?$/),i=o[1],a=o[2]?o[2]:"",s=i.indexOf("?");if(s===-1)return i+"?"+t+"="+n+a;if(s===i.length-1)return i+t+"="+n+a;for(var u=i.substring(s+1).split("&"),l=0;l<u.length;l++){var c=u[l].split("=");if(c[0]===t)return u[l]=c[0]+"="+n,i.substring(0,s+1)+u.join("&")+a}return i+"&"+t+"="+n+a}function p(e){return g(e,["PageNav_BlacklistedDomains"])}function f(e){return g(e,["AugmentationDefault_WhitelistedDomains","ProductDomains","RecipeDomains"])}function g(e,t){if(!e)return!1;var n=[];t.forEach(function(e){n=n.concat(i.Settings.getSetting(e))});for(var r=0,o=n;r<o.length;r++){var a=o[r];if(new RegExp(a).test(e))return!0}return!1}e.checkIfUrlMatchesAContentType=t,e.getFileNameFromUrl=n,e.getHostname=r,e.getPathname=s,e.getQueryValue=l,e.addUrlQueryValue=c,e.onBlacklistedDomain=p,e.onWhitelistedDomain=f}(r=n.UrlUtils||(n.UrlUtils={}))},{"./clipperUI/tooltipType":3,"./objectUtils":61,"./settings":65}],73:[function(e,t,n){"use strict";var r;!function(e){e[e.Msa=0]="Msa",e[e.OrgId=1]="OrgId"}(r=n.AuthType||(n.AuthType={}));var o;!function(e){e[e.InitialRetrieval=0]="InitialRetrieval",e[e.SignInAttempt=1]="SignInAttempt",e[e.SignInCancel=2]="SignInCancel",e[e.SignOutAction=3]="SignOutAction",e[e.TokenRefreshForPendingClip=4]="TokenRefreshForPendingClip"}(o=n.UpdateReason||(n.UpdateReason={}))},{}],74:[function(e,t,n){"use strict";var r;!function(e){e.schemaVersionSupported="1"}(r=n.ChangeLog||(n.ChangeLog={}))},{}],75:[function(e,t,n){"use strict";var r,o=e("./version");!function(e){function t(e,t){if(!e||0===e.length)return[];if(!t)return e;for(var n=0;n<e.length;n++){var r=new o.Version(e[n].version);if(t.isGreaterThanOrEqualTo(r))return e.slice(0,n)}return e}function n(e,t,n){if(!e||0===e.length)return[];for(var r=[],i=0;i<e.length;i++){var a=new o.Version(e[i].version);if(t&&a.isLesserThanOrEqualTo(t))break;a.isLesserThanOrEqualTo(n)&&r.push(e[i])}return r}function r(e,t){if(!e||!t)return[];for(var n=[],r=0;r<e.length;r++){var o=e[r],i=o.changes.filter(function(e){return e.supportedBrowsers.indexOf(t)!==-1});i.length>0&&n.push({version:o.version,date:o.date,changes:i})}return n}e.getUpdatesSinceVersion=t,e.getUpdatesBetweenVersions=n,e.filterUpdatesThatDontApplyToBrowser=r}(r=n.ChangeLogHelper||(n.ChangeLogHelper={}))},{"./version":76}],76:[function(e,t,n){"use strict";var r=function(){function e(e){if(!e||!/^\d+\.\d+\.\d+$/.test(e))throw new Error("version must match 'int.int.int' pattern, but was: "+e);var t=e.split(".");this.major=parseInt(t[0],10),this.minor=parseInt(t[1],10),this.patch=parseInt(t[2],10),this.stringRepresentation=this.major+"."+this.minor+"."+this.patch}return e.prototype.isEqualTo=function(e,t){return this.major===e.major&&this.minor===e.minor&&(t||this.patch===e.patch)},e.prototype.isGreaterThan=function(e,t){return this.major!==e.major?this.major>e.major:this.minor!==e.minor?this.minor>e.minor:!t&&this.patch>e.patch},e.prototype.isGreaterThanOrEqualTo=function(e,t){return this.isEqualTo(e,t)||this.isGreaterThan(e,t)},e.prototype.isLesserThan=function(e,t){return this.major!==e.major?this.major<e.major:this.minor!==e.minor?this.minor<e.minor:!t&&this.patch<e.patch},e.prototype.isLesserThanOrEqualTo=function(e,t){return this.isEqualTo(e,t)||this.isLesserThan(e,t)},e.prototype.toString=function(){return this.stringRepresentation},e}();n.Version=r},{}],77:[function(e,t,n){t.exports={DummyObjectForTestingPurposes:{Description:"Do not remove under any circumstances!",Value:"Testing."},AugmentationDefault_WhitelistedDomains:{Description:"The set of domains on which we are changing the default clip mode to Augmentation.",Value:["^https?:\\/\\/www\\.onenote\\.com","[^\\w]wikipedia","[^\\w]nytimes","[^\\w]lifehacker","[^\\w]msn","[^\\w]theguardian","[^\\w]forbes","[^\\w]bbc","[^\\w]huffingtonpost","[^\\w]businessinsider","[^\\w]washingtonpost","[^\\w]medium","[^\\w]buzzfeed","[^\\w]bbc","[^\\w]theverge","[^\\w]techcrunch","[^\\w]amazon","[^\\w]allrecipes","[^\\w]foodnetwork","[^\\w]seriouseats","[^\\w]epicurious","[^\\w]support.office.com","[^\\w]blogs.office.com","[^\\w]blogs.technet.com","[^\\w]youtube\\.com\\/watch(\\?v=(\\w+)|.*\\&v=(\\w+))","[^\\w]youtube\\.com\\/embed\\/(\\w+)","[^\\w]vimeo\\.com.*?\\/(\\d+)($|\\?|\\#|\\/$)","[^\\w]vimeo\\.com.*?\\/(\\d+)\\/\\w+:\\w+(\\/|$)","[^\\w]vimeo\\.com.*?\\/ondemand\\/\\w+$","[^\\w]khanacademy\\.org(.*)/v/(.*)","\\/(\\d{2}|\\d{4})\\/\\d{1,2}\\/","\\/(\\d{2}|\\d{4})-\\d{1,2}-\\d{1,2}\\/"]},PageNav_BlacklistedDomains:{Description:"The set of domains where we do not want to show any PageNav tooltip experience",Value:["^(http(s)?)://(login\\.live\\.com)","^(http(s)?)://(login\\.microsoftonline\\.com)"]},PdfDomains:{Description:"PDF regexes",Value:["^.*(\\.pdf)$"]},RecipeDomains:{Description:"The set of domains where we want to show a Recipe tooltip",Value:["^(http(s)?)://(12tomatoes\\.com/)()([^/]*-[^/]*)/$","^(http(s)?)://(abc\\.go\\.com/shows/the-chew/recipes/)([^/]*-[^/]*)$","^(http(s)?)://(([^ ]{1,18})?)(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://((\\.{1,18}\\.)?)(allrecipes\\.)(com)/(recipe/[^/]+(/)?(/detail\\.aspx\\??)?)$","^(http(s)?)://()(allrecipes\\.com)()/([r|R]ecipe/[^/]+/Detail\\.aspx)$","^(http(s)?)://()(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(cookieandkate\\.com)()/(\\d{4})/(.+)$","^(http(s)?)://(cooking\\.)(nytimes\\.com)()/(recipes/(.*))$","^(http(s)?)://()(cookpad\\.com)()/(recipe/[0-9]+$)$","^(http(s)?)://()(damndelicious\\.net)()/\\d+/\\d+/\\d+/.+/$","^(http(s)?)://(food52\\.com)()/recipes/[0-9]+-.+$","^(http(s)?)://(minimalistbaker.com)/([^/]*-[^/]*)/$","^(http(s)?)://(paleoleap.com)/([^/]*-[^/]*)/$","^(http(s)?)://(pinchofyum.com)/([^/]*-[^/]*)$","^(http(s)?)://(recipe\\.rakuten\\.co\\.jp)()/recipe/[0-9]+/$","^(http(s)?)://()(thepioneerwoman\\.com)()/(cooking/.+/)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([r|R]ecipe/[^/]+/(Detail\\.aspx)?)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([R|r]ecipe/.*)$","^(http(s)?)://(www\\.)(bbc\\.co\\.uk/food/recipes/[^/]*_\\d+)$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)()/(recipes/[0-9]+/(.*))$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)/recipes/([^/]*-[^/]*)$","^(http(s)?)://(www\\.)(bettycrocker\\.com)()/(recipes/[^\\/]+/[0-9a-f-]{36}/?)$","^(http(s)?)://(www\\.)(bonappetit\\.com)()/(recipe/(.*))$","^(http(s)?)://(www\\.budgetbytes\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://((www\\.)?)(chowhound\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.cookingclassy\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://(www\\.delish\\.com)/cooking/recipe-ideas/recipes/a\\d+/[^/]*-[^/]*/","^(http(s)?)://(www\\.)(eatingwell\\.com)()/(recipe/\\d+/.+/)$","^(http(s)?)://(www\\.)(epicurious\\.com)()/(recipes/food/views/.*)$","^(http(s)?)://(www\\.)(food\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(foodandwine\\.com)()/(recipes\\/.+)$","^(http(s)?)://(www\\.)(foodnetwork)(\\.ca)/(recipe/(.*))$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipe-collections/.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/(([0-9]+|recipe)/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/([0-9]+/[^/]+)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*-[0-9]*/)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/[^/]+.*)$","^(http(s)?)://(www\\.)(realsimple\\.com)()/(food-recipes/browse-all-recipes/[^\\/]+/index\\.html)$","^(http(s)?)://((www)?\\.)(seriouseats\\.com)()/([Rr]ecipes\\/.*\\.(html|HTML)(.*)?)$","^(http(s)?)://(www\\.)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/([R|r]ecipes/[^/]+$)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^/]*/?)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^\\/]+/?)$","^(http(s)?)://(www\\.)(yummly\\.com)()/(recipe/[^/]+)$","^(http(s)?)://((www\\.)?)(yummly\\.com)()/(recipe/.*)$","^(http(s)?)://(.*)(yummly\\.com)()/(recipe/.+)$"]},ProductDomains:{Description:"The set of domains where we want to show a Product tooltip",Value:["^(http(s)?)://store\\.steampowered.com/app/\\d+/.*$","^(http(s)?)://(www\\.)(amazon\\.com)()/(gp/product/[^/]+/.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/(dp/[^/]+.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/([^/]+/dp/[^/]+)$","^(http(s)?)://(www\\.)(amazon\\.in)()/((.+/)?(dp|gp/product)\\/\\w{10,13}([^\\w].*)?)$","^(http(s)?)://(www\\.)(amazon\\.)([a-zA-Z\\.]+)/([^/]+/dp/.*)$","^(http(s)?)://(www\\.)(bedbathandbeyond\\.com)(/store/product/)([^/]*-[^/]*/)(\\d+.*)","^(http(s)?)://(www\\.)(ebay\\.com)()/(itm/[^/]+/.*)$","^(http(s)?)://(www\\.)(etsy\\.com)()/(listing)/(\\d+/.*)$","^(http(s)?)://(www\\.)(homedepot\\.com)()/(p/[^/]+/.*)$","^(http(s)?)://(www\\.)(newegg\\.com)()/(Product/Product\\.aspx\\?Item=.+)$","^(http(s)?)://(www\\.)(overstock\\.com)()/(.+/.+/[0-9]+/product\\.html.*)$","^(http(s)?)://(www\\.)(staples\\.com)()/(.*/product_[^/]+)$","^(http(s)?)://(www\\.)(target\\.com)()/(p/.+)$","^(http(s)?)://(www\\.)(walmart\\.com)()/(ip/.*)$"]},App_Id:{Description:"For identifying the Web Clipper during interaction with external services",Value:"OneNote Web Clipper"},Misc_Data_Endpoint_Id:{Description:"The id of the data endpoint used for miscellaneous logging",Value:"production"},Aria_Token:{Description:"For sending log events to the Aria production tenant 'OneNote Web Clipper (production)'",Value:"c7f3f24bc5f746d7b9d8f8e422fdd8a5-1cb58166-2598-485f-897c-1d3c8e62d30e-7560"},LogCategory_RatingsPrompt:{Description:"OFeedback log category for the ratings prompt feature",Value:"OneNoteClipperRatingsPrompt"},Bookmarklet_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the bookmarklet",Value:"false"},ChromeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Chrome extension",Value:"true"},EdgeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Edge extension",Value:"false"},FirefoxExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Firefox extension",Value:"true"},SafariExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Safari extension",Value:"false"},ChromeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Chrome Web Store; used to direct users to leave ratings and reviews",Value:"https://chrome.google.com/webstore/detail/onenote-web-clipper/gojbdfnpnhogfdgjbigejoaolejmgdhk/reviews"},EdgeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Windows Store; used to direct users to leave ratings and reviews",Value:"https://www.microsoft.com/en-us/store/p/onenote-web-clipper/9nblggh4r01n#ratings-reviews"},FirefoxExtension_RatingUrl:{Description:"URL for the Web Clipper in Firefox Add-ons; used to direct users to leave ratings and reviews",Value:"https://addons.mozilla.org/en-US/firefox/addon/onenote-clipper/reviews/add"}}},{}],78:[function(e,t,n){t.exports={"WebClipper.Accessibility.ScreenReader.CurrentModeHasChanged":"The current clipping mode is now '{0}'","WebClipper.Accessibility.ScreenReader.ClippingPageToOneNote":"Clipping the current page to OneNote","WebClipper.Accessibility.ScreenReader.ChangeFontToSansSerif":"Change font to Sans-Serif","WebClipper.Accessibility.ScreenReader.ChangeFontToSerif":"Change font to Serif","WebClipper.Accessibility.ScreenReader.DecreaseFontSize":"Decrease font size","WebClipper.Accessibility.ScreenReader.IncreaseFontSize":"Increase font size","WebClipper.Accessibility.ScreenReader.ToggleHighlighterForArticleMode":"Toggle Highlighter Mode For Article","WebClipper.Accessibility.ScreenReader.InputBoxToChangeTitleOfOneNotePage":"Text input to edit the title of the page you want to save","WebClipper.Action.BackToHome":"Back","WebClipper.Action.Cancel":"Cancel","WebClipper.Action.Clip":"Clip","WebClipper.Action.CloseTheClipper":"Close the Clipper","WebClipper.Action.Feedback":"Feedback?","WebClipper.Action.RefreshPage":"Refresh Page","WebClipper.Action.Signin":"Sign In","WebClipper.Action.SigninMsa":"Sign in with a Microsoft account","WebClipper.Action.SigninOrgId":"Sign in with a work or school account","WebClipper.Action.SignOut":"Sign Out","WebClipper.Action.TryAgain":"Try Again","WebClipper.Action.ViewInOneNote":"View in OneNote","WebClipper.Action.Less":"Less","WebClipper.Action.More":"More","WebClipper.BetaTag":"beta","WebClipper.ClipType.Article.Button":"Article","WebClipper.ClipType.Article.ProgressLabel":"Clipping Article","WebClipper.ClipType.Bookmark.Button":"Bookmark","WebClipper.ClipType.Bookmark.Button.Tooltip":"Clip just the title, thumbnail, synopsis, and link.","WebClipper.ClipType.Bookmark.ProgressLabel":"Clipping Bookmark","WebClipper.ClipType.Button.Tooltip":"Clip just the {0} in an easy-to-read format.","WebClipper.ClipType.Image.Button":"Image","WebClipper.ClipType.ImageSnippet.Button":"Image Snippet","WebClipper.ClipType.MultipleRegions.Button.Tooltip":"Take screenshots of parts of the page you'll select.","WebClipper.ClipType.Pdf.Button":"PDF Document","WebClipper.ClipType.Pdf.AskPermissionToClipLocalFile":"We need your permission to clip PDF files stored on your computer","WebClipper.ClipType.Pdf.InstructionsForClippingLocalFiles":"In Chrome, right-click the OneNote icon in the toolbar and choose \"Manage Extension'. Then, for OneNote Web Clipper, check 'Allow access to file URLs.'","WebClipper.ClipType.Pdf.ProgressLabel":"Clipping PDF File","WebClipper.ClipType.Pdf.ProgressLabelDelay":"PDFs can take a little while to upload. Still clipping.”","WebClipper.ClipType.Pdf.IncrementalProgressMessage":"Clipping page {0} of {1}...","WebClipper.ClipType.Pdf.Button.Tooltip":"Take a screenshot of the whole PDF file and save a copy of the attachment.","WebClipper.ClipType.Product.Button":"Product","WebClipper.ClipType.Product.ProgressLabel":"Clipping Product","WebClipper.ClipType.Recipe.Button":"Recipe","WebClipper.ClipType.Recipe.ProgressLabel":"Clipping Recipe","WebClipper.ClipType.Region.Button":"Region","WebClipper.ClipType.Region.Button.Tooltip":"Take a screenshot of the part of the page you'll select.","WebClipper.ClipType.Region.ProgressLabel":"Clipping Region","WebClipper.ClipType.ScreenShot.Button":"Full Page","WebClipper.ClipType.ScreenShot.Button.Tooltip":"Take a screenshot of the whole page, just like you see it.","WebClipper.ClipType.ScreenShot.ProgressLabel":"Clipping Page","WebClipper.ClipType.Selection.Button":"Selection","WebClipper.ClipType.Selection.Button.Tooltip":"Clip the selection you made on the web page.","WebClipper.ClipType.Selection.ProgressLabel":"Clipping Selection","WebClipper.Error.ConflictingExtension":"Your PDF viewer or another extension might be blocking the OneNote Web Clipper. You could temporarily disable the following extension and try clipping again.","WebClipper.Error.CannotClipPage":"Sorry, this type of page can't be clipped.","WebClipper.Error.CookiesDisabled.Line1":"Cookies must be enabled in order for OneNote Web Clipper to work correctly.","WebClipper.Error.CookiesDisabled.Line2":"Please allow third-party cookies in your browser or add the onenote.com and live.com domains as an exception.","WebClipper.Error.CookiesDisabled.Chrome":"Please allow third-party cookies in your browser or add the [*.]onenote.com and [*.]live.com domains as an exception.","WebClipper.Error.CookiesDisabled.Edge":"Please allow third-party cookies in your browser.","WebClipper.Error.CookiesDisabled.Firefox":"Please allow third-party cookies in your browser or add the https://onenote.com and https://live.com domains as an exception.","WebClipper.Error.CorruptedSection":"Your clip can't be saved here because the section is corrupt.","WebClipper.Error.GenericError":"Something went wrong. Please try clipping the page again.","WebClipper.Error.GenericExpiredTokenRefreshError":"Your login session has ended and we were unable to clip the page. Please sign in again.","WebClipper.Error.NoOpError":"Sorry, we can't clip this page right now","WebClipper.Error.NotProvisioned":"Your clip can't be saved because your OneDrive for Business account isn't set up.","WebClipper.Error.OrphanedWebClipperDetected":"Something went wrong. Please refresh this page, and try to clip again.","WebClipper.Error.PasswordProtected":"Your clip can't be saved here because the section is password protected.","WebClipper.Error.QuotaExceeded":"Your clip can't be saved because your OneDrive account has reached its size limit.","WebClipper.Error.ResourceDoesNotExist":"Your clip can't be saved here because the location no longer exists. Please try clipping to another location.","WebClipper.Error.SectionTooLarge":"Your clip can't be saved here because the section has reached its size limit.","WebClipper.Error.SignInUnsuccessful":"We couldn't sign you in. Please try again.","WebClipper.Error.ThirdPartyCookiesDisabled":"For OneNote Web Clipper to work correctly, please allow third-party cookies in your browser, or add the onenote.com domain as an exception.","WebClipper.Error.UserAccountSuspended":"Your clip can't be saved because your Microsoft account has been suspended.","WebClipper.Error.UserAccountSuspendedResetText":"Reset Your Account","WebClipper.Error.UserDoesNotHaveUpdatePermission":"We've added features to the Web Clipper that require new permissions. To accept them, please sign out and sign back in.","WebClipper.Extension.RefreshTab":"Please refresh this page, and try to clip again.","WebClipper.FromCitation":"Clipped from: {0}","WebClipper.Label.Annotation":"Note","WebClipper.Label.AnnotationPlaceholder":"Add a note...","WebClipper.Label.AttachPdfFile":"Attach PDF file","WebClipper.Label.AttachPdfFileSubText":"(all pages)","WebClipper.Label.ClipImageToOneNote":"Clip Image to OneNote","WebClipper.Label.ClipLocation":"Location","WebClipper.Label.ClipSelectionToOneNote":"Clip Selection to OneNote","WebClipper.Label.ClipSuccessful":"Clip Successful!","WebClipper.Label.DragAndRelease":"Drag and release to capture a screenshot","WebClipper.Label.OneNoteClipper":"OneNote Clipper","WebClipper.Label.OneNoteWebClipper":"OneNote Web Clipper","WebClipper.Label.OpenChangeLogFromTooltip":"Check out what's new","WebClipper.Label.Page":"Page","WebClipper.Label.PdfAllPagesRadioButton":"All pages","WebClipper.Label.PdfDistributePagesCheckbox":"New note for each PDF page","WebClipper.Label.PdfOptions":"PDF Options","WebClipper.Label.PdfTooLargeToAttach":"PDF too large to attach","WebClipper.Label.PdfTooltip":"Clip this PDF to OneNote, and read it later","WebClipper.Label.ProceedToWebClipper":"Proceed to the Web Clipper","WebClipper.Label.ProceedToWebClipperFun":"Try it out!","WebClipper.Label.ProductTooltip":"Clip and save product details like this to OneNote","WebClipper.Label.Ratings.Message.End":"Thanks for your feedback!","WebClipper.Label.Ratings.Message.Feedback":"Help us improve","WebClipper.Label.Ratings.Message.Init":"Enjoying the Web Clipper?","WebClipper.Label.Ratings.Message.Rate":"Glad you like it!","WebClipper.Label.Ratings.Button.Feedback":"Provide feedback","WebClipper.Label.Ratings.Button.Init.Positive":"Yes, it's great!","WebClipper.Label.Ratings.Button.Init.Negative":"Not really...","WebClipper.Label.Ratings.Button.NoThanks":"No thanks","WebClipper.Label.Ratings.Button.Rate":"Rate us 5 stars","WebClipper.Label.RecipeTooltip":"Save clutter-free recipes right to OneNote","WebClipper.Label.SignedIn":"Signed in","WebClipper.Label.SignInDescription":"Save anything on the web to OneNote in one click","WebClipper.Label.SignInUnsuccessfulMoreInformation":"More information","WebClipper.Label.SignInUnsuccessfulLessInformation":"Less information","WebClipper.Label.UnsupportedBrowser":"Sorry, your browser version is unsupported.","WebClipper.Label.WebClipper":"Web Clipper","WebClipper.Label.WebClipperWasUpdated":"OneNote Web Clipper has been updated","WebClipper.Label.WebClipperWasUpdatedFun":"OneNote Web Clipper is now better than ever!","WebClipper.Label.WhatsNew":"What's New","WebClipper.Label.VideoTooltip":"Clip this video and watch it anytime in OneNote","WebClipper.Popover.PdfInvalidPageRange":"We couldn't find page '{0}'","WebClipper.Preview.AugmentationModeGenericError":"Something went wrong creating the preview. Try again, or choose a different clipping mode.","WebClipper.Preview.BookmarkModeGenericError":"Something went wrong creating the bookmark. Try again, or choose a different clipping mode.","WebClipper.Preview.FullPageModeGenericError":"A preview isn't available, but you can still clip your page.","WebClipper.Preview.FullPageModeScreenshotDescription":"A full page screenshot of '{0}'","WebClipper.Preview.LoadingMessage":"Loading preview...","WebClipper.Preview.NoFullPageScreenshotFound":"No content found. Try another clipping mode.","WebClipper.Preview.NoContentFound":"No article found. Try another clipping mode.","WebClipper.Preview.UnableToClipLocalFile":"Local files can only be clipped using Region mode.","WebClipper.Preview.Header.AddAnotherRegionButtonLabel":"Add another region","WebClipper.Preview.Header.SansSerifButtonLabel":"Sans-serif","WebClipper.Preview.Header.SerifButtonLabel":"Serif","WebClipper.Preview.Spinner.ClipAnyTimeInFullPage":"In a hurry? You can clip any time in Full Page mode!","WebClipper.SectionPicker.DefaultLocation":"Default location","WebClipper.SectionPicker.LoadingNotebooks":"Loading notebooks...","WebClipper.SectionPicker.NoNotebooksFound":"You don't have any notebooks yet, so we'll create your default notebook when you clip this page.","WebClipper.SectionPicker.NotebookLoadFailureMessage":"OneNote couldn't load your notebooks. Please try again later.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessage":"OneNote couldn't load your notebooks.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessageWithExplanation":"We couldn't load your notebooks because a list limit was exceeded in OneDrive.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureLinkMessage":"Learn more","WebClipper.FontFamily.Regular":"Segoe UI Regular,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Bold":"Segoe UI Bold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Light":"Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Preview.SerifDefault":"Georgia","WebClipper.FontFamily.Preview.SansSerifDefault":"Verdana","WebClipper.FontFamily.Semibold":"Segoe UI Semibold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Semilight":"Segoe UI Semilight,Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontSize.Preview.SerifDefault":"16px","WebClipper.FontSize.Preview.SansSerifDefault":"16px"}},{}],79:[function(e,t,n){(function(r,o){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.ES6Promise=r()}(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function i(e){Q=e}function a(e){J=e}function s(){return function(){return r.nextTick(f)}}function u(){return"undefined"!=typeof q?function(){q(f)}:p()}function l(){var e=0,t=new X(f),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=f,function(){return e.port2.postMessage(0)}}function p(){var e=setTimeout;return function(){return e(f,1)}}function f(){for(var e=0;e<$;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}$=0}function g(){try{var t=e,n=t("vertx");return q=n.runOnLoop||n.runOnContext,u()}catch(e){return p()}}function d(e,t){var n=arguments,r=this,o=new this.constructor(m);void 0===o[oe]&&O(o);var i=r._state;return i?!function(){var e=n[i-1];J(function(){return F(i,o,e,r._result)})}():U(r,o,e,t),o}function h(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(m);return T(n,e),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(e){return ue.error=e,ue}}function C(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function w(e,t,n){J(function(e){var r=!1,o=C(n,t,function(n){r||(r=!0,t!==n?T(e,n):_(e,n))},function(t){r||(r=!0,P(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,P(e,o))},e)}function S(e,t){t._state===ae?_(e,t._result):t._state===se?P(e,t._result):U(t,void 0,function(t){return T(e,t)},function(t){return P(e,t)})}function I(e,t,r){t.constructor===e.constructor&&r===d&&t.constructor.resolve===h?S(e,t):r===ue?P(e,ue.error):void 0===r?_(e,t):n(r)?w(e,t,r):_(e,t)}function T(e,n){e===n?P(e,v()):t(n)?I(e,n,b(n)):_(e,n)}function E(e){e._onerror&&e._onerror(e._result),k(e)}function _(e,t){e._state===ie&&(e._result=t,e._state=ae,0!==e._subscribers.length&&J(k,e))}function P(e,t){e._state===ie&&(e._state=se,e._result=t,J(E,e))}function U(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ae]=n,o[i+se]=r,0===i&&e._state&&J(k,e)}function k(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?F(n,r,o,i):o(i);e._subscribers.length=0}}function x(){this.error=null}function L(e,t){try{return e(t)}catch(e){return le.error=e,le}}function F(e,t,r,o){var i=n(r),a=void 0,s=void 0,u=void 0,l=void 0;if(i){if(a=L(r,o),a===le?(l=!0,s=a.error,a=null):u=!0,t===a)return void P(t,y())}else a=o,u=!0;t._state!==ie||(i&&u?T(t,a):l?P(t,s):e===ae?_(t,a):e===se&&P(t,a))}function A(e,t){try{t(function(t){T(e,t)},function(t){P(e,t)})}catch(t){P(e,t)}}function N(){return ce++}function O(e){e[oe]=ce++,e._state=void 0,e._result=void 0,e._subscribers=[]}function R(e,t){this._instanceConstructor=e,this.promise=new e(m),this.promise[oe]||O(this.promise),G(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?_(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&_(this.promise,this._result))):P(this.promise,D())}function D(){return new Error("Array Methods must be provided an Array")}function W(e){return new R(this,e).promise}function B(e){var t=this;
return new t(G(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function V(e){var t=this,n=new t(m);return P(n,e),n}function j(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function M(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(e){this[oe]=N(),this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!=typeof e&&j(),this instanceof H?A(this,e):M())}function z(){var e=void 0;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=H}var K=void 0;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G=K,$=0,q=void 0,Q=void 0,J=function(e,t){ne[$]=e,ne[$+1]=t,$+=2,2===$&&(Q?Q(f):re())},Y="undefined"!=typeof window?window:void 0,Z=Y||{},X=Z.MutationObserver||Z.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof r&&"[object process]"==={}.toString.call(r),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?s():X?l():te?c():void 0===Y&&"function"==typeof e?g():p();var oe=Math.random().toString(36).substring(16),ie=void 0,ae=1,se=2,ue=new x,le=new x,ce=0;return R.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ie&&n<e;n++)this._eachEntry(t[n],n)},R.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=b(e);if(o===d&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===H){var i=new n(m);I(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},R.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===ie&&(this._remaining--,e===se?P(r,n):this._result[t]=n),0===this._remaining&&_(r,this._result)},R.prototype._willSettleAt=function(e,t){var n=this;U(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(se,t,e)})},H.all=W,H.race=B,H.resolve=h,H.reject=V,H._setScheduler=i,H._setAsap=a,H._asap=J,H.prototype={constructor:H,then:d,catch:function(e){return this.then(null,e)}},H.polyfill=z,H.Promise=H,H})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:81}],80:[function(e,t,n){(function(e){(function(){function r(e,t){return e.set(t[0],t[1]),e}function o(e,t){return e.add(t),e}function i(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function a(e,t,n,r){for(var o=-1,i=null==e?0:e.length;++o<i;){var a=e[o];t(r,a,n(a),e)}return r}function s(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function u(e,t){for(var n=null==e?0:e.length;n--&&t(e[n],n,e)!==!1;);return e}function l(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function c(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}function p(e,t){var n=null==e?0:e.length;return!!n&&S(e,t,0)>-1}function f(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function g(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function d(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function h(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function m(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function v(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function y(e){return e.split("")}function b(e){return e.match(jt)||[]}function C(e,t,n){var r;return n(e,function(e,n,o){if(t(e,n,o))return r=n,!1}),r}function w(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}function S(e,t,n){return t===t?Q(e,t,n):w(e,T,n)}function I(e,t,n,r){for(var o=n-1,i=e.length;++o<i;)if(r(e[o],t))return o;return-1}function T(e){return e!==e}function E(e,t){var n=null==e?0:e.length;return n?x(e,t)/n:Oe}function _(e){return function(t){return null==t?ne:t[e]}}function P(e){return function(t){return null==e?ne:e[t]}}function U(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}function k(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function x(e,t){for(var n,r=-1,o=e.length;++r<o;){var i=t(e[r]);i!==ne&&(n=n===ne?i:n+i)}return n}function L(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function F(e,t){return g(t,function(t){return[t,e[t]]})}function A(e){return function(t){return e(t)}}function N(e,t){return g(t,function(t){return e[t]})}function O(e,t){return e.has(t)}function R(e,t){for(var n=-1,r=e.length;++n<r&&S(t,e[n],0)>-1;);return n}function D(e,t){for(var n=e.length;n--&&S(t,e[n],0)>-1;);return n}function W(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function B(e){return"\\"+er[e]}function V(e,t){return null==e?ne:e[t]}function j(e){return Kn.test(e)}function M(e){return Gn.test(e)}function H(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function z(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function K(e,t){return function(n){return e(t(n))}}function G(e,t){for(var n=-1,r=e.length,o=0,i=[];++n<r;){var a=e[n];a!==t&&a!==le||(e[n]=le,i[o++]=n)}return i}function $(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function q(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function Q(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function J(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}function Y(e){return j(e)?X(e):vr(e)}function Z(e){return j(e)?ee(e):y(e)}function X(e){for(var t=Hn.lastIndex=0;Hn.test(e);)++t;return t}function ee(e){return e.match(Hn)||[]}function te(e){return e.match(zn)||[]}var ne,re="4.17.4",oe=200,ie="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ae="Expected a function",se="__lodash_hash_undefined__",ue=500,le="__lodash_placeholder__",ce=1,pe=2,fe=4,ge=1,de=2,he=1,me=2,ve=4,ye=8,be=16,Ce=32,we=64,Se=128,Ie=256,Te=512,Ee=30,_e="...",Pe=800,Ue=16,ke=1,xe=2,Le=3,Fe=1/0,Ae=9007199254740991,Ne=1.7976931348623157e308,Oe=NaN,Re=4294967295,De=Re-1,We=Re>>>1,Be=[["ary",Se],["bind",he],["bindKey",me],["curry",ye],["curryRight",be],["flip",Te],["partial",Ce],["partialRight",we],["rearg",Ie]],Ve="[object Arguments]",je="[object Array]",Me="[object AsyncFunction]",He="[object Boolean]",ze="[object Date]",Ke="[object DOMException]",Ge="[object Error]",$e="[object Function]",qe="[object GeneratorFunction]",Qe="[object Map]",Je="[object Number]",Ye="[object Null]",Ze="[object Object]",Xe="[object Promise]",et="[object Proxy]",tt="[object RegExp]",nt="[object Set]",rt="[object String]",ot="[object Symbol]",it="[object Undefined]",at="[object WeakMap]",st="[object WeakSet]",ut="[object ArrayBuffer]",lt="[object DataView]",ct="[object Float32Array]",pt="[object Float64Array]",ft="[object Int8Array]",gt="[object Int16Array]",dt="[object Int32Array]",ht="[object Uint8Array]",mt="[object Uint8ClampedArray]",vt="[object Uint16Array]",yt="[object Uint32Array]",bt=/\b__p \+= '';/g,Ct=/\b(__p \+=) '' \+/g,wt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,St=/&(?:amp|lt|gt|quot|#39);/g,It=/[&<>"']/g,Tt=RegExp(St.source),Et=RegExp(It.source),_t=/<%-([\s\S]+?)%>/g,Pt=/<%([\s\S]+?)%>/g,Ut=/<%=([\s\S]+?)%>/g,kt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xt=/^\w*$/,Lt=/^\./,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,At=/[\\^$.*+?()[\]{}|]/g,Nt=RegExp(At.source),Ot=/^\s+|\s+$/g,Rt=/^\s+/,Dt=/\s+$/,Wt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Bt=/\{\n\/\* \[wrapped with (.+)\] \*/,Vt=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Mt=/\\(\\)?/g,Ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,zt=/\w*$/,Kt=/^[-+]0x[0-9a-f]+$/i,Gt=/^0b[01]+$/i,$t=/^\[object .+?Constructor\]$/,qt=/^0o[0-7]+$/i,Qt=/^(?:0|[1-9]\d*)$/,Jt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yt=/($^)/,Zt=/['\n\r\u2028\u2029\\]/g,Xt="\\ud800-\\udfff",en="\\u0300-\\u036f",tn="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",rn=en+tn+nn,on="\\u2700-\\u27bf",an="a-z\\xdf-\\xf6\\xf8-\\xff",sn="\\xac\\xb1\\xd7\\xf7",un="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ln="\\u2000-\\u206f",cn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pn="A-Z\\xc0-\\xd6\\xd8-\\xde",fn="\\ufe0e\\ufe0f",gn=sn+un+ln+cn,dn="['’]",hn="["+Xt+"]",mn="["+gn+"]",vn="["+rn+"]",yn="\\d+",bn="["+on+"]",Cn="["+an+"]",wn="[^"+Xt+gn+yn+on+an+pn+"]",Sn="\\ud83c[\\udffb-\\udfff]",In="(?:"+vn+"|"+Sn+")",Tn="[^"+Xt+"]",En="(?:\\ud83c[\\udde6-\\uddff]){2}",_n="[\\ud800-\\udbff][\\udc00-\\udfff]",Pn="["+pn+"]",Un="\\u200d",kn="(?:"+Cn+"|"+wn+")",xn="(?:"+Pn+"|"+wn+")",Ln="(?:"+dn+"(?:d|ll|m|re|s|t|ve))?",Fn="(?:"+dn+"(?:D|LL|M|RE|S|T|VE))?",An=In+"?",Nn="["+fn+"]?",On="(?:"+Un+"(?:"+[Tn,En,_n].join("|")+")"+Nn+An+")*",Rn="\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Dn="\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",Wn=Nn+An+On,Bn="(?:"+[bn,En,_n].join("|")+")"+Wn,Vn="(?:"+[Tn+vn+"?",vn,En,_n,hn].join("|")+")",jn=RegExp(dn,"g"),Mn=RegExp(vn,"g"),Hn=RegExp(Sn+"(?="+Sn+")|"+Vn+Wn,"g"),zn=RegExp([Pn+"?"+Cn+"+"+Ln+"(?="+[mn,Pn,"$"].join("|")+")",xn+"+"+Fn+"(?="+[mn,Pn+kn,"$"].join("|")+")",Pn+"?"+kn+"+"+Ln,Pn+"+"+Fn,Dn,Rn,yn,Bn].join("|"),"g"),Kn=RegExp("["+Un+Xt+rn+fn+"]"),Gn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$n=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qn=-1,Qn={};Qn[ct]=Qn[pt]=Qn[ft]=Qn[gt]=Qn[dt]=Qn[ht]=Qn[mt]=Qn[vt]=Qn[yt]=!0,Qn[Ve]=Qn[je]=Qn[ut]=Qn[He]=Qn[lt]=Qn[ze]=Qn[Ge]=Qn[$e]=Qn[Qe]=Qn[Je]=Qn[Ze]=Qn[tt]=Qn[nt]=Qn[rt]=Qn[at]=!1;var Jn={};Jn[Ve]=Jn[je]=Jn[ut]=Jn[lt]=Jn[He]=Jn[ze]=Jn[ct]=Jn[pt]=Jn[ft]=Jn[gt]=Jn[dt]=Jn[Qe]=Jn[Je]=Jn[Ze]=Jn[tt]=Jn[nt]=Jn[rt]=Jn[ot]=Jn[ht]=Jn[mt]=Jn[vt]=Jn[yt]=!0,Jn[Ge]=Jn[$e]=Jn[at]=!1;var Yn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Zn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},er={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tr=parseFloat,nr=parseInt,rr="object"==typeof e&&e&&e.Object===Object&&e,or="object"==typeof self&&self&&self.Object===Object&&self,ir=rr||or||Function("return this")(),ar="object"==typeof n&&n&&!n.nodeType&&n,sr=ar&&"object"==typeof t&&t&&!t.nodeType&&t,ur=sr&&sr.exports===ar,lr=ur&&rr.process,cr=function(){try{return lr&&lr.binding&&lr.binding("util")}catch(e){}}(),pr=cr&&cr.isArrayBuffer,fr=cr&&cr.isDate,gr=cr&&cr.isMap,dr=cr&&cr.isRegExp,hr=cr&&cr.isSet,mr=cr&&cr.isTypedArray,vr=_("length"),yr=P(Yn),br=P(Zn),Cr=P(Xn),wr=function e(t){function n(e){if(lu(e)&&!wf(e)&&!(e instanceof Q)){if(e instanceof P)return e;if(Cc.call(e,"__wrapped__"))return aa(e)}return new P(e)}function y(){}function P(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=ne}function Q(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Re,this.__views__=[]}function X(){var e=new Q(this.__wrapped__);return e.__actions__=jo(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=jo(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=jo(this.__views__),e}function ee(){if(this.__filtered__){var e=new Q(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function jt(){var e=this.__wrapped__.value(),t=this.__dir__,n=wf(e),r=t<0,o=n?e.length:0,i=xi(0,o,this.__views__),a=i.start,s=i.end,u=s-a,l=r?s:a-1,c=this.__iteratees__,p=c.length,f=0,g=Jc(u,this.__takeCount__);if(!n||!r&&o==u&&g==u)return So(e,this.__actions__);var d=[];e:for(;u--&&f<g;){l+=t;for(var h=-1,m=e[l];++h<p;){var v=c[h],y=v.iteratee,b=v.type,C=y(m);if(b==xe)m=C;else if(!C){if(b==ke)continue e;break e}}d[f++]=m}return d}function Xt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function en(){this.__data__=ap?ap(null):{},this.size=0}function tn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function nn(e){var t=this.__data__;if(ap){var n=t[e];return n===se?ne:n}return Cc.call(t,e)?t[e]:ne}function rn(e){var t=this.__data__;return ap?t[e]!==ne:Cc.call(t,e)}function on(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ap&&t===ne?se:t,this}function an(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function sn(){this.__data__=[],this.size=0}function un(e){var t=this.__data__,n=An(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Nc.call(t,n,1),--this.size,!0}function ln(e){var t=this.__data__,n=An(t,e);return n<0?ne:t[n][1]}function cn(e){return An(this.__data__,e)>-1}function pn(e,t){var n=this.__data__,r=An(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function fn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function gn(){this.size=0,this.__data__={hash:new Xt,map:new(np||an),string:new Xt}}function dn(e){var t=_i(this,e).delete(e);return this.size-=t?1:0,t}function hn(e){return _i(this,e).get(e)}function mn(e){return _i(this,e).has(e)}function vn(e,t){var n=_i(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function yn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new fn;++t<n;)this.add(e[t])}function bn(e){return this.__data__.set(e,se),this}function Cn(e){return this.__data__.has(e)}function wn(e){var t=this.__data__=new an(e);this.size=t.size}function Sn(){this.__data__=new an,this.size=0}function In(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Tn(e){return this.__data__.get(e)}function En(e){return this.__data__.has(e)}function _n(e,t){var n=this.__data__;if(n instanceof an){var r=n.__data__;if(!np||r.length<oe-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new fn(r)}return n.set(e,t),this.size=n.size,this}function Pn(e,t){var n=wf(e),r=!n&&Cf(e),o=!n&&!r&&If(e),i=!n&&!r&&!o&&Uf(e),a=n||r||o||i,s=a?L(e.length,gc):[],u=s.length;for(var l in e)!t&&!Cc.call(e,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Wi(l,u))||s.push(l);return s}function Un(e){var t=e.length;return t?e[no(0,t-1)]:ne}function kn(e,t){return na(jo(e),Bn(t,0,e.length))}function xn(e){return na(jo(e))}function Ln(e,t,n){(n===ne||Qs(e[t],n))&&(n!==ne||t in e)||Dn(e,t,n)}function Fn(e,t,n){var r=e[t];Cc.call(e,t)&&Qs(r,n)&&(n!==ne||t in e)||Dn(e,t,n)}function An(e,t){for(var n=e.length;n--;)if(Qs(e[n][0],t))return n;return-1}function Nn(e,t,n,r){return yp(e,function(e,o,i){t(r,e,n(e),i)}),r}function On(e,t){return e&&Mo(t,zu(t),e)}function Rn(e,t){return e&&Mo(t,Ku(t),e)}function Dn(e,t,n){"__proto__"==t&&Wc?Wc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Wn(e,t){for(var n=-1,r=t.length,o=ac(r),i=null==e;++n<r;)o[n]=i?ne:ju(e,t[n]);return o}function Bn(e,t,n){return e===e&&(n!==ne&&(e=e<=n?e:n),t!==ne&&(e=e>=t?e:t)),e}function Vn(e,t,n,r,o,i){var a,u=t&ce,l=t&pe,c=t&fe;if(n&&(a=o?n(e,r,o,i):n(e)),a!==ne)return a;if(!uu(e))return e;var p=wf(e);if(p){if(a=Ai(e),!u)return jo(e,a)}else{var f=xp(e),g=f==$e||f==qe;if(If(e))return ko(e,u);if(f==Ze||f==Ve||g&&!o){if(a=l||g?{}:Ni(e),!u)return l?zo(e,Rn(a,e)):Ho(e,On(a,e))}else{if(!Jn[f])return o?e:{};a=Oi(e,f,Vn,u)}}i||(i=new wn);var d=i.get(e);if(d)return d;i.set(e,a);var h=c?l?Si:wi:l?Ku:zu,m=p?ne:h(e);return s(m||e,function(r,o){m&&(o=r,r=e[o]),Fn(a,o,Vn(r,t,n,o,e,i))}),a}function Hn(e){var t=zu(e);return function(n){return zn(n,e,t)}}function zn(e,t,n){var r=n.length;if(null==e)return!r;for(e=pc(e);r--;){var o=n[r],i=t[o],a=e[o];if(a===ne&&!(o in e)||!i(a))return!1}return!0}function Kn(e,t,n){if("function"!=typeof e)throw new dc(ae);return Ap(function(){e.apply(ne,n)},t)}function Gn(e,t,n,r){var o=-1,i=p,a=!0,s=e.length,u=[],l=t.length;if(!s)return u;n&&(t=g(t,A(n))),r?(i=f,a=!1):t.length>=oe&&(i=O,a=!1,t=new yn(t));e:for(;++o<s;){var c=e[o],d=null==n?c:n(c);if(c=r||0!==c?c:0,a&&d===d){for(var h=l;h--;)if(t[h]===d)continue e;u.push(c)}else i(t,d,r)||u.push(c)}return u}function Yn(e,t){var n=!0;return yp(e,function(e,r,o){return n=!!t(e,r,o)}),n}function Zn(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(s===ne?a===a&&!Cu(a):n(a,s)))var s=a,u=i}return u}function Xn(e,t,n,r){var o=e.length;for(n=_u(n),n<0&&(n=-n>o?0:o+n),r=r===ne||r>o?o:_u(r),r<0&&(r+=o),r=n>r?0:Pu(r);n<r;)e[n++]=t;return e}function er(e,t){var n=[];return yp(e,function(e,r,o){t(e,r,o)&&n.push(e)}),n}function rr(e,t,n,r,o){var i=-1,a=e.length;for(n||(n=Di),o||(o=[]);++i<a;){var s=e[i];t>0&&n(s)?t>1?rr(s,t-1,n,r,o):d(o,s):r||(o[o.length]=s)}return o}function or(e,t){return e&&Cp(e,t,zu)}function ar(e,t){return e&&wp(e,t,zu)}function sr(e,t){return c(t,function(t){return iu(e[t])})}function lr(e,t){t=Po(t,e);for(var n=0,r=t.length;null!=e&&n<r;)e=e[ra(t[n++])];return n&&n==r?e:ne}function cr(e,t,n){var r=t(e);return wf(e)?r:d(r,n(e))}function vr(e){return null==e?e===ne?it:Ye:Dc&&Dc in pc(e)?ki(e):Ji(e)}function wr(e,t){return e>t}function Ir(e,t){return null!=e&&Cc.call(e,t)}function Tr(e,t){return null!=e&&t in pc(e)}function Er(e,t,n){return e>=Jc(t,n)&&e<Qc(t,n)}function _r(e,t,n){for(var r=n?f:p,o=e[0].length,i=e.length,a=i,s=ac(i),u=1/0,l=[];a--;){var c=e[a];a&&t&&(c=g(c,A(t))),u=Jc(c.length,u),s[a]=!n&&(t||o>=120&&c.length>=120)?new yn(a&&c):ne}c=e[0];var d=-1,h=s[0];e:for(;++d<o&&l.length<u;){var m=c[d],v=t?t(m):m;if(m=n||0!==m?m:0,!(h?O(h,v):r(l,v,n))){for(a=i;--a;){var y=s[a];if(!(y?O(y,v):r(e[a],v,n)))continue e}h&&h.push(v),l.push(m)}}return l}function Pr(e,t,n,r){return or(e,function(e,o,i){t(r,n(e),o,i)}),r}function Ur(e,t,n){t=Po(t,e),e=Zi(e,t);var r=null==e?e:e[ra(Ea(t))];return null==r?ne:i(r,e,n)}function kr(e){return lu(e)&&vr(e)==Ve}function xr(e){return lu(e)&&vr(e)==ut}function Lr(e){return lu(e)&&vr(e)==ze}function Fr(e,t,n,r,o){return e===t||(null==e||null==t||!lu(e)&&!lu(t)?e!==e&&t!==t:Ar(e,t,n,r,Fr,o))}function Ar(e,t,n,r,o,i){var a=wf(e),s=wf(t),u=a?je:xp(e),l=s?je:xp(t);u=u==Ve?Ze:u,l=l==Ve?Ze:l;var c=u==Ze,p=l==Ze,f=u==l;if(f&&If(e)){if(!If(t))return!1;a=!0,c=!1}if(f&&!c)return i||(i=new wn),a||Uf(e)?vi(e,t,n,r,o,i):yi(e,t,u,n,r,o,i);if(!(n&ge)){var g=c&&Cc.call(e,"__wrapped__"),d=p&&Cc.call(t,"__wrapped__");if(g||d){var h=g?e.value():e,m=d?t.value():t;return i||(i=new wn),o(h,m,n,r,i)}}return!!f&&(i||(i=new wn),bi(e,t,n,r,o,i))}function Nr(e){return lu(e)&&xp(e)==Qe}function Or(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=pc(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){s=n[o];var u=s[0],l=e[u],c=s[1];if(a&&s[2]){if(l===ne&&!(u in e))return!1}else{var p=new wn;if(r)var f=r(l,c,u,e,t,p);if(!(f===ne?Fr(c,l,ge|de,r,p):f))return!1}}return!0}function Rr(e){if(!uu(e)||Hi(e))return!1;var t=iu(e)?_c:$t;return t.test(oa(e))}function Dr(e){return lu(e)&&vr(e)==tt}function Wr(e){return lu(e)&&xp(e)==nt}function Br(e){return lu(e)&&su(e.length)&&!!Qn[vr(e)]}function Vr(e){return"function"==typeof e?e:null==e?Nl:"object"==typeof e?wf(e)?Gr(e[0],e[1]):Kr(e):Ml(e)}function jr(e){if(!zi(e))return qc(e);var t=[];for(var n in pc(e))Cc.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Mr(e){if(!uu(e))return Qi(e);var t=zi(e),n=[];for(var r in e)("constructor"!=r||!t&&Cc.call(e,r))&&n.push(r);return n}function Hr(e,t){return e<t}function zr(e,t){var n=-1,r=Js(e)?ac(e.length):[];return yp(e,function(e,o,i){r[++n]=t(e,o,i)}),r}function Kr(e){var t=Pi(e);return 1==t.length&&t[0][2]?Gi(t[0][0],t[0][1]):function(n){return n===e||Or(n,e,t)}}function Gr(e,t){return Vi(e)&&Ki(t)?Gi(ra(e),t):function(n){var r=ju(n,e);return r===ne&&r===t?Hu(n,e):Fr(t,r,ge|de)}}function $r(e,t,n,r,o){e!==t&&Cp(t,function(i,a){if(uu(i))o||(o=new wn),qr(e,t,a,n,$r,r,o);else{var s=r?r(e[a],i,a+"",e,t,o):ne;s===ne&&(s=i),Ln(e,a,s)}},Ku)}function qr(e,t,n,r,o,i,a){var s=e[n],u=t[n],l=a.get(u);if(l)return void Ln(e,n,l);var c=i?i(s,u,n+"",e,t,a):ne,p=c===ne;if(p){var f=wf(u),g=!f&&If(u),d=!f&&!g&&Uf(u);c=u,f||g||d?wf(s)?c=s:Ys(s)?c=jo(s):g?(p=!1,c=ko(u,!0)):d?(p=!1,c=Ro(u,!0)):c=[]:vu(u)||Cf(u)?(c=s,Cf(s)?c=ku(s):(!uu(s)||r&&iu(s))&&(c=Ni(u))):p=!1}p&&(a.set(u,c),o(c,u,r,i,a),a.delete(u)),Ln(e,n,c)}function Qr(e,t){var n=e.length;if(n)return t+=t<0?n:0,Wi(t,n)?e[t]:ne}function Jr(e,t,n){var r=-1;t=g(t.length?t:[Nl],A(Ei()));var o=zr(e,function(e,n,o){var i=g(t,function(t){return t(e)});return{criteria:i,index:++r,value:e}});return k(o,function(e,t){return Wo(e,t,n)})}function Yr(e,t){return Zr(e,t,function(t,n){return Hu(e,n)})}function Zr(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var a=t[r],s=lr(e,a);n(s,a)&&uo(i,Po(a,e),s)}return i}function Xr(e){return function(t){return lr(t,e)}}function eo(e,t,n,r){var o=r?I:S,i=-1,a=t.length,s=e;for(e===t&&(t=jo(t)),n&&(s=g(e,A(n)));++i<a;)for(var u=0,l=t[i],c=n?n(l):l;(u=o(s,c,u,r))>-1;)s!==e&&Nc.call(s,u,1),Nc.call(e,u,1);return e}function to(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==i){var i=o;Wi(o)?Nc.call(e,o,1):bo(e,o)}}return e}function no(e,t){return e+Hc(Xc()*(t-e+1))}function ro(e,t,n,r){for(var o=-1,i=Qc(Mc((t-e)/(n||1)),0),a=ac(i);i--;)a[r?i:++o]=e,e+=n;return a}function oo(e,t){var n="";if(!e||t<1||t>Ae)return n;do t%2&&(n+=e),t=Hc(t/2),t&&(e+=e);while(t);return n}function io(e,t){return Np(Yi(e,t,Nl),e+"")}function ao(e){return Un(rl(e))}function so(e,t){var n=rl(e);return na(n,Bn(t,0,n.length))}function uo(e,t,n,r){if(!uu(e))return e;t=Po(t,e);for(var o=-1,i=t.length,a=i-1,s=e;null!=s&&++o<i;){var u=ra(t[o]),l=n;if(o!=a){var c=s[u];l=r?r(c,u,s):ne,l===ne&&(l=uu(c)?c:Wi(t[o+1])?[]:{})}Fn(s,u,l),s=s[u]}return e}function lo(e){return na(rl(e))}function co(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=ac(o);++r<o;)i[r]=e[r+t];return i}function po(e,t){var n;return yp(e,function(e,r,o){return n=t(e,r,o),!n}),!!n}function fo(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t===t&&o<=We){for(;r<o;){var i=r+o>>>1,a=e[i];null!==a&&!Cu(a)&&(n?a<=t:a<t)?r=i+1:o=i}return o}return go(e,t,Nl,n)}function go(e,t,n,r){t=n(t);for(var o=0,i=null==e?0:e.length,a=t!==t,s=null===t,u=Cu(t),l=t===ne;o<i;){var c=Hc((o+i)/2),p=n(e[c]),f=p!==ne,g=null===p,d=p===p,h=Cu(p);if(a)var m=r||d;else m=l?d&&(r||f):s?d&&f&&(r||!g):u?d&&f&&!g&&(r||!h):!g&&!h&&(r?p<=t:p<t);m?o=c+1:i=c}return Jc(i,De)}function ho(e,t){for(var n=-1,r=e.length,o=0,i=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Qs(s,u)){var u=s;i[o++]=0===a?0:a}}return i}function mo(e){return"number"==typeof e?e:Cu(e)?Oe:+e}function vo(e){if("string"==typeof e)return e;if(wf(e))return g(e,vo)+"";if(Cu(e))return mp?mp.call(e):"";var t=e+"";return"0"==t&&1/e==-Fe?"-0":t}function yo(e,t,n){var r=-1,o=p,i=e.length,a=!0,s=[],u=s;if(n)a=!1,o=f;else if(i>=oe){var l=t?null:_p(e);if(l)return $(l);a=!1,o=O,u=new yn}else u=t?[]:s;e:for(;++r<i;){var c=e[r],g=t?t(c):c;if(c=n||0!==c?c:0,a&&g===g){for(var d=u.length;d--;)if(u[d]===g)continue e;t&&u.push(g),s.push(c)}else o(u,g,n)||(u!==s&&u.push(g),s.push(c))}return s}function bo(e,t){return t=Po(t,e),e=Zi(e,t),null==e||delete e[ra(Ea(t))]}function Co(e,t,n,r){return uo(e,t,n(lr(e,t)),r)}function wo(e,t,n,r){for(var o=e.length,i=r?o:-1;(r?i--:++i<o)&&t(e[i],i,e););return n?co(e,r?0:i,r?i+1:o):co(e,r?i+1:0,r?o:i)}function So(e,t){var n=e;return n instanceof Q&&(n=n.value()),h(t,function(e,t){return t.func.apply(t.thisArg,d([e],t.args))},n)}function Io(e,t,n){var r=e.length;if(r<2)return r?yo(e[0]):[];for(var o=-1,i=ac(r);++o<r;)for(var a=e[o],s=-1;++s<r;)s!=o&&(i[o]=Gn(i[o]||a,e[s],t,n));return yo(rr(i,1),t,n)}function To(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var s=r<i?t[r]:ne;n(a,e[r],s)}return a}function Eo(e){return Ys(e)?e:[]}function _o(e){return"function"==typeof e?e:Nl}function Po(e,t){return wf(e)?e:Vi(e,t)?[e]:Op(Lu(e))}function Uo(e,t,n){var r=e.length;return n=n===ne?r:n,!t&&n>=r?e:co(e,t,n)}function ko(e,t){if(t)return e.slice();var n=e.length,r=xc?xc(n):new e.constructor(n);return e.copy(r),r}function xo(e){var t=new e.constructor(e.byteLength);return new kc(t).set(new kc(e)),t}function Lo(e,t){var n=t?xo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Fo(e,t,n){var o=t?n(z(e),ce):z(e);return h(o,r,new e.constructor)}function Ao(e){var t=new e.constructor(e.source,zt.exec(e));return t.lastIndex=e.lastIndex,t}function No(e,t,n){var r=t?n($(e),ce):$(e);return h(r,o,new e.constructor)}function Oo(e){return hp?pc(hp.call(e)):{}}function Ro(e,t){var n=t?xo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Do(e,t){if(e!==t){var n=e!==ne,r=null===e,o=e===e,i=Cu(e),a=t!==ne,s=null===t,u=t===t,l=Cu(t);if(!s&&!l&&!i&&e>t||i&&a&&u&&!s&&!l||r&&a&&u||!n&&u||!o)return 1;if(!r&&!i&&!l&&e<t||l&&n&&o&&!r&&!i||s&&n&&o||!a&&o||!u)return-1}return 0}function Wo(e,t,n){for(var r=-1,o=e.criteria,i=t.criteria,a=o.length,s=n.length;++r<a;){var u=Do(o[r],i[r]);if(u){if(r>=s)return u;var l=n[r];return u*("desc"==l?-1:1)}}return e.index-t.index}function Bo(e,t,n,r){for(var o=-1,i=e.length,a=n.length,s=-1,u=t.length,l=Qc(i-a,0),c=ac(u+l),p=!r;++s<u;)c[s]=t[s];for(;++o<a;)(p||o<i)&&(c[n[o]]=e[o]);for(;l--;)c[s++]=e[o++];return c}function Vo(e,t,n,r){for(var o=-1,i=e.length,a=-1,s=n.length,u=-1,l=t.length,c=Qc(i-s,0),p=ac(c+l),f=!r;++o<c;)p[o]=e[o];for(var g=o;++u<l;)p[g+u]=t[u];for(;++a<s;)(f||o<i)&&(p[g+n[a]]=e[o++]);return p}function jo(e,t){var n=-1,r=e.length;for(t||(t=ac(r));++n<r;)t[n]=e[n];return t}function Mo(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],u=r?r(n[s],e[s],s,n,e):ne;u===ne&&(u=e[s]),o?Dn(n,s,u):Fn(n,s,u)}return n}function Ho(e,t){return Mo(e,Up(e),t)}function zo(e,t){return Mo(e,kp(e),t)}function Ko(e,t){return function(n,r){var o=wf(n)?a:Nn,i=t?t():{};return o(n,e,Ei(r,2),i)}}function Go(e){return io(function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:ne,a=o>2?n[2]:ne;for(i=e.length>3&&"function"==typeof i?(o--,i):ne,a&&Bi(n[0],n[1],a)&&(i=o<3?ne:i,o=1),t=pc(t);++r<o;){var s=n[r];s&&e(t,s,r,i)}return t})}function $o(e,t){return function(n,r){if(null==n)return n;if(!Js(n))return e(n,r);for(var o=n.length,i=t?o:-1,a=pc(n);(t?i--:++i<o)&&r(a[i],i,a)!==!1;);return n}}function qo(e){return function(t,n,r){for(var o=-1,i=pc(t),a=r(t),s=a.length;s--;){var u=a[e?s:++o];if(n(i[u],u,i)===!1)break}return t}}function Qo(e,t,n){function r(){var t=this&&this!==ir&&this instanceof r?i:e;return t.apply(o?n:this,arguments)}var o=t&he,i=Zo(e);return r}function Jo(e){return function(t){t=Lu(t);var n=j(t)?Z(t):ne,r=n?n[0]:t.charAt(0),o=n?Uo(n,1).join(""):t.slice(1);return r[e]()+o}}function Yo(e){return function(t){return h(kl(ll(t).replace(jn,"")),e,"")}}function Zo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=vp(e.prototype),r=e.apply(n,t);return uu(r)?r:n}}function Xo(e,t,n){function r(){for(var a=arguments.length,s=ac(a),u=a,l=Ti(r);u--;)s[u]=arguments[u];var c=a<3&&s[0]!==l&&s[a-1]!==l?[]:G(s,l);if(a-=c.length,a<n)return ci(e,t,ni,r.placeholder,ne,s,c,ne,ne,n-a);var p=this&&this!==ir&&this instanceof r?o:e;return i(p,this,s)}var o=Zo(e);return r}function ei(e){return function(t,n,r){var o=pc(t);if(!Js(t)){var i=Ei(n,3);t=zu(t),n=function(e){return i(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[i?t[a]:a]:ne}}function ti(e){return Ci(function(t){var n=t.length,r=n,o=P.prototype.thru;for(e&&t.reverse();r--;){var i=t[r];if("function"!=typeof i)throw new dc(ae);if(o&&!a&&"wrapper"==Ii(i))var a=new P([],!0)}for(r=a?r:n;++r<n;){i=t[r];var s=Ii(i),u="wrapper"==s?Pp(i):ne;a=u&&Mi(u[0])&&u[1]==(Se|ye|Ce|Ie)&&!u[4].length&&1==u[9]?a[Ii(u[0])].apply(a,u[3]):1==i.length&&Mi(i)?a[s]():a.thru(i)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&wf(r))return a.plant(r).value();for(var o=0,i=n?t[o].apply(this,e):r;++o<n;)i=t[o].call(this,i);return i}})}function ni(e,t,n,r,o,i,a,s,u,l){function c(){for(var v=arguments.length,y=ac(v),b=v;b--;)y[b]=arguments[b];if(d)var C=Ti(c),w=W(y,C);if(r&&(y=Bo(y,r,o,d)),i&&(y=Vo(y,i,a,d)),v-=w,d&&v<l){var S=G(y,C);return ci(e,t,ni,c.placeholder,n,y,S,s,u,l-v)}var I=f?n:this,T=g?I[e]:e;return v=y.length,s?y=Xi(y,s):h&&v>1&&y.reverse(),p&&u<v&&(y.length=u),this&&this!==ir&&this instanceof c&&(T=m||Zo(T)),T.apply(I,y)}var p=t&Se,f=t&he,g=t&me,d=t&(ye|be),h=t&Te,m=g?ne:Zo(e);return c}function ri(e,t){return function(n,r){return Pr(n,e,t(r),{})}}function oi(e,t){return function(n,r){var o;if(n===ne&&r===ne)return t;if(n!==ne&&(o=n),r!==ne){if(o===ne)return r;"string"==typeof n||"string"==typeof r?(n=vo(n),r=vo(r)):(n=mo(n),r=mo(r)),o=e(n,r)}return o}}function ii(e){return Ci(function(t){return t=g(t,A(Ei())),io(function(n){var r=this;return e(t,function(e){return i(e,r,n)})})})}function ai(e,t){t=t===ne?" ":vo(t);var n=t.length;if(n<2)return n?oo(t,e):t;var r=oo(t,Mc(e/Y(t)));return j(t)?Uo(Z(r),0,e).join(""):r.slice(0,e)}function si(e,t,n,r){function o(){for(var t=-1,u=arguments.length,l=-1,c=r.length,p=ac(c+u),f=this&&this!==ir&&this instanceof o?s:e;++l<c;)p[l]=r[l];for(;u--;)p[l++]=arguments[++t];return i(f,a?n:this,p)}var a=t&he,s=Zo(e);return o}function ui(e){return function(t,n,r){
return r&&"number"!=typeof r&&Bi(t,n,r)&&(n=r=ne),t=Eu(t),n===ne?(n=t,t=0):n=Eu(n),r=r===ne?t<n?1:-1:Eu(r),ro(t,n,r,e)}}function li(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Uu(t),n=Uu(n)),e(t,n)}}function ci(e,t,n,r,o,i,a,s,u,l){var c=t&ye,p=c?a:ne,f=c?ne:a,g=c?i:ne,d=c?ne:i;t|=c?Ce:we,t&=~(c?we:Ce),t&ve||(t&=~(he|me));var h=[e,t,o,g,p,d,f,s,u,l],m=n.apply(ne,h);return Mi(e)&&Fp(m,h),m.placeholder=r,ea(m,e,t)}function pi(e){var t=cc[e];return function(e,n){if(e=Uu(e),n=null==n?0:Jc(_u(n),292)){var r=(Lu(e)+"e").split("e"),o=t(r[0]+"e"+(+r[1]+n));return r=(Lu(o)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return t(e)}}function fi(e){return function(t){var n=xp(t);return n==Qe?z(t):n==nt?q(t):F(t,e(t))}}function gi(e,t,n,r,o,i,a,s){var u=t&me;if(!u&&"function"!=typeof e)throw new dc(ae);var l=r?r.length:0;if(l||(t&=~(Ce|we),r=o=ne),a=a===ne?a:Qc(_u(a),0),s=s===ne?s:_u(s),l-=o?o.length:0,t&we){var c=r,p=o;r=o=ne}var f=u?ne:Pp(e),g=[e,t,n,r,o,c,p,i,a,s];if(f&&qi(g,f),e=g[0],t=g[1],n=g[2],r=g[3],o=g[4],s=g[9]=g[9]===ne?u?0:e.length:Qc(g[9]-l,0),!s&&t&(ye|be)&&(t&=~(ye|be)),t&&t!=he)d=t==ye||t==be?Xo(e,t,s):t!=Ce&&t!=(he|Ce)||o.length?ni.apply(ne,g):si(e,t,n,r);else var d=Qo(e,t,n);var h=f?Sp:Fp;return ea(h(d,g),e,t)}function di(e,t,n,r){return e===ne||Qs(e,vc[n])&&!Cc.call(r,n)?t:e}function hi(e,t,n,r,o,i){return uu(e)&&uu(t)&&(i.set(t,e),$r(e,t,ne,hi,i),i.delete(t)),e}function mi(e){return vu(e)?ne:e}function vi(e,t,n,r,o,i){var a=n&ge,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var l=i.get(e);if(l&&i.get(t))return l==t;var c=-1,p=!0,f=n&de?new yn:ne;for(i.set(e,t),i.set(t,e);++c<s;){var g=e[c],d=t[c];if(r)var h=a?r(d,g,c,t,e,i):r(g,d,c,e,t,i);if(h!==ne){if(h)continue;p=!1;break}if(f){if(!v(t,function(e,t){if(!O(f,t)&&(g===e||o(g,e,n,r,i)))return f.push(t)})){p=!1;break}}else if(g!==d&&!o(g,d,n,r,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function yi(e,t,n,r,o,i,a){switch(n){case lt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ut:return!(e.byteLength!=t.byteLength||!i(new kc(e),new kc(t)));case He:case ze:case Je:return Qs(+e,+t);case Ge:return e.name==t.name&&e.message==t.message;case tt:case rt:return e==t+"";case Qe:var s=z;case nt:var u=r&ge;if(s||(s=$),e.size!=t.size&&!u)return!1;var l=a.get(e);if(l)return l==t;r|=de,a.set(e,t);var c=vi(s(e),s(t),r,o,i,a);return a.delete(e),c;case ot:if(hp)return hp.call(e)==hp.call(t)}return!1}function bi(e,t,n,r,o,i){var a=n&ge,s=wi(e),u=s.length,l=wi(t),c=l.length;if(u!=c&&!a)return!1;for(var p=u;p--;){var f=s[p];if(!(a?f in t:Cc.call(t,f)))return!1}var g=i.get(e);if(g&&i.get(t))return g==t;var d=!0;i.set(e,t),i.set(t,e);for(var h=a;++p<u;){f=s[p];var m=e[f],v=t[f];if(r)var y=a?r(v,m,f,t,e,i):r(m,v,f,e,t,i);if(!(y===ne?m===v||o(m,v,n,r,i):y)){d=!1;break}h||(h="constructor"==f)}if(d&&!h){var b=e.constructor,C=t.constructor;b!=C&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof C&&C instanceof C)&&(d=!1)}return i.delete(e),i.delete(t),d}function Ci(e){return Np(Yi(e,ne,va),e+"")}function wi(e){return cr(e,zu,Up)}function Si(e){return cr(e,Ku,kp)}function Ii(e){for(var t=e.name+"",n=up[t],r=Cc.call(up,t)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==e)return o.name}return t}function Ti(e){var t=Cc.call(n,"placeholder")?n:e;return t.placeholder}function Ei(){var e=n.iteratee||Ol;return e=e===Ol?Vr:e,arguments.length?e(arguments[0],arguments[1]):e}function _i(e,t){var n=e.__data__;return ji(t)?n["string"==typeof t?"string":"hash"]:n.map}function Pi(e){for(var t=zu(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,Ki(o)]}return t}function Ui(e,t){var n=V(e,t);return Rr(n)?n:ne}function ki(e){var t=Cc.call(e,Dc),n=e[Dc];try{e[Dc]=ne;var r=!0}catch(e){}var o=Ic.call(e);return r&&(t?e[Dc]=n:delete e[Dc]),o}function xi(e,t,n){for(var r=-1,o=n.length;++r<o;){var i=n[r],a=i.size;switch(i.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Jc(t,e+a);break;case"takeRight":e=Qc(e,t-a)}}return{start:e,end:t}}function Li(e){var t=e.match(Bt);return t?t[1].split(Vt):[]}function Fi(e,t,n){t=Po(t,e);for(var r=-1,o=t.length,i=!1;++r<o;){var a=ra(t[r]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++r!=o?i:(o=null==e?0:e.length,!!o&&su(o)&&Wi(a,o)&&(wf(e)||Cf(e)))}function Ai(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&Cc.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Ni(e){return"function"!=typeof e.constructor||zi(e)?{}:vp(Lc(e))}function Oi(e,t,n,r){var o=e.constructor;switch(t){case ut:return xo(e);case He:case ze:return new o(+e);case lt:return Lo(e,r);case ct:case pt:case ft:case gt:case dt:case ht:case mt:case vt:case yt:return Ro(e,r);case Qe:return Fo(e,r,n);case Je:case rt:return new o(e);case tt:return Ao(e);case nt:return No(e,r,n);case ot:return Oo(e)}}function Ri(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Wt,"{\n/* [wrapped with "+t+"] */\n")}function Di(e){return wf(e)||Cf(e)||!!(Oc&&e&&e[Oc])}function Wi(e,t){return t=null==t?Ae:t,!!t&&("number"==typeof e||Qt.test(e))&&e>-1&&e%1==0&&e<t}function Bi(e,t,n){if(!uu(n))return!1;var r=typeof t;return!!("number"==r?Js(n)&&Wi(t,n.length):"string"==r&&t in n)&&Qs(n[t],e)}function Vi(e,t){if(wf(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Cu(e))||(xt.test(e)||!kt.test(e)||null!=t&&e in pc(t))}function ji(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function Mi(e){var t=Ii(e),r=n[t];if("function"!=typeof r||!(t in Q.prototype))return!1;if(e===r)return!0;var o=Pp(r);return!!o&&e===o[0]}function Hi(e){return!!Sc&&Sc in e}function zi(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||vc;return e===n}function Ki(e){return e===e&&!uu(e)}function Gi(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==ne||e in pc(n)))}}function $i(e){var t=Os(e,function(e){return n.size===ue&&n.clear(),e}),n=t.cache;return t}function qi(e,t){var n=e[1],r=t[1],o=n|r,i=o<(he|me|Se),a=r==Se&&n==ye||r==Se&&n==Ie&&e[7].length<=t[8]||r==(Se|Ie)&&t[7].length<=t[8]&&n==ye;if(!i&&!a)return e;r&he&&(e[2]=t[2],o|=n&he?0:ve);var s=t[3];if(s){var u=e[3];e[3]=u?Bo(u,s,t[4]):s,e[4]=u?G(e[3],le):t[4]}return s=t[5],s&&(u=e[5],e[5]=u?Vo(u,s,t[6]):s,e[6]=u?G(e[5],le):t[6]),s=t[7],s&&(e[7]=s),r&Se&&(e[8]=null==e[8]?t[8]:Jc(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e}function Qi(e){var t=[];if(null!=e)for(var n in pc(e))t.push(n);return t}function Ji(e){return Ic.call(e)}function Yi(e,t,n){return t=Qc(t===ne?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=Qc(r.length-t,0),s=ac(a);++o<a;)s[o]=r[t+o];o=-1;for(var u=ac(t+1);++o<t;)u[o]=r[o];return u[t]=n(s),i(e,this,u)}}function Zi(e,t){return t.length<2?e:lr(e,co(t,0,-1))}function Xi(e,t){for(var n=e.length,r=Jc(t.length,n),o=jo(e);r--;){var i=t[r];e[r]=Wi(i,n)?o[i]:ne}return e}function ea(e,t,n){var r=t+"";return Np(e,Ri(r,ia(Li(r),n)))}function ta(e){var t=0,n=0;return function(){var r=Yc(),o=Ue-(r-n);if(n=r,o>0){if(++t>=Pe)return arguments[0]}else t=0;return e.apply(ne,arguments)}}function na(e,t){var n=-1,r=e.length,o=r-1;for(t=t===ne?r:t;++n<t;){var i=no(n,o),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}function ra(e){if("string"==typeof e||Cu(e))return e;var t=e+"";return"0"==t&&1/e==-Fe?"-0":t}function oa(e){if(null!=e){try{return bc.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ia(e,t){return s(Be,function(n){var r="_."+n[0];t&n[1]&&!p(e,r)&&e.push(r)}),e.sort()}function aa(e){if(e instanceof Q)return e.clone();var t=new P(e.__wrapped__,e.__chain__);return t.__actions__=jo(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function sa(e,t,n){t=(n?Bi(e,t,n):t===ne)?1:Qc(_u(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var o=0,i=0,a=ac(Mc(r/t));o<r;)a[i++]=co(e,o,o+=t);return a}function ua(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var i=e[t];i&&(o[r++]=i)}return o}function la(){var e=arguments.length;if(!e)return[];for(var t=ac(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return d(wf(n)?jo(n):[n],rr(t,1))}function ca(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===ne?1:_u(t),co(e,t<0?0:t,r)):[]}function pa(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===ne?1:_u(t),t=r-t,co(e,0,t<0?0:t)):[]}function fa(e,t){return e&&e.length?wo(e,Ei(t,3),!0,!0):[]}function ga(e,t){return e&&e.length?wo(e,Ei(t,3),!0):[]}function da(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&Bi(e,t,n)&&(n=0,r=o),Xn(e,t,n,r)):[]}function ha(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:_u(n);return o<0&&(o=Qc(r+o,0)),w(e,Ei(t,3),o)}function ma(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==ne&&(o=_u(n),o=n<0?Qc(r+o,0):Jc(o,r-1)),w(e,Ei(t,3),o,!0)}function va(e){var t=null==e?0:e.length;return t?rr(e,1):[]}function ya(e){var t=null==e?0:e.length;return t?rr(e,Fe):[]}function ba(e,t){var n=null==e?0:e.length;return n?(t=t===ne?1:_u(t),rr(e,t)):[]}function Ca(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r}function wa(e){return e&&e.length?e[0]:ne}function Sa(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:_u(n);return o<0&&(o=Qc(r+o,0)),S(e,t,o)}function Ia(e){var t=null==e?0:e.length;return t?co(e,0,-1):[]}function Ta(e,t){return null==e?"":$c.call(e,t)}function Ea(e){var t=null==e?0:e.length;return t?e[t-1]:ne}function _a(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==ne&&(o=_u(n),o=o<0?Qc(r+o,0):Jc(o,r-1)),t===t?J(e,t,o):w(e,T,o,!0)}function Pa(e,t){return e&&e.length?Qr(e,_u(t)):ne}function Ua(e,t){return e&&e.length&&t&&t.length?eo(e,t):e}function ka(e,t,n){return e&&e.length&&t&&t.length?eo(e,t,Ei(n,2)):e}function xa(e,t,n){return e&&e.length&&t&&t.length?eo(e,t,ne,n):e}function La(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],i=e.length;for(t=Ei(t,3);++r<i;){var a=e[r];t(a,r,e)&&(n.push(a),o.push(r))}return to(e,o),n}function Fa(e){return null==e?e:ep.call(e)}function Aa(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Bi(e,t,n)?(t=0,n=r):(t=null==t?0:_u(t),n=n===ne?r:_u(n)),co(e,t,n)):[]}function Na(e,t){return fo(e,t)}function Oa(e,t,n){return go(e,t,Ei(n,2))}function Ra(e,t){var n=null==e?0:e.length;if(n){var r=fo(e,t);if(r<n&&Qs(e[r],t))return r}return-1}function Da(e,t){return fo(e,t,!0)}function Wa(e,t,n){return go(e,t,Ei(n,2),!0)}function Ba(e,t){var n=null==e?0:e.length;if(n){var r=fo(e,t,!0)-1;if(Qs(e[r],t))return r}return-1}function Va(e){return e&&e.length?ho(e):[]}function ja(e,t){return e&&e.length?ho(e,Ei(t,2)):[]}function Ma(e){var t=null==e?0:e.length;return t?co(e,1,t):[]}function Ha(e,t,n){return e&&e.length?(t=n||t===ne?1:_u(t),co(e,0,t<0?0:t)):[]}function za(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===ne?1:_u(t),t=r-t,co(e,t<0?0:t,r)):[]}function Ka(e,t){return e&&e.length?wo(e,Ei(t,3),!1,!0):[]}function Ga(e,t){return e&&e.length?wo(e,Ei(t,3)):[]}function $a(e){return e&&e.length?yo(e):[]}function qa(e,t){return e&&e.length?yo(e,Ei(t,2)):[]}function Qa(e,t){return t="function"==typeof t?t:ne,e&&e.length?yo(e,ne,t):[]}function Ja(e){if(!e||!e.length)return[];var t=0;return e=c(e,function(e){if(Ys(e))return t=Qc(e.length,t),!0}),L(t,function(t){return g(e,_(t))})}function Ya(e,t){if(!e||!e.length)return[];var n=Ja(e);return null==t?n:g(n,function(e){return i(t,ne,e)})}function Za(e,t){return To(e||[],t||[],Fn)}function Xa(e,t){return To(e||[],t||[],uo)}function es(e){var t=n(e);return t.__chain__=!0,t}function ts(e,t){return t(e),e}function ns(e,t){return t(e)}function rs(){return es(this)}function os(){return new P(this.value(),this.__chain__)}function is(){this.__values__===ne&&(this.__values__=Tu(this.value()));var e=this.__index__>=this.__values__.length,t=e?ne:this.__values__[this.__index__++];return{done:e,value:t}}function as(){return this}function ss(e){for(var t,n=this;n instanceof y;){var r=aa(n);r.__index__=0,r.__values__=ne,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t}function us(){var e=this.__wrapped__;if(e instanceof Q){var t=e;return this.__actions__.length&&(t=new Q(this)),t=t.reverse(),t.__actions__.push({func:ns,args:[Fa],thisArg:ne}),new P(t,this.__chain__)}return this.thru(Fa)}function ls(){return So(this.__wrapped__,this.__actions__)}function cs(e,t,n){var r=wf(e)?l:Yn;return n&&Bi(e,t,n)&&(t=ne),r(e,Ei(t,3))}function ps(e,t){var n=wf(e)?c:er;return n(e,Ei(t,3))}function fs(e,t){return rr(ys(e,t),1)}function gs(e,t){return rr(ys(e,t),Fe)}function ds(e,t,n){return n=n===ne?1:_u(n),rr(ys(e,t),n)}function hs(e,t){var n=wf(e)?s:yp;return n(e,Ei(t,3))}function ms(e,t){var n=wf(e)?u:bp;return n(e,Ei(t,3))}function vs(e,t,n,r){e=Js(e)?e:rl(e),n=n&&!r?_u(n):0;var o=e.length;return n<0&&(n=Qc(o+n,0)),bu(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&S(e,t,n)>-1}function ys(e,t){var n=wf(e)?g:zr;return n(e,Ei(t,3))}function bs(e,t,n,r){return null==e?[]:(wf(t)||(t=null==t?[]:[t]),n=r?ne:n,wf(n)||(n=null==n?[]:[n]),Jr(e,t,n))}function Cs(e,t,n){var r=wf(e)?h:U,o=arguments.length<3;return r(e,Ei(t,4),n,o,yp)}function ws(e,t,n){var r=wf(e)?m:U,o=arguments.length<3;return r(e,Ei(t,4),n,o,bp)}function Ss(e,t){var n=wf(e)?c:er;return n(e,Rs(Ei(t,3)))}function Is(e){var t=wf(e)?Un:ao;return t(e)}function Ts(e,t,n){t=(n?Bi(e,t,n):t===ne)?1:_u(t);var r=wf(e)?kn:so;return r(e,t)}function Es(e){var t=wf(e)?xn:lo;return t(e)}function _s(e){if(null==e)return 0;if(Js(e))return bu(e)?Y(e):e.length;var t=xp(e);return t==Qe||t==nt?e.size:jr(e).length}function Ps(e,t,n){var r=wf(e)?v:po;return n&&Bi(e,t,n)&&(t=ne),r(e,Ei(t,3))}function Us(e,t){if("function"!=typeof t)throw new dc(ae);return e=_u(e),function(){if(--e<1)return t.apply(this,arguments)}}function ks(e,t,n){return t=n?ne:t,t=e&&null==t?e.length:t,gi(e,Se,ne,ne,ne,ne,t)}function xs(e,t){var n;if("function"!=typeof t)throw new dc(ae);return e=_u(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=ne),n}}function Ls(e,t,n){t=n?ne:t;var r=gi(e,ye,ne,ne,ne,ne,ne,t);return r.placeholder=Ls.placeholder,r}function Fs(e,t,n){t=n?ne:t;var r=gi(e,be,ne,ne,ne,ne,ne,t);return r.placeholder=Fs.placeholder,r}function As(e,t,n){function r(t){var n=f,r=g;return f=g=ne,y=t,h=e.apply(r,n)}function o(e){return y=e,m=Ap(s,t),b?r(e):h}function i(e){var n=e-v,r=e-y,o=t-n;return C?Jc(o,d-r):o}function a(e){var n=e-v,r=e-y;return v===ne||n>=t||n<0||C&&r>=d}function s(){var e=lf();return a(e)?u(e):void(m=Ap(s,i(e)))}function u(e){return m=ne,w&&f?r(e):(f=g=ne,h)}function l(){m!==ne&&Ep(m),y=0,f=v=g=m=ne}function c(){return m===ne?h:u(lf())}function p(){var e=lf(),n=a(e);if(f=arguments,g=this,v=e,n){if(m===ne)return o(v);if(C)return m=Ap(s,t),r(v)}return m===ne&&(m=Ap(s,t)),h}var f,g,d,h,m,v,y=0,b=!1,C=!1,w=!0;if("function"!=typeof e)throw new dc(ae);return t=Uu(t)||0,uu(n)&&(b=!!n.leading,C="maxWait"in n,d=C?Qc(Uu(n.maxWait)||0,t):d,w="trailing"in n?!!n.trailing:w),p.cancel=l,p.flush=c,p}function Ns(e){return gi(e,Te)}function Os(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new dc(ae);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(Os.Cache||fn),n}function Rs(e){if("function"!=typeof e)throw new dc(ae);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Ds(e){return xs(2,e)}function Ws(e,t){if("function"!=typeof e)throw new dc(ae);return t=t===ne?t:_u(t),io(e,t)}function Bs(e,t){if("function"!=typeof e)throw new dc(ae);return t=null==t?0:Qc(_u(t),0),io(function(n){var r=n[t],o=Uo(n,0,t);return r&&d(o,r),i(e,this,o)})}function Vs(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new dc(ae);return uu(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),As(e,t,{leading:r,maxWait:t,trailing:o})}function js(e){return ks(e,1)}function Ms(e,t){return hf(_o(t),e)}function Hs(){if(!arguments.length)return[];var e=arguments[0];return wf(e)?e:[e]}function zs(e){return Vn(e,fe)}function Ks(e,t){return t="function"==typeof t?t:ne,Vn(e,fe,t)}function Gs(e){return Vn(e,ce|fe)}function $s(e,t){return t="function"==typeof t?t:ne,Vn(e,ce|fe,t)}function qs(e,t){return null==t||zn(e,t,zu(t))}function Qs(e,t){return e===t||e!==e&&t!==t}function Js(e){return null!=e&&su(e.length)&&!iu(e)}function Ys(e){return lu(e)&&Js(e)}function Zs(e){return e===!0||e===!1||lu(e)&&vr(e)==He}function Xs(e){return lu(e)&&1===e.nodeType&&!vu(e)}function eu(e){if(null==e)return!0;if(Js(e)&&(wf(e)||"string"==typeof e||"function"==typeof e.splice||If(e)||Uf(e)||Cf(e)))return!e.length;var t=xp(e);if(t==Qe||t==nt)return!e.size;if(zi(e))return!jr(e).length;for(var n in e)if(Cc.call(e,n))return!1;return!0}function tu(e,t){return Fr(e,t)}function nu(e,t,n){n="function"==typeof n?n:ne;var r=n?n(e,t):ne;return r===ne?Fr(e,t,ne,n):!!r}function ru(e){if(!lu(e))return!1;var t=vr(e);return t==Ge||t==Ke||"string"==typeof e.message&&"string"==typeof e.name&&!vu(e)}function ou(e){return"number"==typeof e&&Gc(e)}function iu(e){if(!uu(e))return!1;var t=vr(e);return t==$e||t==qe||t==Me||t==et}function au(e){return"number"==typeof e&&e==_u(e)}function su(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ae}function uu(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function lu(e){return null!=e&&"object"==typeof e}function cu(e,t){return e===t||Or(e,t,Pi(t))}function pu(e,t,n){return n="function"==typeof n?n:ne,Or(e,t,Pi(t),n)}function fu(e){return mu(e)&&e!=+e}function gu(e){if(Lp(e))throw new uc(ie);return Rr(e)}function du(e){return null===e}function hu(e){return null==e}function mu(e){return"number"==typeof e||lu(e)&&vr(e)==Je}function vu(e){if(!lu(e)||vr(e)!=Ze)return!1;var t=Lc(e);if(null===t)return!0;var n=Cc.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&bc.call(n)==Tc}function yu(e){return au(e)&&e>=-Ae&&e<=Ae}function bu(e){return"string"==typeof e||!wf(e)&&lu(e)&&vr(e)==rt}function Cu(e){return"symbol"==typeof e||lu(e)&&vr(e)==ot}function wu(e){return e===ne}function Su(e){return lu(e)&&xp(e)==at}function Iu(e){return lu(e)&&vr(e)==st}function Tu(e){if(!e)return[];if(Js(e))return bu(e)?Z(e):jo(e);if(Rc&&e[Rc])return H(e[Rc]());var t=xp(e),n=t==Qe?z:t==nt?$:rl;return n(e)}function Eu(e){if(!e)return 0===e?e:0;if(e=Uu(e),e===Fe||e===-Fe){var t=e<0?-1:1;return t*Ne}return e===e?e:0}function _u(e){var t=Eu(e),n=t%1;return t===t?n?t-n:t:0}function Pu(e){return e?Bn(_u(e),0,Re):0}function Uu(e){if("number"==typeof e)return e;if(Cu(e))return Oe;if(uu(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=uu(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ot,"");var n=Gt.test(e);return n||qt.test(e)?nr(e.slice(2),n?2:8):Kt.test(e)?Oe:+e}function ku(e){return Mo(e,Ku(e))}function xu(e){return e?Bn(_u(e),-Ae,Ae):0===e?e:0}function Lu(e){return null==e?"":vo(e)}function Fu(e,t){var n=vp(e);return null==t?n:On(n,t)}function Au(e,t){return C(e,Ei(t,3),or)}function Nu(e,t){return C(e,Ei(t,3),ar)}function Ou(e,t){return null==e?e:Cp(e,Ei(t,3),Ku)}function Ru(e,t){return null==e?e:wp(e,Ei(t,3),Ku)}function Du(e,t){return e&&or(e,Ei(t,3))}function Wu(e,t){return e&&ar(e,Ei(t,3))}function Bu(e){return null==e?[]:sr(e,zu(e))}function Vu(e){return null==e?[]:sr(e,Ku(e))}function ju(e,t,n){var r=null==e?ne:lr(e,t);return r===ne?n:r}function Mu(e,t){return null!=e&&Fi(e,t,Ir)}function Hu(e,t){return null!=e&&Fi(e,t,Tr)}function zu(e){return Js(e)?Pn(e):jr(e)}function Ku(e){return Js(e)?Pn(e,!0):Mr(e)}function Gu(e,t){var n={};return t=Ei(t,3),or(e,function(e,r,o){Dn(n,t(e,r,o),e)}),n}function $u(e,t){var n={};return t=Ei(t,3),or(e,function(e,r,o){Dn(n,r,t(e,r,o))}),n}function qu(e,t){return Qu(e,Rs(Ei(t)))}function Qu(e,t){if(null==e)return{};var n=g(Si(e),function(e){return[e]});return t=Ei(t),Zr(e,n,function(e,n){return t(e,n[0])})}function Ju(e,t,n){t=Po(t,e);var r=-1,o=t.length;for(o||(o=1,e=ne);++r<o;){var i=null==e?ne:e[ra(t[r])];i===ne&&(r=o,i=n),e=iu(i)?i.call(e):i}return e}function Yu(e,t,n){return null==e?e:uo(e,t,n)}function Zu(e,t,n,r){return r="function"==typeof r?r:ne,null==e?e:uo(e,t,n,r)}function Xu(e,t,n){var r=wf(e),o=r||If(e)||Uf(e);if(t=Ei(t,4),null==n){var i=e&&e.constructor;n=o?r?new i:[]:uu(e)&&iu(i)?vp(Lc(e)):{}}return(o?s:or)(e,function(e,r,o){return t(n,e,r,o)}),n}function el(e,t){return null==e||bo(e,t)}function tl(e,t,n){return null==e?e:Co(e,t,_o(n))}function nl(e,t,n,r){return r="function"==typeof r?r:ne,null==e?e:Co(e,t,_o(n),r)}function rl(e){return null==e?[]:N(e,zu(e))}function ol(e){return null==e?[]:N(e,Ku(e))}function il(e,t,n){return n===ne&&(n=t,t=ne),n!==ne&&(n=Uu(n),n=n===n?n:0),t!==ne&&(t=Uu(t),t=t===t?t:0),Bn(Uu(e),t,n)}function al(e,t,n){return t=Eu(t),n===ne?(n=t,t=0):n=Eu(n),e=Uu(e),Er(e,t,n)}function sl(e,t,n){if(n&&"boolean"!=typeof n&&Bi(e,t,n)&&(t=n=ne),n===ne&&("boolean"==typeof t?(n=t,t=ne):"boolean"==typeof e&&(n=e,e=ne)),e===ne&&t===ne?(e=0,t=1):(e=Eu(e),t===ne?(t=e,e=0):t=Eu(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=Xc();return Jc(e+o*(t-e+tr("1e-"+((o+"").length-1))),t)}return no(e,t)}function ul(e){return eg(Lu(e).toLowerCase())}function ll(e){return e=Lu(e),e&&e.replace(Jt,yr).replace(Mn,"")}function cl(e,t,n){e=Lu(e),t=vo(t);var r=e.length;n=n===ne?r:Bn(_u(n),0,r);var o=n;return n-=t.length,n>=0&&e.slice(n,o)==t}function pl(e){return e=Lu(e),e&&Et.test(e)?e.replace(It,br):e}function fl(e){return e=Lu(e),e&&Nt.test(e)?e.replace(At,"\\$&"):e}function gl(e,t,n){e=Lu(e),t=_u(t);var r=t?Y(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return ai(Hc(o),n)+e+ai(Mc(o),n)}function dl(e,t,n){e=Lu(e),t=_u(t);var r=t?Y(e):0;return t&&r<t?e+ai(t-r,n):e}function hl(e,t,n){e=Lu(e),t=_u(t);var r=t?Y(e):0;return t&&r<t?ai(t-r,n)+e:e}function ml(e,t,n){return n||null==t?t=0:t&&(t=+t),Zc(Lu(e).replace(Rt,""),t||0)}function vl(e,t,n){return t=(n?Bi(e,t,n):t===ne)?1:_u(t),oo(Lu(e),t)}function yl(){var e=arguments,t=Lu(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function bl(e,t,n){return n&&"number"!=typeof n&&Bi(e,t,n)&&(t=n=ne),(n=n===ne?Re:n>>>0)?(e=Lu(e),e&&("string"==typeof t||null!=t&&!_f(t))&&(t=vo(t),!t&&j(e))?Uo(Z(e),0,n):e.split(t,n)):[]}function Cl(e,t,n){return e=Lu(e),n=null==n?0:Bn(_u(n),0,e.length),t=vo(t),e.slice(n,n+t.length)==t}function wl(e,t,r){var o=n.templateSettings;r&&Bi(e,t,r)&&(t=ne),e=Lu(e),t=Af({},t,o,di);var i,a,s=Af({},t.imports,o.imports,di),u=zu(s),l=N(s,u),c=0,p=t.interpolate||Yt,f="__p += '",g=fc((t.escape||Yt).source+"|"+p.source+"|"+(p===Ut?Ht:Yt).source+"|"+(t.evaluate||Yt).source+"|$","g"),d="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++qn+"]")+"\n";e.replace(g,function(t,n,r,o,s,u){return r||(r=o),f+=e.slice(c,u).replace(Zt,B),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+t.length,t}),f+="';\n";var h=t.variable;h||(f="with (obj) {\n"+f+"\n}\n"),f=(a?f.replace(bt,""):f).replace(Ct,"$1").replace(wt,"$1;"),f="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m=tg(function(){return lc(u,d+"return "+f).apply(ne,l)});if(m.source=f,ru(m))throw m;return m}function Sl(e){return Lu(e).toLowerCase()}function Il(e){return Lu(e).toUpperCase()}function Tl(e,t,n){if(e=Lu(e),e&&(n||t===ne))return e.replace(Ot,"");if(!e||!(t=vo(t)))return e;var r=Z(e),o=Z(t),i=R(r,o),a=D(r,o)+1;return Uo(r,i,a).join("")}function El(e,t,n){if(e=Lu(e),e&&(n||t===ne))return e.replace(Dt,"");if(!e||!(t=vo(t)))return e;var r=Z(e),o=D(r,Z(t))+1;return Uo(r,0,o).join("")}function _l(e,t,n){if(e=Lu(e),e&&(n||t===ne))return e.replace(Rt,"");if(!e||!(t=vo(t)))return e;var r=Z(e),o=R(r,Z(t));return Uo(r,o).join("")}function Pl(e,t){var n=Ee,r=_e;if(uu(t)){var o="separator"in t?t.separator:o;n="length"in t?_u(t.length):n,r="omission"in t?vo(t.omission):r}e=Lu(e);var i=e.length;if(j(e)){var a=Z(e);i=a.length}if(n>=i)return e;var s=n-Y(r);if(s<1)return r;var u=a?Uo(a,0,s).join(""):e.slice(0,s);if(o===ne)return u+r;if(a&&(s+=u.length-s),_f(o)){if(e.slice(s).search(o)){var l,c=u;for(o.global||(o=fc(o.source,Lu(zt.exec(o))+"g")),o.lastIndex=0;l=o.exec(c);)var p=l.index;u=u.slice(0,p===ne?s:p)}}else if(e.indexOf(vo(o),s)!=s){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+r}function Ul(e){return e=Lu(e),e&&Tt.test(e)?e.replace(St,Cr):e}function kl(e,t,n){return e=Lu(e),t=n?ne:t,t===ne?M(e)?te(e):b(e):e.match(t)||[]}function xl(e){var t=null==e?0:e.length,n=Ei();return e=t?g(e,function(e){if("function"!=typeof e[1])throw new dc(ae);return[n(e[0]),e[1]]}):[],io(function(n){for(var r=-1;++r<t;){var o=e[r];if(i(o[0],this,n))return i(o[1],this,n)}})}function Ll(e){return Hn(Vn(e,ce))}function Fl(e){return function(){return e}}function Al(e,t){return null==e||e!==e?t:e}function Nl(e){return e}function Ol(e){return Vr("function"==typeof e?e:Vn(e,ce))}function Rl(e){return Kr(Vn(e,ce))}function Dl(e,t){return Gr(e,Vn(t,ce))}function Wl(e,t,n){var r=zu(t),o=sr(t,r);null!=n||uu(t)&&(o.length||!r.length)||(n=t,t=e,e=this,o=sr(t,zu(t)));var i=!(uu(n)&&"chain"in n&&!n.chain),a=iu(e);return s(o,function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(i||t){var n=e(this.__wrapped__),o=n.__actions__=jo(this.__actions__);return o.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,d([this.value()],arguments))})}),e}function Bl(){return ir._===this&&(ir._=Ec),this}function Vl(){}function jl(e){return e=_u(e),io(function(t){return Qr(t,e)})}function Ml(e){return Vi(e)?_(ra(e)):Xr(e)}function Hl(e){return function(t){return null==e?ne:lr(e,t)}}function zl(){return[]}function Kl(){return!1}function Gl(){return{}}function $l(){return""}function ql(){return!0}function Ql(e,t){if(e=_u(e),e<1||e>Ae)return[];var n=Re,r=Jc(e,Re);t=Ei(t),e-=Re;for(var o=L(r,t);++n<e;)t(n);return o}function Jl(e){return wf(e)?g(e,ra):Cu(e)?[e]:jo(Op(Lu(e)))}function Yl(e){var t=++wc;return Lu(e)+t}function Zl(e){return e&&e.length?Zn(e,Nl,wr):ne}function Xl(e,t){return e&&e.length?Zn(e,Ei(t,2),wr):ne}function ec(e){return E(e,Nl)}function tc(e,t){return E(e,Ei(t,2))}function nc(e){return e&&e.length?Zn(e,Nl,Hr):ne}function rc(e,t){return e&&e.length?Zn(e,Ei(t,2),Hr):ne}function oc(e){return e&&e.length?x(e,Nl):0}function ic(e,t){return e&&e.length?x(e,Ei(t,2)):0}t=null==t?ir:Sr.defaults(ir.Object(),t,Sr.pick(ir,$n));var ac=t.Array,sc=t.Date,uc=t.Error,lc=t.Function,cc=t.Math,pc=t.Object,fc=t.RegExp,gc=t.String,dc=t.TypeError,hc=ac.prototype,mc=lc.prototype,vc=pc.prototype,yc=t["__core-js_shared__"],bc=mc.toString,Cc=vc.hasOwnProperty,wc=0,Sc=function(){var e=/[^.]+$/.exec(yc&&yc.keys&&yc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ic=vc.toString,Tc=bc.call(pc),Ec=ir._,_c=fc("^"+bc.call(Cc).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Pc=ur?t.Buffer:ne,Uc=t.Symbol,kc=t.Uint8Array,xc=Pc?Pc.allocUnsafe:ne,Lc=K(pc.getPrototypeOf,pc),Fc=pc.create,Ac=vc.propertyIsEnumerable,Nc=hc.splice,Oc=Uc?Uc.isConcatSpreadable:ne,Rc=Uc?Uc.iterator:ne,Dc=Uc?Uc.toStringTag:ne,Wc=function(){try{var e=Ui(pc,"defineProperty");return e({},"",{}),e}catch(e){}}(),Bc=t.clearTimeout!==ir.clearTimeout&&t.clearTimeout,Vc=sc&&sc.now!==ir.Date.now&&sc.now,jc=t.setTimeout!==ir.setTimeout&&t.setTimeout,Mc=cc.ceil,Hc=cc.floor,zc=pc.getOwnPropertySymbols,Kc=Pc?Pc.isBuffer:ne,Gc=t.isFinite,$c=hc.join,qc=K(pc.keys,pc),Qc=cc.max,Jc=cc.min,Yc=sc.now,Zc=t.parseInt,Xc=cc.random,ep=hc.reverse,tp=Ui(t,"DataView"),np=Ui(t,"Map"),rp=Ui(t,"Promise"),op=Ui(t,"Set"),ip=Ui(t,"WeakMap"),ap=Ui(pc,"create"),sp=ip&&new ip,up={},lp=oa(tp),cp=oa(np),pp=oa(rp),fp=oa(op),gp=oa(ip),dp=Uc?Uc.prototype:ne,hp=dp?dp.valueOf:ne,mp=dp?dp.toString:ne,vp=function(){function e(){}return function(t){if(!uu(t))return{};if(Fc)return Fc(t);e.prototype=t;var n=new e;return e.prototype=ne,n}}();n.templateSettings={escape:_t,evaluate:Pt,interpolate:Ut,variable:"",imports:{_:n}},n.prototype=y.prototype,n.prototype.constructor=n,P.prototype=vp(y.prototype),P.prototype.constructor=P,Q.prototype=vp(y.prototype),Q.prototype.constructor=Q,Xt.prototype.clear=en,Xt.prototype.delete=tn,Xt.prototype.get=nn,Xt.prototype.has=rn,Xt.prototype.set=on,an.prototype.clear=sn,an.prototype.delete=un,an.prototype.get=ln,an.prototype.has=cn,an.prototype.set=pn,fn.prototype.clear=gn,fn.prototype.delete=dn,fn.prototype.get=hn,fn.prototype.has=mn,fn.prototype.set=vn,yn.prototype.add=yn.prototype.push=bn,yn.prototype.has=Cn,wn.prototype.clear=Sn,wn.prototype.delete=In,wn.prototype.get=Tn,wn.prototype.has=En,wn.prototype.set=_n;var yp=$o(or),bp=$o(ar,!0),Cp=qo(),wp=qo(!0),Sp=sp?function(e,t){return sp.set(e,t),e}:Nl,Ip=Wc?function(e,t){return Wc(e,"toString",{configurable:!0,enumerable:!1,value:Fl(t),writable:!0})}:Nl,Tp=io,Ep=Bc||function(e){return ir.clearTimeout(e)},_p=op&&1/$(new op([,-0]))[1]==Fe?function(e){return new op(e)}:Vl,Pp=sp?function(e){return sp.get(e)}:Vl,Up=zc?function(e){return null==e?[]:(e=pc(e),c(zc(e),function(t){return Ac.call(e,t)}))}:zl,kp=zc?function(e){for(var t=[];e;)d(t,Up(e)),e=Lc(e);return t}:zl,xp=vr;(tp&&xp(new tp(new ArrayBuffer(1)))!=lt||np&&xp(new np)!=Qe||rp&&xp(rp.resolve())!=Xe||op&&xp(new op)!=nt||ip&&xp(new ip)!=at)&&(xp=function(e){var t=vr(e),n=t==Ze?e.constructor:ne,r=n?oa(n):"";if(r)switch(r){case lp:return lt;case cp:return Qe;case pp:return Xe;case fp:return nt;case gp:return at}return t});var Lp=yc?iu:Kl,Fp=ta(Sp),Ap=jc||function(e,t){return ir.setTimeout(e,t)},Np=ta(Ip),Op=$i(function(e){var t=[];return Lt.test(e)&&t.push(""),e.replace(Ft,function(e,n,r,o){t.push(r?o.replace(Mt,"$1"):n||e)}),t}),Rp=io(function(e,t){return Ys(e)?Gn(e,rr(t,1,Ys,!0)):[]}),Dp=io(function(e,t){var n=Ea(t);return Ys(n)&&(n=ne),Ys(e)?Gn(e,rr(t,1,Ys,!0),Ei(n,2)):[]}),Wp=io(function(e,t){var n=Ea(t);return Ys(n)&&(n=ne),Ys(e)?Gn(e,rr(t,1,Ys,!0),ne,n):[]}),Bp=io(function(e){var t=g(e,Eo);return t.length&&t[0]===e[0]?_r(t):[]}),Vp=io(function(e){var t=Ea(e),n=g(e,Eo);return t===Ea(n)?t=ne:n.pop(),n.length&&n[0]===e[0]?_r(n,Ei(t,2)):[]}),jp=io(function(e){var t=Ea(e),n=g(e,Eo);return t="function"==typeof t?t:ne,t&&n.pop(),n.length&&n[0]===e[0]?_r(n,ne,t):[]}),Mp=io(Ua),Hp=Ci(function(e,t){var n=null==e?0:e.length,r=Wn(e,t);return to(e,g(t,function(e){return Wi(e,n)?+e:e}).sort(Do)),r}),zp=io(function(e){return yo(rr(e,1,Ys,!0))}),Kp=io(function(e){var t=Ea(e);return Ys(t)&&(t=ne),yo(rr(e,1,Ys,!0),Ei(t,2))}),Gp=io(function(e){var t=Ea(e);return t="function"==typeof t?t:ne,yo(rr(e,1,Ys,!0),ne,t)}),$p=io(function(e,t){return Ys(e)?Gn(e,t):[]}),qp=io(function(e){return Io(c(e,Ys))}),Qp=io(function(e){var t=Ea(e);return Ys(t)&&(t=ne),Io(c(e,Ys),Ei(t,2))}),Jp=io(function(e){var t=Ea(e);return t="function"==typeof t?t:ne,Io(c(e,Ys),ne,t)}),Yp=io(Ja),Zp=io(function(e){var t=e.length,n=t>1?e[t-1]:ne;return n="function"==typeof n?(e.pop(),n):ne,Ya(e,n)}),Xp=Ci(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return Wn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Q&&Wi(n)?(r=r.slice(n,+n+(t?1:0)),r.__actions__.push({func:ns,args:[o],thisArg:ne}),new P(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(ne),e})):this.thru(o)}),ef=Ko(function(e,t,n){Cc.call(e,n)?++e[n]:Dn(e,n,1)}),tf=ei(ha),nf=ei(ma),rf=Ko(function(e,t,n){Cc.call(e,n)?e[n].push(t):Dn(e,n,[t])}),of=io(function(e,t,n){var r=-1,o="function"==typeof t,a=Js(e)?ac(e.length):[];return yp(e,function(e){a[++r]=o?i(t,e,n):Ur(e,t,n)}),a}),af=Ko(function(e,t,n){Dn(e,n,t)}),sf=Ko(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),uf=io(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Bi(e,t[0],t[1])?t=[]:n>2&&Bi(t[0],t[1],t[2])&&(t=[t[0]]),
Jr(e,rr(t,1),[])}),lf=Vc||function(){return ir.Date.now()},cf=io(function(e,t,n){var r=he;if(n.length){var o=G(n,Ti(cf));r|=Ce}return gi(e,r,t,n,o)}),pf=io(function(e,t,n){var r=he|me;if(n.length){var o=G(n,Ti(pf));r|=Ce}return gi(t,r,e,n,o)}),ff=io(function(e,t){return Kn(e,1,t)}),gf=io(function(e,t,n){return Kn(e,Uu(t)||0,n)});Os.Cache=fn;var df=Tp(function(e,t){t=1==t.length&&wf(t[0])?g(t[0],A(Ei())):g(rr(t,1),A(Ei()));var n=t.length;return io(function(r){for(var o=-1,a=Jc(r.length,n);++o<a;)r[o]=t[o].call(this,r[o]);return i(e,this,r)})}),hf=io(function(e,t){var n=G(t,Ti(hf));return gi(e,Ce,ne,t,n)}),mf=io(function(e,t){var n=G(t,Ti(mf));return gi(e,we,ne,t,n)}),vf=Ci(function(e,t){return gi(e,Ie,ne,ne,ne,t)}),yf=li(wr),bf=li(function(e,t){return e>=t}),Cf=kr(function(){return arguments}())?kr:function(e){return lu(e)&&Cc.call(e,"callee")&&!Ac.call(e,"callee")},wf=ac.isArray,Sf=pr?A(pr):xr,If=Kc||Kl,Tf=fr?A(fr):Lr,Ef=gr?A(gr):Nr,_f=dr?A(dr):Dr,Pf=hr?A(hr):Wr,Uf=mr?A(mr):Br,kf=li(Hr),xf=li(function(e,t){return e<=t}),Lf=Go(function(e,t){if(zi(t)||Js(t))return void Mo(t,zu(t),e);for(var n in t)Cc.call(t,n)&&Fn(e,n,t[n])}),Ff=Go(function(e,t){Mo(t,Ku(t),e)}),Af=Go(function(e,t,n,r){Mo(t,Ku(t),e,r)}),Nf=Go(function(e,t,n,r){Mo(t,zu(t),e,r)}),Of=Ci(Wn),Rf=io(function(e){return e.push(ne,di),i(Af,ne,e)}),Df=io(function(e){return e.push(ne,hi),i(Mf,ne,e)}),Wf=ri(function(e,t,n){e[t]=n},Fl(Nl)),Bf=ri(function(e,t,n){Cc.call(e,t)?e[t].push(n):e[t]=[n]},Ei),Vf=io(Ur),jf=Go(function(e,t,n){$r(e,t,n)}),Mf=Go(function(e,t,n,r){$r(e,t,n,r)}),Hf=Ci(function(e,t){var n={};if(null==e)return n;var r=!1;t=g(t,function(t){return t=Po(t,e),r||(r=t.length>1),t}),Mo(e,Si(e),n),r&&(n=Vn(n,ce|pe|fe,mi));for(var o=t.length;o--;)bo(n,t[o]);return n}),zf=Ci(function(e,t){return null==e?{}:Yr(e,t)}),Kf=fi(zu),Gf=fi(Ku),$f=Yo(function(e,t,n){return t=t.toLowerCase(),e+(n?ul(t):t)}),qf=Yo(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Qf=Yo(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Jf=Jo("toLowerCase"),Yf=Yo(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Zf=Yo(function(e,t,n){return e+(n?" ":"")+eg(t)}),Xf=Yo(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),eg=Jo("toUpperCase"),tg=io(function(e,t){try{return i(e,ne,t)}catch(e){return ru(e)?e:new uc(e)}}),ng=Ci(function(e,t){return s(t,function(t){t=ra(t),Dn(e,t,cf(e[t],e))}),e}),rg=ti(),og=ti(!0),ig=io(function(e,t){return function(n){return Ur(n,e,t)}}),ag=io(function(e,t){return function(n){return Ur(e,n,t)}}),sg=ii(g),ug=ii(l),lg=ii(v),cg=ui(),pg=ui(!0),fg=oi(function(e,t){return e+t},0),gg=pi("ceil"),dg=oi(function(e,t){return e/t},1),hg=pi("floor"),mg=oi(function(e,t){return e*t},1),vg=pi("round"),yg=oi(function(e,t){return e-t},0);return n.after=Us,n.ary=ks,n.assign=Lf,n.assignIn=Ff,n.assignInWith=Af,n.assignWith=Nf,n.at=Of,n.before=xs,n.bind=cf,n.bindAll=ng,n.bindKey=pf,n.castArray=Hs,n.chain=es,n.chunk=sa,n.compact=ua,n.concat=la,n.cond=xl,n.conforms=Ll,n.constant=Fl,n.countBy=ef,n.create=Fu,n.curry=Ls,n.curryRight=Fs,n.debounce=As,n.defaults=Rf,n.defaultsDeep=Df,n.defer=ff,n.delay=gf,n.difference=Rp,n.differenceBy=Dp,n.differenceWith=Wp,n.drop=ca,n.dropRight=pa,n.dropRightWhile=fa,n.dropWhile=ga,n.fill=da,n.filter=ps,n.flatMap=fs,n.flatMapDeep=gs,n.flatMapDepth=ds,n.flatten=va,n.flattenDeep=ya,n.flattenDepth=ba,n.flip=Ns,n.flow=rg,n.flowRight=og,n.fromPairs=Ca,n.functions=Bu,n.functionsIn=Vu,n.groupBy=rf,n.initial=Ia,n.intersection=Bp,n.intersectionBy=Vp,n.intersectionWith=jp,n.invert=Wf,n.invertBy=Bf,n.invokeMap=of,n.iteratee=Ol,n.keyBy=af,n.keys=zu,n.keysIn=Ku,n.map=ys,n.mapKeys=Gu,n.mapValues=$u,n.matches=Rl,n.matchesProperty=Dl,n.memoize=Os,n.merge=jf,n.mergeWith=Mf,n.method=ig,n.methodOf=ag,n.mixin=Wl,n.negate=Rs,n.nthArg=jl,n.omit=Hf,n.omitBy=qu,n.once=Ds,n.orderBy=bs,n.over=sg,n.overArgs=df,n.overEvery=ug,n.overSome=lg,n.partial=hf,n.partialRight=mf,n.partition=sf,n.pick=zf,n.pickBy=Qu,n.property=Ml,n.propertyOf=Hl,n.pull=Mp,n.pullAll=Ua,n.pullAllBy=ka,n.pullAllWith=xa,n.pullAt=Hp,n.range=cg,n.rangeRight=pg,n.rearg=vf,n.reject=Ss,n.remove=La,n.rest=Ws,n.reverse=Fa,n.sampleSize=Ts,n.set=Yu,n.setWith=Zu,n.shuffle=Es,n.slice=Aa,n.sortBy=uf,n.sortedUniq=Va,n.sortedUniqBy=ja,n.split=bl,n.spread=Bs,n.tail=Ma,n.take=Ha,n.takeRight=za,n.takeRightWhile=Ka,n.takeWhile=Ga,n.tap=ts,n.throttle=Vs,n.thru=ns,n.toArray=Tu,n.toPairs=Kf,n.toPairsIn=Gf,n.toPath=Jl,n.toPlainObject=ku,n.transform=Xu,n.unary=js,n.union=zp,n.unionBy=Kp,n.unionWith=Gp,n.uniq=$a,n.uniqBy=qa,n.uniqWith=Qa,n.unset=el,n.unzip=Ja,n.unzipWith=Ya,n.update=tl,n.updateWith=nl,n.values=rl,n.valuesIn=ol,n.without=$p,n.words=kl,n.wrap=Ms,n.xor=qp,n.xorBy=Qp,n.xorWith=Jp,n.zip=Yp,n.zipObject=Za,n.zipObjectDeep=Xa,n.zipWith=Zp,n.entries=Kf,n.entriesIn=Gf,n.extend=Ff,n.extendWith=Af,Wl(n,n),n.add=fg,n.attempt=tg,n.camelCase=$f,n.capitalize=ul,n.ceil=gg,n.clamp=il,n.clone=zs,n.cloneDeep=Gs,n.cloneDeepWith=$s,n.cloneWith=Ks,n.conformsTo=qs,n.deburr=ll,n.defaultTo=Al,n.divide=dg,n.endsWith=cl,n.eq=Qs,n.escape=pl,n.escapeRegExp=fl,n.every=cs,n.find=tf,n.findIndex=ha,n.findKey=Au,n.findLast=nf,n.findLastIndex=ma,n.findLastKey=Nu,n.floor=hg,n.forEach=hs,n.forEachRight=ms,n.forIn=Ou,n.forInRight=Ru,n.forOwn=Du,n.forOwnRight=Wu,n.get=ju,n.gt=yf,n.gte=bf,n.has=Mu,n.hasIn=Hu,n.head=wa,n.identity=Nl,n.includes=vs,n.indexOf=Sa,n.inRange=al,n.invoke=Vf,n.isArguments=Cf,n.isArray=wf,n.isArrayBuffer=Sf,n.isArrayLike=Js,n.isArrayLikeObject=Ys,n.isBoolean=Zs,n.isBuffer=If,n.isDate=Tf,n.isElement=Xs,n.isEmpty=eu,n.isEqual=tu,n.isEqualWith=nu,n.isError=ru,n.isFinite=ou,n.isFunction=iu,n.isInteger=au,n.isLength=su,n.isMap=Ef,n.isMatch=cu,n.isMatchWith=pu,n.isNaN=fu,n.isNative=gu,n.isNil=hu,n.isNull=du,n.isNumber=mu,n.isObject=uu,n.isObjectLike=lu,n.isPlainObject=vu,n.isRegExp=_f,n.isSafeInteger=yu,n.isSet=Pf,n.isString=bu,n.isSymbol=Cu,n.isTypedArray=Uf,n.isUndefined=wu,n.isWeakMap=Su,n.isWeakSet=Iu,n.join=Ta,n.kebabCase=qf,n.last=Ea,n.lastIndexOf=_a,n.lowerCase=Qf,n.lowerFirst=Jf,n.lt=kf,n.lte=xf,n.max=Zl,n.maxBy=Xl,n.mean=ec,n.meanBy=tc,n.min=nc,n.minBy=rc,n.stubArray=zl,n.stubFalse=Kl,n.stubObject=Gl,n.stubString=$l,n.stubTrue=ql,n.multiply=mg,n.nth=Pa,n.noConflict=Bl,n.noop=Vl,n.now=lf,n.pad=gl,n.padEnd=dl,n.padStart=hl,n.parseInt=ml,n.random=sl,n.reduce=Cs,n.reduceRight=ws,n.repeat=vl,n.replace=yl,n.result=Ju,n.round=vg,n.runInContext=e,n.sample=Is,n.size=_s,n.snakeCase=Yf,n.some=Ps,n.sortedIndex=Na,n.sortedIndexBy=Oa,n.sortedIndexOf=Ra,n.sortedLastIndex=Da,n.sortedLastIndexBy=Wa,n.sortedLastIndexOf=Ba,n.startCase=Zf,n.startsWith=Cl,n.subtract=yg,n.sum=oc,n.sumBy=ic,n.template=wl,n.times=Ql,n.toFinite=Eu,n.toInteger=_u,n.toLength=Pu,n.toLower=Sl,n.toNumber=Uu,n.toSafeInteger=xu,n.toString=Lu,n.toUpper=Il,n.trim=Tl,n.trimEnd=El,n.trimStart=_l,n.truncate=Pl,n.unescape=Ul,n.uniqueId=Yl,n.upperCase=Xf,n.upperFirst=eg,n.each=hs,n.eachRight=ms,n.first=wa,Wl(n,function(){var e={};return or(n,function(t,r){Cc.call(n.prototype,r)||(e[r]=t)}),e}(),{chain:!1}),n.VERSION=re,s(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){n[e].placeholder=n}),s(["drop","take"],function(e,t){Q.prototype[e]=function(n){n=n===ne?1:Qc(_u(n),0);var r=this.__filtered__&&!t?new Q(this):this.clone();return r.__filtered__?r.__takeCount__=Jc(n,r.__takeCount__):r.__views__.push({size:Jc(n,Re),type:e+(r.__dir__<0?"Right":"")}),r},Q.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),s(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==ke||n==Le;Q.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ei(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),s(["head","last"],function(e,t){var n="take"+(t?"Right":"");Q.prototype[e]=function(){return this[n](1).value()[0]}}),s(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Q.prototype[e]=function(){return this.__filtered__?new Q(this):this[n](1)}}),Q.prototype.compact=function(){return this.filter(Nl)},Q.prototype.find=function(e){return this.filter(e).head()},Q.prototype.findLast=function(e){return this.reverse().find(e)},Q.prototype.invokeMap=io(function(e,t){return"function"==typeof e?new Q(this):this.map(function(n){return Ur(n,e,t)})}),Q.prototype.reject=function(e){return this.filter(Rs(Ei(e)))},Q.prototype.slice=function(e,t){e=_u(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Q(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==ne&&(t=_u(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Q.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Q.prototype.toArray=function(){return this.take(Re)},or(Q.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),i=n[o?"take"+("last"==t?"Right":""):t],a=o||/^find/.test(t);i&&(n.prototype[t]=function(){var t=this.__wrapped__,s=o?[1]:arguments,u=t instanceof Q,l=s[0],c=u||wf(t),p=function(e){var t=i.apply(n,d([e],s));return o&&f?t[0]:t};c&&r&&"function"==typeof l&&1!=l.length&&(u=c=!1);var f=this.__chain__,g=!!this.__actions__.length,h=a&&!f,m=u&&!g;if(!a&&c){t=m?t:new Q(this);var v=e.apply(t,s);return v.__actions__.push({func:ns,args:[p],thisArg:ne}),new P(v,f)}return h&&m?e.apply(this,s):(v=this.thru(p),h?o?v.value()[0]:v.value():v)})}),s(["pop","push","shift","sort","splice","unshift"],function(e){var t=hc[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);n.prototype[e]=function(){var e=arguments;if(o&&!this.__chain__){var n=this.value();return t.apply(wf(n)?n:[],e)}return this[r](function(n){return t.apply(wf(n)?n:[],e)})}}),or(Q.prototype,function(e,t){var r=n[t];if(r){var o=r.name+"",i=up[o]||(up[o]=[]);i.push({name:t,func:r})}}),up[ni(ne,me).name]=[{name:"wrapper",func:ne}],Q.prototype.clone=X,Q.prototype.reverse=ee,Q.prototype.value=jt,n.prototype.at=Xp,n.prototype.chain=rs,n.prototype.commit=os,n.prototype.next=is,n.prototype.plant=ss,n.prototype.reverse=us,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=ls,n.prototype.first=n.prototype.head,Rc&&(n.prototype[Rc]=as),n},Sr=wr();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(ir._=Sr,define(function(){return Sr})):sr?((sr.exports=Sr)._=Sr,ar._=Sr):ir._=Sr}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],81:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function a(e){if(f===clearTimeout)return clearTimeout(e);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){m&&d&&(m=!1,d.length?h=d.concat(h):v=-1,h.length&&u())}function u(){if(!m){var e=i(s);m=!0;for(var t=h.length;t;){for(d=h,h=[];++v<t;)d&&d[v].run();v=-1,t=h.length}d=null,m=!1,a(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var p,f,g=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(e){p=r}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(e){f=o}}();var d,h=[],m=!1,v=-1;g.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new l(e,t)),1!==h.length||m||i(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=c,g.addListener=c,g.once=c,g.off=c,g.removeListener=c,g.removeAllListeners=c,g.emit=c,g.prependListener=c,g.prependOnceListener=c,g.listeners=function(e){return[]},g.binding=function(e){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(e){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}]},{},[22]);